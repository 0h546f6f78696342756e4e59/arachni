<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Arachni::UI::Web::Server
  
    &mdash; Arachni - Web Application Security Scanner Framework
  
</title>

  <link rel="stylesheet" href="../../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../../..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../../_index.html">Index (S)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../../Arachni.html" title="Arachni (module)">Arachni</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../UI.html" title="Arachni::UI (module)">UI</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Web.html" title="Arachni::UI::Web (module)">Web</a></span></span>
     &raquo; 
    <span class="title">Server</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Arachni::UI::Web::Server
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Sinatra::Base</span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Sinatra::Base</li>
          
            <li class="next">Arachni::UI::Web::Server</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="../../Module/Utilities.html" title="Arachni::Module::Utilities (module)">Module::Utilities</a></span>, <span class='object_link'><a href="Utilities.html" title="Arachni::UI::Web::Utilities (module)">Utilities</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/arachni/ui/web/server.rb</dd>
  
</dl>
<div class="clear"></div>


  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="HELPER_OWNER-constant" class="">HELPER_OWNER =
          <div class="docstring">
  <div class="discussion">
    
<p>This will be used for the "owner" field of the helper instance</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>WebUI helper</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
    </dl>
  


  
  
  
  
  
  
  
  
  


  
  
  
  
  
  
  

  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prep_thin-class_method" title="prep_thin (class method)">+ (Object) <strong>prep_thin</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#run%21-class_method" title="run! (class method)">+ (Object) <strong>run!</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>override run! using this patch: <a
href="https://github.com/sinatra/sinatra/pull/132">github.com/sinatra/sinatra/pull/132</a>.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#addons-instance_method" title="#addons (instance method)">- (Object) <strong>addons</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#async_redirect-instance_method" title="#async_redirect (instance method)">- (Object) <strong>async_redirect</strong>(location, opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#component_cache_filled%3F-instance_method" title="#component_cache_filled? (instance method)">- (Boolean) <strong>component_cache_filled?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dispatcher_stats-instance_method" title="#dispatcher_stats (instance method)">- (Object) <strong>dispatcher_stats</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Provides statistics about running jobs etc using the dispatcher.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dispatchers-instance_method" title="#dispatchers (instance method)">- (Object) <strong>dispatchers</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ensure_dispatcher-instance_method" title="#ensure_dispatcher (instance method)">- (Bool) <strong>ensure_dispatcher</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Makes sure that we have a dispatcher, if not it redirects the user to an
appropriate error page.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ensure_welcomed-instance_method" title="#ensure_welcomed (instance method)">- (Object) <strong>ensure_welcomed</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exception_jail-instance_method" title="#exception_jail (instance method)">- (Object) <strong>exception_jail</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fill_component_cache-instance_method" title="#fill_component_cache (instance method)">- (Object) <strong>fill_component_cache</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#helper_instance-instance_method" title="#helper_instance (instance method)">- (Object) <strong>helper_instance</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#instances-instance_method" title="#instances (instance method)">- (Object) <strong>instances</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#log-instance_method" title="#log (instance method)">- (Object) <strong>log</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#options-instance_method" title="#options (instance method)">- (Object) <strong>options</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prep_modules-instance_method" title="#prep_modules (instance method)">- (Object) <strong>prep_modules</strong>(params) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prep_opts-instance_method" title="#prep_opts (instance method)">- (Hash) <strong>prep_opts</strong>(params) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Prepares form params to be used as options for RPC transmission.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prep_plugins-instance_method" title="#prep_plugins (instance method)">- (Object) <strong>prep_plugins</strong>(params) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prep_session-instance_method" title="#prep_session (instance method)">- (Object) <strong>prep_session</strong>(skip_dispatcher = false) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Makes sure that all systems are go and populates the session with default
values.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#redirect-instance_method" title="#redirect (instance method)">- (Object) <strong>redirect</strong>(location, opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reports-instance_method" title="#reports (instance method)">- (Object) <strong>reports</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#save_and_shutdown-instance_method" title="#save_and_shutdown (instance method)">- (Object) <strong>save_and_shutdown</strong>(url, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Saves the report and shuts down the instance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#scheduler-instance_method" title="#scheduler (instance method)">- (Object) <strong>scheduler</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#show-instance_method" title="#show (instance method)">- (Object) <strong>show</strong>(page, layout = true) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#show_dispatcher_line-instance_method" title="#show_dispatcher_line (instance method)">- (Object) <strong>show_dispatcher_line</strong>(stats) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#show_dispatcher_node_line-instance_method" title="#show_dispatcher_node_line (instance method)">- (Object) <strong>show_dispatcher_node_line</strong>(stats) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#show_error-instance_method" title="#show_error (instance method)">- (Object) <strong>show_error</strong>(title, message = '', backtrace = []) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#shutdown_all-instance_method" title="#shutdown_all (instance method)">- (Object) <strong>shutdown_all</strong>(url, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Kills all running instances.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#shutdown_zombies-instance_method" title="#shutdown_zombies (instance method)">- (Integer) <strong>shutdown_zombies</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Kills all idle instances.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_i-instance_method" title="#to_i (instance method)">- (Object) <strong>to_i</strong>(str) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Similar to String.to_i but it returns the original object if String is not
a number.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#welcomed%21-instance_method" title="#welcomed! (instance method)">- (Object) <strong>welcomed!</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#welcomed%3F-instance_method" title="#welcomed? (instance method)">- (Boolean) <strong>welcomed?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Utilities.html" title="Arachni::UI::Web::Utilities (module)">Utilities</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Utilities.html#escape-instance_method" title="Arachni::UI::Web::Utilities#escape (method)">#escape</a></span>, <span class='object_link'><a href="Utilities.html#escape_hash-instance_method" title="Arachni::UI::Web::Utilities#escape_hash (method)">#escape_hash</a></span>, <span class='object_link'><a href="Utilities.html#parse_datetime-instance_method" title="Arachni::UI::Web::Utilities#parse_datetime (method)">#parse_datetime</a></span>, <span class='object_link'><a href="Utilities.html#port_to_url-instance_method" title="Arachni::UI::Web::Utilities#port_to_url (method)">#port_to_url</a></span>, <span class='object_link'><a href="Utilities.html#remove_proto-instance_method" title="Arachni::UI::Web::Utilities#remove_proto (method)">#remove_proto</a></span>, <span class='object_link'><a href="Utilities.html#unescape-instance_method" title="Arachni::UI::Web::Utilities#unescape (method)">#unescape</a></span>, <span class='object_link'><a href="Utilities.html#unescape_hash-instance_method" title="Arachni::UI::Web::Utilities#unescape_hash (method)">#unescape_hash</a></span></p>

  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../Module/Utilities.html" title="Arachni::Module::Utilities (module)">Module::Utilities</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../Module/Utilities.html#get_path-instance_method" title="Arachni::Module::Utilities#get_path (method)">#get_path</a></span>, <span class='object_link'><a href="../../Module/Utilities.html#hash_keys_to_str-instance_method" title="Arachni::Module::Utilities#hash_keys_to_str (method)">#hash_keys_to_str</a></span>, <span class='object_link'><a href="../../Module/Utilities.html#normalize_url-instance_method" title="Arachni::Module::Utilities#normalize_url (method)">#normalize_url</a></span>, <span class='object_link'><a href="../../Module/Utilities.html#read_file-instance_method" title="Arachni::Module::Utilities#read_file (method)">#read_file</a></span>, <span class='object_link'><a href="../../Module/Utilities.html#seed-instance_method" title="Arachni::Module::Utilities#seed (method)">#seed</a></span>, <span class='object_link'><a href="../../Module/Utilities.html#uri_decode-instance_method" title="Arachni::Module::Utilities#uri_decode (method)">#uri_decode</a></span>, <span class='object_link'><a href="../../Module/Utilities.html#uri_encode-instance_method" title="Arachni::Module::Utilities#uri_encode (method)">#uri_encode</a></span>, <span class='object_link'><a href="../../Module/Utilities.html#uri_parse-instance_method" title="Arachni::Module::Utilities#uri_parse (method)">#uri_parse</a></span>, <span class='object_link'><a href="../../Module/Utilities.html#uri_parser-instance_method" title="Arachni::Module::Utilities#uri_parser (method)">#uri_parser</a></span>, <span class='object_link'><a href="../../Module/Utilities.html#url_sanitize-instance_method" title="Arachni::Module::Utilities#url_sanitize (method)">#url_sanitize</a></span></p>

  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="prep_thin-class_method">
  
    + (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>prep_thin</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1154
1155
1156
1157
1158
1159
1160
1161
1162
1163
1164
1165
1166
1167
1168
1169
1170
1171
1172
1173</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 1154</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_prep_thin'>prep_thin</span>
    <span class='kw'>if</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>server</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>key</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_pkey'>pkey</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>PKey</span><span class='op'>::</span><span class='const'>RSA</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>server</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>key</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>server</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cert</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_cert'>cert</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Certificate</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span> <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_read'>read</span><span class='lparen'>(</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>server</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cert</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>key</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cert</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ca</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_verification'>verification</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='lbrace'>{</span>
        <span class='symbol'>:ssl</span>        <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
        <span class='symbol'>:ssl_verify</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_verification'>verification</span><span class='comma'>,</span>
        <span class='symbol'>:ssl_cert_file</span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_cert'>cert</span><span class='comma'>,</span>
        <span class='symbol'>:ssl_key_file</span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_pkey'>pkey</span><span class='comma'>,</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="run!-class_method">
  
    + (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>run!</strong>(options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>override run! using this patch: <a
href="https://github.com/sinatra/sinatra/pull/132">github.com/sinatra/sinatra/pull/132</a></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1132
1133
1134
1135
1136
1137
1138
1139
1140
1141
1142
1143
1144
1145
1146
1147
1148
1149
1150
1151
1152</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 1132</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_run!'>run!</span><span class='lparen'>(</span> <span class='id identifier rubyid_options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_set'>set</span> <span class='id identifier rubyid_options'>options</span>

    <span class='id identifier rubyid_handler'>handler</span> <span class='op'>=</span> <span class='id identifier rubyid_detect_rack_handler'>detect_rack_handler</span>
    <span class='id identifier rubyid_handler_name'>handler_name</span> <span class='op'>=</span> <span class='id identifier rubyid_handler'>handler</span><span class='period'>.</span><span class='id identifier rubyid_name'>name</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>.*::</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>

    <span class='comment'># handler specific options use the lower case handler name as hash key, if present
</span>    <span class='id identifier rubyid_handler_opts'>handler_opts</span> <span class='op'>=</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='id identifier rubyid_handler_name'>handler_name</span><span class='period'>.</span><span class='id identifier rubyid_downcase'>downcase</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>== Sinatra/</span><span class='embexpr_beg'>#{</span><span class='const'>Sinatra</span><span class='op'>::</span><span class='const'>VERSION</span><span class='rbrace'>}</span><span class='tstring_content'> has taken the stage </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>on </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='rbrace'>}</span><span class='tstring_content'> for </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_environment'>environment</span><span class='rbrace'>}</span><span class='tstring_content'> with backup from </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_handler_name'>handler_name</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id identifier rubyid_handler_name'>handler_name</span> <span class='op'>=~</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>cgi</span><span class='regexp_end'>/i</span></span>

    <span class='id identifier rubyid_handler'>handler</span><span class='period'>.</span><span class='id identifier rubyid_run'>run</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id identifier rubyid_handler_opts'>handler_opts</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span> <span class='symbol'>:Host</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:host</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='symbol'>:Port</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_options'>options</span><span class='lbracket'>[</span><span class='symbol'>:port</span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='kw'>do</span>
        <span class='op'>|</span><span class='id identifier rubyid_server'>server</span><span class='op'>|</span>
        <span class='lbracket'>[</span> <span class='symbol'>:INT</span><span class='comma'>,</span> <span class='symbol'>:TERM</span> <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_sig'>sig</span><span class='op'>|</span> <span class='id identifier rubyid_trap'>trap</span><span class='lparen'>(</span> <span class='id identifier rubyid_sig'>sig</span> <span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_quit!'>quit!</span><span class='lparen'>(</span> <span class='id identifier rubyid_server'>server</span><span class='comma'>,</span> <span class='id identifier rubyid_handler_name'>handler_name</span> <span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='rbrace'>}</span>

        <span class='id identifier rubyid_set'>set</span> <span class='symbol'>:running</span><span class='comma'>,</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>EADDRINUSE</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_e'>e</span>
    <span class='id identifier rubyid_puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>== Someone is already performing on port </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_port'>port</span><span class='rbrace'>}</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="addons-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>addons</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


320
321
322</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 320</span>

<span class='kw'>def</span> <span class='id identifier rubyid_addons'>addons</span>
    <span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_addons'>addons</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="async_redirect-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>async_redirect</strong>(location, opts = {}) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 290</span>

<span class='kw'>def</span> <span class='id identifier rubyid_async_redirect'>async_redirect</span><span class='lparen'>(</span> <span class='id identifier rubyid_location'>location</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_status'>status</span> <span class='op'>=</span> <span class='int'>302</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_methods'>methods</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span> <span class='symbol'>:current_addon</span> <span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_current_addon'>current_addon</span> <span class='op'>&amp;&amp;</span>
        <span class='id identifier rubyid_location'>location</span> <span class='op'>!=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/dispatchers/edit</span><span class='tstring_end'>'</span></span>
        <span class='id identifier rubyid_location'>location</span> <span class='op'>=</span> <span class='id identifier rubyid_current_addon'>current_addon</span><span class='period'>.</span><span class='id identifier rubyid_path_root'>path_root</span> <span class='op'>+</span> <span class='id identifier rubyid_location'>location</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='lparen'>(</span> <span class='id identifier rubyid_flash'>flash</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:flash</span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_flash'>flash</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
        <span class='id identifier rubyid_location'>location</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>?</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_flash'>flash</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='const'>URI</span><span class='period'>.</span><span class='id identifier rubyid_encode'>encode</span><span class='lparen'>(</span> <span class='id identifier rubyid_flash'>flash</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_response'>response</span><span class='period'>.</span><span class='id identifier rubyid_headers'>headers</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Location</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_location'>location</span>

    <span class='id identifier rubyid_body'>body</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="component_cache_filled?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>component_cache_filled?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


542
543
544
545
546
547
548</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 542</span>

<span class='kw'>def</span> <span class='id identifier rubyid_component_cache_filled?'>component_cache_filled?</span>
    <span class='kw'>begin</span>
        <span class='kw'>return</span> <span class='cvar'>@@modules</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>+</span> <span class='cvar'>@@plugins</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
    <span class='kw'>rescue</span>
        <span class='kw'>return</span> <span class='kw'>false</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="dispatcher_stats-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>dispatcher_stats</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Provides statistics about running jobs etc using the dispatcher</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


339
340
341</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 339</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dispatcher_stats'>dispatcher_stats</span>
    <span class='id identifier rubyid_dispatchers'>dispatchers</span><span class='period'>.</span><span class='id identifier rubyid_stats'>stats</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="dispatchers-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>dispatchers</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


332
333
334</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 332</span>

<span class='kw'>def</span> <span class='id identifier rubyid_dispatchers'>dispatchers</span>
    <span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_dispatchers'>dispatchers</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="ensure_dispatcher-instance_method">
  
    - (<tt>Bool</tt>) <strong>ensure_dispatcher</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Makes sure that we have a dispatcher, if not it redirects the user to an
appropriate error page.</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>true if alive, redirect if not</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


628
629
630
631
632
633
634
635
636
637</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 628</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ensure_dispatcher'>ensure_dispatcher</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_dispatchers'>dispatchers</span><span class='period'>.</span><span class='id identifier rubyid_all'>all</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
        <span class='id identifier rubyid_async_redirect'>async_redirect</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/dispatchers/edit</span><span class='tstring_end'>'</span></span>
    <span class='kw'>else</span>
        <span class='id identifier rubyid_dispatchers'>dispatchers</span><span class='period'>.</span><span class='id identifier rubyid_first_alive'>first_alive</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id identifier rubyid_dispatcher'>dispatcher</span><span class='op'>|</span>
            <span class='id identifier rubyid_async_redirect'>async_redirect</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/dispatchers/edit</span><span class='tstring_end'>'</span></span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_dispatcher'>dispatcher</span>
        <span class='rbrace'>}</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="ensure_welcomed-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>ensure_welcomed</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


413
414
415
416</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 413</span>

<span class='kw'>def</span> <span class='id identifier rubyid_ensure_welcomed'>ensure_welcomed</span>
    <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_welcomed?'>welcomed?</span>
    <span class='id identifier rubyid_async_redirect'>async_redirect</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/welcome</span><span class='tstring_end'>'</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="exception_jail-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>exception_jail</strong>(&amp;block) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


351
352
353
354
355
356
357</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 351</span>

<span class='kw'>def</span> <span class='id identifier rubyid_exception_jail'>exception_jail</span><span class='lparen'>(</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span> <span class='rparen'>)</span>
    <span class='comment'># begin
</span>        <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span>
    <span class='comment'># rescue Errno::ECONNREFUSED =&gt; e
</span>    <span class='comment'>#     erb :error, { :layout =&gt; true }, :error =&gt; 'Remote server has been shut down.'
</span>    <span class='comment'># end
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="fill_component_cache-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>fill_component_cache</strong>(&amp;block) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


550
551
552
553
554
555
556
557
558
559
560
561
562
563
564
565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 550</span>

<span class='kw'>def</span> <span class='id identifier rubyid_fill_component_cache'>fill_component_cache</span><span class='lparen'>(</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span> <span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_component_cache_filled?'>component_cache_filled?</span>

        <span class='id identifier rubyid_helper_instance'>helper_instance</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id identifier rubyid_inst'>inst</span><span class='op'>|</span>

            <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_inst'>inst</span>
                <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span>
            <span class='kw'>else</span>

                <span class='id identifier rubyid_inst'>inst</span><span class='period'>.</span><span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_lsmod'>lsmod</span> <span class='lbrace'>{</span>
                    <span class='op'>|</span><span class='id identifier rubyid_mods'>mods</span><span class='op'>|</span>

                    <span class='cvar'>@@modules</span> <span class='op'>=</span> <span class='id identifier rubyid_mods'>mods</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_mod'>mod</span><span class='op'>|</span> <span class='id identifier rubyid_hash_keys_to_str'>hash_keys_to_str</span><span class='lparen'>(</span> <span class='id identifier rubyid_mod'>mod</span> <span class='rparen'>)</span> <span class='rbrace'>}</span>

                    <span class='id identifier rubyid_inst'>inst</span><span class='period'>.</span><span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_lsplug'>lsplug</span> <span class='lbrace'>{</span>
                        <span class='op'>|</span><span class='id identifier rubyid_plugs'>plugs</span><span class='op'>|</span>

                        <span class='cvar'>@@plugins</span> <span class='op'>=</span> <span class='id identifier rubyid_plugs'>plugs</span><span class='period'>.</span><span class='id identifier rubyid_map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id identifier rubyid_plug'>plug</span><span class='op'>|</span> <span class='id identifier rubyid_hash_keys_to_str'>hash_keys_to_str</span><span class='lparen'>(</span> <span class='id identifier rubyid_plug'>plug</span> <span class='rparen'>)</span> <span class='rbrace'>}</span>

                        <span class='comment'># shutdown the helper instance, we got what we wanted
</span>                        <span class='id identifier rubyid_inst'>inst</span><span class='period'>.</span><span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_shutdown!'>shutdown!</span><span class='lbrace'>{</span>
                            <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span>
                        <span class='rbrace'>}</span>
                    <span class='rbrace'>}</span>
                <span class='rbrace'>}</span>
            <span class='kw'>end</span>
        <span class='rbrace'>}</span>

    <span class='kw'>else</span>
        <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="helper_instance-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>helper_instance</strong>(&amp;block) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 519</span>

<span class='kw'>def</span> <span class='id identifier rubyid_helper_instance'>helper_instance</span><span class='lparen'>(</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_raise'>raise</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This method requires a block!</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_block_given?'>block_given?</span>

    <span class='id identifier rubyid_dispatchers'>dispatchers</span><span class='period'>.</span><span class='id identifier rubyid_first_alive'>first_alive</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id identifier rubyid_dispatcher'>dispatcher</span><span class='op'>|</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_dispatcher'>dispatcher</span>
            <span class='id identifier rubyid_async_redirect'>async_redirect</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/dispatchers/edit</span><span class='tstring_end'>'</span></span>
        <span class='kw'>else</span>
            <span class='id identifier rubyid_dispatchers'>dispatchers</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span> <span class='id identifier rubyid_dispatcher'>dispatcher</span><span class='period'>.</span><span class='id identifier rubyid_url'>url</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_dispatch'>dispatch</span><span class='lparen'>(</span> <span class='const'>HELPER_OWNER</span> <span class='rparen'>)</span><span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id identifier rubyid_instance'>instance</span><span class='op'>|</span>

                <span class='kw'>if</span> <span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_rpc_exception?'>rpc_exception?</span>
                    <span class='id identifier rubyid_log'>log</span><span class='period'>.</span><span class='id identifier rubyid_webui_helper_instance_connect_failed'>webui_helper_instance_connect_failed</span><span class='lparen'>(</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_url'>url</span> <span class='rparen'>)</span>
                    <span class='kw'>next</span>
                <span class='kw'>end</span>

                <span class='cvar'>@@arachni</span> <span class='op'>=</span> <span class='id identifier rubyid_instances'>instances</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span> <span class='id identifier rubyid_instance'>instance</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span><span class='comma'>,</span> <span class='id identifier rubyid_instance'>instance</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>token</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span>
                <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span> <span class='cvar'>@@arachni</span> <span class='rparen'>)</span>
            <span class='rbrace'>}</span>
        <span class='kw'>end</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="instances-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>instances</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


347
348
349</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 347</span>

<span class='kw'>def</span> <span class='id identifier rubyid_instances'>instances</span>
    <span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_instances'>instances</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="log-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>log</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


324
325
326</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 324</span>

<span class='kw'>def</span> <span class='id identifier rubyid_log'>log</span>
    <span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_log'>log</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="options-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>options</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


418
419
420</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 418</span>

<span class='kw'>def</span> <span class='id identifier rubyid_options'>options</span>
    <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Options</span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="prep_modules-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>prep_modules</strong>(params) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


500
501
502
503
504
505</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 500</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prep_modules'>prep_modules</span><span class='lparen'>(</span> <span class='id identifier rubyid_params'>params</span> <span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>-</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>modules</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_mods'>mods</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>modules</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>*</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_mods'>mods</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_mods'>mods</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="prep_opts-instance_method">
  
    - (<tt>Hash</tt>) <strong>prep_opts</strong>(params) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Prepares form params to be used as options for RPC transmission</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>params</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>normalized hash</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 442</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prep_opts'>prep_opts</span><span class='lparen'>(</span> <span class='id identifier rubyid_params'>params</span> <span class='rparen'>)</span>

    <span class='id identifier rubyid_need_to_split'>need_to_split</span> <span class='op'>=</span> <span class='lbracket'>[</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>exclude_cookies</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>exclude</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>include</span><span class='tstring_end'>'</span></span>
    <span class='rbracket'>]</span>

    <span class='id identifier rubyid_cparams'>cparams</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_params'>params</span><span class='period'>.</span><span class='id identifier rubyid_each_pair'>each_pair</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='comma'>,</span> <span class='id identifier rubyid_value'>value</span><span class='op'>|</span>

        <span class='kw'>next</span> <span class='kw'>if</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>_csrf</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>modules</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>plugins</span><span class='tstring_end'>'</span></span> <span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span> <span class='id identifier rubyid_name'>name</span> <span class='rparen'>)</span> <span class='op'>||</span> <span class='lparen'>(</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span> <span class='const'>String</span> <span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span><span class='rparen'>)</span>

        <span class='id identifier rubyid_value'>value</span> <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id identifier rubyid_value'>value</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>on</span><span class='tstring_end'>'</span></span>

        <span class='kw'>if</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cookiejar</span><span class='tstring_end'>'</span></span>
           <span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cookies</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>HTTP</span><span class='period'>.</span><span class='id identifier rubyid_parse_cookiejar'>parse_cookiejar</span><span class='lparen'>(</span> <span class='id identifier rubyid_value'>value</span><span class='lbracket'>[</span><span class='symbol'>:tempfile</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>extend_paths</span><span class='tstring_end'>'</span></span>
           <span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>extend_paths</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Options</span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_paths_from_file'>paths_from_file</span><span class='lparen'>(</span> <span class='id identifier rubyid_value'>value</span><span class='lbracket'>[</span><span class='symbol'>:tempfile</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>restrict_paths</span><span class='tstring_end'>'</span></span>
           <span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>restrict_paths</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Options</span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_paths_from_file'>paths_from_file</span><span class='lparen'>(</span> <span class='id identifier rubyid_value'>value</span><span class='lbracket'>[</span><span class='symbol'>:tempfile</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_need_to_split'>need_to_split</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span> <span class='id identifier rubyid_name'>name</span> <span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span> <span class='const'>String</span> <span class='rparen'>)</span>
            <span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span>

        <span class='kw'>elsif</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>redundant</span><span class='tstring_end'>'</span></span>
            <span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
            <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id identifier rubyid_rule'>rule</span><span class='op'>|</span>
                <span class='id identifier rubyid_regexp'>regexp</span><span class='comma'>,</span> <span class='id identifier rubyid_counter'>counter</span> <span class='op'>=</span> <span class='id identifier rubyid_rule'>rule</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>:</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='int'>2</span> <span class='rparen'>)</span>
                <span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='lbrace'>{</span>
                    <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>regexp</span><span class='tstring_end'>'</span></span>  <span class='op'>=&gt;</span> <span class='id identifier rubyid_regexp'>regexp</span><span class='comma'>,</span>
                    <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>count</span><span class='tstring_end'>'</span></span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_counter'>counter</span>
                <span class='rbrace'>}</span>
            <span class='rbrace'>}</span>
        <span class='kw'>elsif</span> <span class='id identifier rubyid_name'>name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>custom_headers</span><span class='tstring_end'>'</span></span>
            <span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
            <span class='id identifier rubyid_value'>value</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id identifier rubyid_line'>line</span><span class='op'>|</span>
                <span class='id identifier rubyid_header'>header</span><span class='comma'>,</span> <span class='id identifier rubyid_val'>val</span> <span class='op'>=</span> <span class='id identifier rubyid_line'>line</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_split'>split</span><span class='lparen'>(</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>=</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='int'>2</span> <span class='rparen'>)</span>
                <span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_header'>header</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_val'>val</span>
            <span class='rbrace'>}</span>
        <span class='kw'>else</span>
            <span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_to_i'>to_i</span><span class='lparen'>(</span> <span class='id identifier rubyid_value'>value</span> <span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='rbrace'>}</span>

    <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_links</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_forms</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span>
          <span class='op'>!</span><span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_cookies</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_headers</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>

        <span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_links</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='kw'>true</span>
        <span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_forms</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='kw'>true</span>
        <span class='id identifier rubyid_cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_cookies</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_cparams'>cparams</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="prep_plugins-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>prep_plugins</strong>(params) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


507
508
509
510
511
512
513
514
515
516
517</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 507</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prep_plugins'>prep_plugins</span><span class='lparen'>(</span> <span class='id identifier rubyid_params'>params</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_plugins'>plugins</span>  <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_plugins'>plugins</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>plugins</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>plugins</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id identifier rubyid_name'>name</span><span class='op'>|</span>
        <span class='id identifier rubyid_plugins'>plugins</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>options</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id identifier rubyid_name'>name</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='rbrace'>}</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_plugins'>plugins</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="prep_session-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>prep_session</strong>(skip_dispatcher = false) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Makes sure that all systems are go and populates the session with default
values</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604
605
606
607
608
609
610
611
612
613
614
615
616
617
618
619
620</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 587</span>

<span class='kw'>def</span> <span class='id identifier rubyid_prep_session'>prep_session</span><span class='lparen'>(</span> <span class='id identifier rubyid_skip_dispatcher'>skip_dispatcher</span> <span class='op'>=</span> <span class='kw'>false</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='symbol'>:flash</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

    <span class='id identifier rubyid_ensure_dispatcher'>ensure_dispatcher</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_skip_dispatcher'>skip_dispatcher</span>

    <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>opts</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>opts</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>settings</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_links</span><span class='tstring_end'>'</span></span>    <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_forms</span><span class='tstring_end'>'</span></span>    <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_cookies</span><span class='tstring_end'>'</span></span>  <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http_req_limit</span><span class='tstring_end'>'</span></span> <span class='op'>=&gt;</span> <span class='int'>20</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>user_agent</span><span class='tstring_end'>'</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Arachni/</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>VERSION</span>
    <span class='rbrace'>}</span>
    <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>opts</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>modules</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>*</span><span class='tstring_end'>'</span></span> <span class='rbracket'>]</span>


    <span class='id identifier rubyid_require'>require</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Options</span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_dir'>dir</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>lib</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>framework</span><span class='tstring_end'>'</span></span>
    <span class='id identifier rubyid_framework'>framework</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Framework</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Options</span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_plugins'>plugins</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Plugin</span><span class='op'>::</span><span class='const'>Manager</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span> <span class='id identifier rubyid_framework'>framework</span> <span class='rparen'>)</span>

    <span class='id identifier rubyid_default_plugins'>default_plugins</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_plugins'>plugins</span><span class='period'>.</span><span class='id identifier rubyid_parse'>parse</span><span class='lparen'>(</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Plugin</span><span class='op'>::</span><span class='const'>Manager</span><span class='op'>::</span><span class='const'>DEFAULT</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id identifier rubyid_mod'>mod</span><span class='op'>|</span>
        <span class='id identifier rubyid_default_plugins'>default_plugins</span><span class='lbracket'>[</span><span class='id identifier rubyid_mod'>mod</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>opts</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>plugins</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'>YAML</span><span class='op'>::</span><span class='id identifier rubyid_dump'>dump</span><span class='lparen'>(</span> <span class='id identifier rubyid_default_plugins'>default_plugins</span> <span class='rparen'>)</span>

    <span class='comment'>#
</span>    <span class='comment'># Garbage collector, zombie killer. Reaps idle processes every 60 seconds.
</span>    <span class='comment'>#
</span>    <span class='cvar'>@@zombie_reaper</span> <span class='op'>||=</span>
        <span class='op'>::</span><span class='const'>EM</span><span class='period'>.</span><span class='id identifier rubyid_add_periodic_timer'>add_periodic_timer</span><span class='lparen'>(</span> <span class='int'>60</span> <span class='rparen'>)</span><span class='lbrace'>{</span> <span class='op'>::</span><span class='const'>EM</span><span class='period'>.</span><span class='id identifier rubyid_defer'>defer</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_shutdown_zombies'>shutdown_zombies</span> <span class='rbrace'>}</span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="redirect-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>redirect</strong>(location, opts = {}) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


307
308
309
310
311
312
313
314
315
316
317</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 307</span>

<span class='kw'>def</span> <span class='id identifier rubyid_redirect'>redirect</span><span class='lparen'>(</span> <span class='id identifier rubyid_location'>location</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id identifier rubyid_methods'>methods</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span> <span class='symbol'>:current_addon</span> <span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_current_addon'>current_addon</span>
        <span class='id identifier rubyid_location'>location</span> <span class='op'>=</span> <span class='id identifier rubyid_current_addon'>current_addon</span><span class='period'>.</span><span class='id identifier rubyid_path_root'>path_root</span> <span class='op'>+</span> <span class='id identifier rubyid_location'>location</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='lparen'>(</span> <span class='id identifier rubyid_flash'>flash</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:flash</span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_flash'>flash</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>
        <span class='id identifier rubyid_location'>location</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>?</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_flash'>flash</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='const'>URI</span><span class='period'>.</span><span class='id identifier rubyid_encode'>encode</span><span class='lparen'>(</span> <span class='id identifier rubyid_flash'>flash</span><span class='period'>.</span><span class='id identifier rubyid_values'>values</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>

    <span class='kw'>super</span><span class='lparen'>(</span> <span class='id identifier rubyid_location'>location</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="reports-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>reports</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


328
329
330</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 328</span>

<span class='kw'>def</span> <span class='id identifier rubyid_reports'>reports</span>
    <span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_reports'>reports</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="save_and_shutdown-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>save_and_shutdown</strong>(url, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Saves the report and shuts down the instance</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>arachni</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../RPC/Client/Instance.html" title="Arachni::RPC::Client::Instance (class)">Arachni::RPC::Client::Instance</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 644</span>

<span class='kw'>def</span> <span class='id identifier rubyid_save_and_shutdown'>save_and_shutdown</span><span class='lparen'>(</span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_instance'>instance</span> <span class='op'>=</span> <span class='id identifier rubyid_instances'>instances</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_clean_up!'>clean_up!</span><span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id identifier rubyid_res'>res</span><span class='op'>|</span>

        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_res'>res</span><span class='period'>.</span><span class='id identifier rubyid_rpc_connection_error?'>rpc_connection_error?</span>
            <span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_auditstore'>auditstore</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id identifier rubyid_auditstore'>auditstore</span><span class='op'>|</span>

                <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_auditstore'>auditstore</span><span class='period'>.</span><span class='id identifier rubyid_rpc_connection_error?'>rpc_connection_error?</span>
                    <span class='id identifier rubyid_log'>log</span><span class='period'>.</span><span class='id identifier rubyid_webui_save_and_shutdown_auditstore_success'>webui_save_and_shutdown_auditstore_success</span><span class='lparen'>(</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_url'>url</span> <span class='rparen'>)</span>
                    <span class='id identifier rubyid_report_path'>report_path</span> <span class='op'>=</span> <span class='id identifier rubyid_reports'>reports</span><span class='period'>.</span><span class='id identifier rubyid_save'>save</span><span class='lparen'>(</span> <span class='id identifier rubyid_auditstore'>auditstore</span> <span class='rparen'>)</span>
                    <span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_service'>service</span><span class='period'>.</span><span class='id identifier rubyid_shutdown!'>shutdown!</span><span class='lbrace'>{</span> <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span> <span class='id identifier rubyid_report_path'>report_path</span> <span class='rparen'>)</span> <span class='rbrace'>}</span>
                <span class='kw'>else</span>
                    <span class='id identifier rubyid_log'>log</span><span class='period'>.</span><span class='id identifier rubyid_webui_save_and_shutdown_auditstore_failed'>webui_save_and_shutdown_auditstore_failed</span><span class='lparen'>(</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_url'>url</span> <span class='rparen'>)</span>
                    <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span> <span class='id identifier rubyid_auditstore'>auditstore</span> <span class='rparen'>)</span>
                <span class='kw'>end</span>
            <span class='rbrace'>}</span>
        <span class='kw'>else</span>
            <span class='id identifier rubyid_log'>log</span><span class='period'>.</span><span class='id identifier rubyid_webui_save_and_shutdown_clean_up_failed'>webui_save_and_shutdown_clean_up_failed</span><span class='lparen'>(</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_url'>url</span> <span class='rparen'>)</span>
            <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span><span class='lparen'>(</span> <span class='id identifier rubyid_res'>res</span> <span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="scheduler-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>scheduler</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


343
344
345</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 343</span>

<span class='kw'>def</span> <span class='id identifier rubyid_scheduler'>scheduler</span>
    <span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_scheduler'>scheduler</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="show-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>show</strong>(page, layout = true) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 359</span>

<span class='kw'>def</span> <span class='id identifier rubyid_show'>show</span><span class='lparen'>(</span> <span class='id identifier rubyid_page'>page</span><span class='comma'>,</span> <span class='id identifier rubyid_layout'>layout</span> <span class='op'>=</span> <span class='kw'>true</span> <span class='rparen'>)</span>

    <span class='kw'>case</span> <span class='id identifier rubyid_page'>page</span>
        <span class='kw'>when</span> <span class='symbol'>:dispatchers</span>
            <span class='id identifier rubyid_ensure_dispatcher'>ensure_dispatcher</span>
            <span class='id identifier rubyid_dispatcher'>dispatcher</span><span class='period'>.</span><span class='id identifier rubyid_stats'>stats</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id identifier rubyid_stats'>stats</span><span class='op'>|</span>
                <span class='id identifier rubyid_erb'>erb</span> <span class='symbol'>:dispatchers</span>
            <span class='rbrace'>}</span>

        <span class='kw'>when</span> <span class='symbol'>:home</span>
            <span class='id identifier rubyid_dispatchers'>dispatchers</span><span class='period'>.</span><span class='id identifier rubyid_stats'>stats</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id identifier rubyid_stats'>stats</span><span class='op'>|</span>
                <span class='id identifier rubyid_body'>body</span> <span class='id identifier rubyid_erb'>erb</span> <span class='id identifier rubyid_page'>page</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='symbol'>:layout</span> <span class='op'>=&gt;</span> <span class='kw'>true</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='symbol'>:stats</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_stats'>stats</span>
            <span class='rbrace'>}</span>
        <span class='kw'>else</span>
            <span class='id identifier rubyid_erb'>erb</span> <span class='id identifier rubyid_page'>page</span><span class='period'>.</span><span class='id identifier rubyid_to_sym'>to_sym</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='symbol'>:layout</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_layout'>layout</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="show_dispatcher_line-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>show_dispatcher_line</strong>(stats) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 379</span>

<span class='kw'>def</span> <span class='id identifier rubyid_show_dispatcher_line'>show_dispatcher_line</span><span class='lparen'>(</span> <span class='id identifier rubyid_stats'>stats</span> <span class='rparen'>)</span>

    <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>@</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id identifier rubyid_stats'>stats</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>node</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> - </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_stats'>stats</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>running_jobs</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span><span class='rbrace'>}</span><span class='tstring_content'> running scans, </span><span class='tstring_end'>&quot;</span></span>

    <span class='id identifier rubyid_rss'>rss</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_mem'>mem</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id identifier rubyid_cpu'>cpu</span> <span class='op'>=</span> <span class='int'>0</span>

    <span class='id identifier rubyid_stats'>stats</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>running_jobs</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id identifier rubyid_job'>job</span><span class='op'>|</span>
        <span class='id identifier rubyid_rss'>rss</span> <span class='op'>+=</span> <span class='id identifier rubyid_proc_mem'>proc_mem</span><span class='lparen'>(</span> <span class='id identifier rubyid_job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>proc</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>rss</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
        <span class='id identifier rubyid_mem'>mem</span> <span class='op'>+=</span> <span class='const'>Float</span><span class='lparen'>(</span> <span class='id identifier rubyid_job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>proc</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>pctmem</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>proc</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>pctmem</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
        <span class='id identifier rubyid_cpu'>cpu</span> <span class='op'>+=</span> <span class='const'>Float</span><span class='lparen'>(</span> <span class='id identifier rubyid_job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>proc</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>pctcpu</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id identifier rubyid_job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>proc</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>pctcpu</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
    <span class='rbrace'>}</span>
    <span class='id identifier rubyid_str'>str</span> <span class='op'>+=</span> <span class='id identifier rubyid_rss'>rss</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>MB RAM usage </span><span class='tstring_end'>'</span></span>
    <span class='id identifier rubyid_str'>str</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>(</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id identifier rubyid_mem'>mem</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='int'>4</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>%), </span><span class='tstring_end'>'</span></span>
    <span class='id identifier rubyid_str'>str</span> <span class='op'>+=</span> <span class='id identifier rubyid_cpu'>cpu</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='lbracket'>[</span><span class='int'>0</span><span class='op'>..</span><span class='int'>4</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>% CPU usage</span><span class='tstring_end'>'</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="show_dispatcher_node_line-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>show_dispatcher_node_line</strong>(stats) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


399
400
401
402
403</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 399</span>

<span class='kw'>def</span> <span class='id identifier rubyid_show_dispatcher_node_line'>show_dispatcher_node_line</span><span class='lparen'>(</span> <span class='id identifier rubyid_stats'>stats</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Nickname: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_stats'>stats</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>node</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>nickname</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_content'> - </span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_str'>str</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Pipe ID: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_stats'>stats</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>node</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>pipe_id</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_content'> - </span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_str'>str</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Weight: </span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_stats'>stats</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>node</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>weight</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="show_error-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>show_error</strong>(title, message = '', backtrace = []) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


716
717
718
719
720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 716</span>

<span class='kw'>def</span> <span class='id identifier rubyid_show_error'>show_error</span><span class='lparen'>(</span> <span class='id identifier rubyid_title'>title</span><span class='comma'>,</span> <span class='id identifier rubyid_message'>message</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id identifier rubyid_backtrace'>backtrace</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_skip'>skip</span> <span class='op'>=</span> <span class='lbracket'>[</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>rack.input</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>rack.errors</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>async.callback</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>async.close</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>rack.logger</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
    <span class='rbracket'>]</span>

    <span class='id identifier rubyid_err_env'>err_env</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='id identifier rubyid_env'>env</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='comma'>,</span> <span class='id identifier rubyid_v'>v</span><span class='op'>|</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_skip'>skip</span><span class='period'>.</span><span class='id identifier rubyid_include?'>include?</span><span class='lparen'>(</span> <span class='id identifier rubyid_k'>k</span> <span class='rparen'>)</span>
        <span class='id identifier rubyid_err_env'>err_env</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_v'>v</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_err_env'>err_env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>rack.session.options</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span> <span class='symbol'>:coder</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_err_env'>err_env</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>rack.session.options</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_delete'>delete</span><span class='lparen'>(</span> <span class='symbol'>:secure_random</span> <span class='rparen'>)</span>

    <span class='id identifier rubyid_err_env'>err_env</span><span class='period'>.</span><span class='id identifier rubyid_merge!'>merge!</span><span class='lparen'>(</span>
        <span class='symbol'>:title</span>     <span class='op'>=&gt;</span> <span class='id identifier rubyid_title'>title</span><span class='comma'>,</span>
        <span class='symbol'>:message</span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_message'>message</span><span class='comma'>,</span>
        <span class='symbol'>:backtrace</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span>
    <span class='rparen'>)</span>

    <span class='id identifier rubyid_erb'>erb</span> <span class='symbol'>:error</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='symbol'>:layout</span> <span class='op'>=&gt;</span> <span class='kw'>true</span> <span class='rbrace'>}</span><span class='comma'>,</span>
        <span class='symbol'>:title</span>     <span class='op'>=&gt;</span> <span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span> <span class='id identifier rubyid_title'>title</span> <span class='rparen'>)</span><span class='comma'>,</span>
        <span class='symbol'>:message</span>   <span class='op'>=&gt;</span> <span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span> <span class='id identifier rubyid_message'>message</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_gsub'>gsub</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>&lt;br /&gt;</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span><span class='comma'>,</span>
        <span class='symbol'>:backtrace</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span> <span class='id identifier rubyid_backtrace'>backtrace</span><span class='period'>.</span><span class='id identifier rubyid_join'>join</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\n</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span> <span class='rparen'>)</span><span class='comma'>,</span>
        <span class='symbol'>:env</span>       <span class='op'>=&gt;</span> <span class='id identifier rubyid_escape'>escape</span><span class='lparen'>(</span> <span class='id identifier rubyid_err_env'>err_env</span><span class='period'>.</span><span class='id identifier rubyid_to_yaml'>to_yaml</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="shutdown_all-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>shutdown_all</strong>(url, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Kills all running instances</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


672
673
674
675
676
677
678
679
680
681
682
683
684
685
686
687
688</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 672</span>

<span class='kw'>def</span> <span class='id identifier rubyid_shutdown_all'>shutdown_all</span><span class='lparen'>(</span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_dispatchers'>dispatchers</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span> <span class='id identifier rubyid_url'>url</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_stats'>stats</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id identifier rubyid_stats'>stats</span><span class='op'>|</span>
        <span class='id identifier rubyid_log'>log</span><span class='period'>.</span><span class='id identifier rubyid_dispatcher_global_shutdown'>dispatcher_global_shutdown</span><span class='lparen'>(</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_url'>url</span> <span class='rparen'>)</span>

        <span class='id identifier rubyid_stats'>stats</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>running_jobs</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id identifier rubyid_instance'>instance</span><span class='op'>|</span>

            <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_instance'>instance</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>helpers</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>rank</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>slave</span><span class='tstring_end'>'</span></span>

            <span class='id identifier rubyid_save_and_shutdown'>save_and_shutdown</span><span class='lparen'>(</span> <span class='id identifier rubyid_instance'>instance</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span><span class='lbrace'>{</span>
                <span class='id identifier rubyid_log'>log</span><span class='period'>.</span><span class='id identifier rubyid_instance_shutdown'>instance_shutdown</span><span class='lparen'>(</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_instance'>instance</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span>
            <span class='rbrace'>}</span>
        <span class='rbrace'>}</span>
        <span class='id identifier rubyid_block'>block</span><span class='period'>.</span><span class='id identifier rubyid_call'>call</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="shutdown_zombies-instance_method">
  
    - (<tt>Integer</tt>) <strong>shutdown_zombies</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Kills all idle instances</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the number of reaped instances</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710
711
712
713
714</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 695</span>

<span class='kw'>def</span> <span class='id identifier rubyid_shutdown_zombies'>shutdown_zombies</span>
    <span class='id identifier rubyid_dispatchers'>dispatchers</span><span class='period'>.</span><span class='id identifier rubyid_jobs'>jobs</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id identifier rubyid_jobs'>jobs</span><span class='op'>|</span>
        <span class='id identifier rubyid_jobs'>jobs</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id identifier rubyid_job'>job</span><span class='op'>|</span>
            <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>helpers</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>rank</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>slave</span><span class='tstring_end'>'</span></span> <span class='op'>||</span>
                <span class='id identifier rubyid_job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>owner</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='const'>HELPER_OWNER</span>

            <span class='id identifier rubyid_instances'>instances</span><span class='period'>.</span><span class='id identifier rubyid_connect'>connect</span><span class='lparen'>(</span> <span class='id identifier rubyid_job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_session'>session</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_framework'>framework</span><span class='period'>.</span><span class='id identifier rubyid_busy?'>busy?</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id identifier rubyid_busy'>busy</span><span class='op'>|</span>

                <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_busy'>busy</span><span class='period'>.</span><span class='id identifier rubyid_rpc_exception?'>rpc_exception?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_busy'>busy</span>
                    <span class='id identifier rubyid_save_and_shutdown'>save_and_shutdown</span><span class='lparen'>(</span> <span class='id identifier rubyid_job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span><span class='lbrace'>{</span>
                        <span class='id identifier rubyid_log'>log</span><span class='period'>.</span><span class='id identifier rubyid_webui_zombie_cleanup'>webui_zombie_cleanup</span><span class='lparen'>(</span> <span class='id identifier rubyid_env'>env</span><span class='comma'>,</span> <span class='id identifier rubyid_job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span>
                    <span class='rbrace'>}</span>
                <span class='kw'>end</span>
            <span class='rbrace'>}</span>
        <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_i-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>to_i</strong>(str) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Similar to String.to_i but it returns the original object if String is not
a number</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


425
426
427
428
429
430
431
432
433</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 425</span>

<span class='kw'>def</span> <span class='id identifier rubyid_to_i'>to_i</span><span class='lparen'>(</span> <span class='id identifier rubyid_str'>str</span> <span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id identifier rubyid_str'>str</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_str'>str</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span> <span class='const'>String</span> <span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_str'>str</span><span class='period'>.</span><span class='id identifier rubyid_match'>match</span><span class='lparen'>(</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\d+</span><span class='regexp_end'>/</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='id identifier rubyid_str'>str</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span>
        <span class='kw'>return</span> <span class='id identifier rubyid_str'>str</span><span class='period'>.</span><span class='id identifier rubyid_to_i'>to_i</span>
    <span class='kw'>else</span>
        <span class='kw'>return</span> <span class='id identifier rubyid_str'>str</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="welcomed!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>welcomed!</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


409
410
411</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 409</span>

<span class='kw'>def</span> <span class='id identifier rubyid_welcomed!'>welcomed!</span>
    <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span><span class='lparen'>(</span> <span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_db'>db</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/welcomed</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>w</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_close'>close</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="welcomed?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>welcomed?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


405
406
407</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/ui/web/server.rb', line 405</span>

<span class='kw'>def</span> <span class='id identifier rubyid_welcomed?'>welcomed?</span>
    <span class='const'>File</span><span class='period'>.</span><span class='id identifier rubyid_exist?'>exist?</span><span class='lparen'>(</span> <span class='id identifier rubyid_settings'>settings</span><span class='period'>.</span><span class='id identifier rubyid_db'>db</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/welcomed</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Mon Jan  9 22:04:17 2012 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.4 (ruby-1.9.3).
</div>

  </body>
</html>