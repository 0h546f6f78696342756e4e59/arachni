<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Class: Arachni::UI::Web::Server</title>
<link rel="stylesheet" href="../../../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../../..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../../../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../../../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../../_index.html">Index (S)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../../Arachni.html" title="Arachni (module)">Arachni</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../UI.html" title="Arachni::UI (module)">UI</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Web.html" title="Arachni::UI::Web (module)">Web</a></span></span>
     &raquo; 
    <span class="title">Server</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Arachni::UI::Web::Server
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName">Sinatra::Base</span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Sinatra::Base</li>
          
            <li class="next">Arachni::UI::Web::Server</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
  
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/ui/web/server.rb</dd>
  
</dl>
<div class="clear"></div>


  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="HELPER_OWNER-constant" class="">HELPER_OWNER =
          <div class="docstring">
  <div class="discussion">
    <p>
This will be used for the &#8220;owner&#8221; field of the helper instance
</p>


  </div>
</div>
<div class="tags">
  
</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>WebUI helper</span><span class='tstring_end'>&quot;</span></span></pre></dd>
      
    </dl>
  


  

  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prep_webrick-class_method" title="prep_webrick (class method)">+ (Object) <strong>prep_webrick</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#run%21-class_method" title="run! (class method)">+ (Object) <strong>run!</strong>(options = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
override run! using this patch: <a
href="https://github.com/sinatra/sinatra/pull/132">github.com/sinatra/sinatra/pull/132</a>.
</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#component_cache_filled%3F-instance_method" title="#component_cache_filled? (instance method)">- (Boolean) <strong>component_cache_filled?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connect_to_instance-instance_method" title="#connect_to_instance (instance method)">- (Object) <strong>connect_to_instance</strong>(port) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Provides an easy way to connect to an instance by port.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dispatcher-instance_method" title="#dispatcher (instance method)">- (Object) <strong>dispatcher</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Provides easy access to the dispatcher and handles failure.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#dispatcher_stats-instance_method" title="#dispatcher_stats (instance method)">- (Object) <strong>dispatcher_stats</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Provides statistics about running jobs etc using the dispatcher.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ensure_dispatcher-instance_method" title="#ensure_dispatcher (instance method)">- (Bool) <strong>ensure_dispatcher</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Makes sure that we have a dispatcher, if not it redirects the user to an
appropriate error page.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#ensure_welcomed-instance_method" title="#ensure_welcomed (instance method)">- (Object) <strong>ensure_welcomed</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#escape_hash-instance_method" title="#escape_hash (instance method)">- (Object) <strong>escape_hash</strong>(hash) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#exception_jail-instance_method" title="#exception_jail (instance method)">- (Object) <strong>exception_jail</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#fill_component_cache-instance_method" title="#fill_component_cache (instance method)">- (Object) <strong>fill_component_cache</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#helper_instance-instance_method" title="#helper_instance (instance method)">- (Object) <strong>helper_instance</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#options-instance_method" title="#options (instance method)">- (Object) <strong>options</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#port_to_url-instance_method" title="#port_to_url (instance method)">- (Object) <strong>port_to_url</strong>(port) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Converts a port to a URL instance.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prep_modules-instance_method" title="#prep_modules (instance method)">- (Object) <strong>prep_modules</strong>(params) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prep_opts-instance_method" title="#prep_opts (instance method)">- (Hash) <strong>prep_opts</strong>(params) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Prepares form params to be used as options for XMLRPC transmission.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prep_plugins-instance_method" title="#prep_plugins (instance method)">- (Object) <strong>prep_plugins</strong>(params) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prep_session-instance_method" title="#prep_session (instance method)">- (Object) <strong>prep_session</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Makes sure that all systems are go and populates the session with default
values.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#save_and_shutdown-instance_method" title="#save_and_shutdown (instance method)">- (Object) <strong>save_and_shutdown</strong>(arachni) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Saves the report and shuts down the instance.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#save_shutdown_and_show-instance_method" title="#save_shutdown_and_show (instance method)">- (Object) <strong>save_shutdown_and_show</strong>(arachni) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Saves the report, shuts down the instance and returns the content as HTML
to be sent back to the user&#8217;s browser.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#show-instance_method" title="#show (instance method)">- (Object) <strong>show</strong>(page, layout = true) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#shutdown_all-instance_method" title="#shutdown_all (instance method)">- (Object) <strong>shutdown_all</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Kills all running instances.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#shutdown_zombies-instance_method" title="#shutdown_zombies (instance method)">- (Integer) <strong>shutdown_zombies</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Kills all idle instances.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#to_i-instance_method" title="#to_i (instance method)">- (Object) <strong>to_i</strong>(str) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Similar to String.to_i but it returns the original object if String is not
a number.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#unescape_hash-instance_method" title="#unescape_hash (instance method)">- (Object) <strong>unescape_hash</strong>(hash) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#welcomed%21-instance_method" title="#welcomed! (instance method)">- (Object) <strong>welcomed!</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#welcomed%3F-instance_method" title="#welcomed? (instance method)">- (Boolean) <strong>welcomed?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  

  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="prep_webrick-class_method">
  
    + (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>prep_webrick</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 856</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id prep_webrick'>prep_webrick</span>
    <span class='kw'>if</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>server</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>key</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
        <span class='id pkey'>pkey</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>PKey</span><span class='op'>::</span><span class='const'>RSA</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='const'>File</span><span class='period'>.</span><span class='id read'>read</span><span class='lparen'>(</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>server</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>key</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>server</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cert</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
        <span class='id cert'>cert</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>X509</span><span class='op'>::</span><span class='const'>Certificate</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='const'>File</span><span class='period'>.</span><span class='id read'>read</span><span class='lparen'>(</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>server</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cert</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>key</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cert</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ca</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
        <span class='id verification'>verification</span> <span class='op'>=</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='op'>::</span><span class='const'>VERIFY_PEER</span> <span class='op'>|</span> <span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='op'>::</span><span class='const'>VERIFY_FAIL_IF_NO_PEER_CERT</span>
    <span class='kw'>else</span>
        <span class='id verification'>verification</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>OpenSSL</span><span class='op'>::</span><span class='const'>SSL</span><span class='op'>::</span><span class='const'>VERIFY_NONE</span>
    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='lbrace'>{</span>
        <span class='symbol'>:SSLEnable</span>       <span class='op'>=&gt;</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>server</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>enable</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='kw'>false</span><span class='comma'>,</span>
        <span class='symbol'>:SSLVerifyClient</span> <span class='op'>=&gt;</span> <span class='id verification'>verification</span><span class='comma'>,</span>
        <span class='symbol'>:SSLCertName</span>     <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>CN</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Options</span><span class='period'>.</span><span class='id instance'>instance</span><span class='period'>.</span><span class='id server'>server</span> <span class='op'>||</span> <span class='op'>::</span><span class='const'>WEBrick</span><span class='op'>::</span><span class='const'>Utils</span><span class='op'>::</span><span class='id getservername'>getservername</span> <span class='rbracket'>]</span> <span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:SSLCertificate</span>  <span class='op'>=&gt;</span> <span class='id cert'>cert</span><span class='comma'>,</span>
        <span class='symbol'>:SSLPrivateKey</span>   <span class='op'>=&gt;</span> <span class='id pkey'>pkey</span><span class='comma'>,</span>
        <span class='symbol'>:SSLCACertificateFile</span> <span class='op'>=&gt;</span> <span class='cvar'>@@conf</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ssl</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>server</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>ca</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="run!-class_method">
  
    + (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>run!</strong>(options = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
override run! using this patch: <a
href="https://github.com/sinatra/sinatra/pull/132">github.com/sinatra/sinatra/pull/132</a>
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


835
836
837
838
839
840
841
842
843
844
845
846
847
848
849
850
851
852
853
854</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 835</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id run!'>run!</span><span class='lparen'>(</span> <span class='id options'>options</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='rparen'>)</span>
    <span class='id set'>set</span> <span class='id options'>options</span>

    <span class='id handler'>handler</span> <span class='op'>=</span> <span class='id detect_rack_handler'>detect_rack_handler</span>
    <span class='id handler_name'>handler_name</span> <span class='op'>=</span> <span class='id handler'>handler</span><span class='period'>.</span><span class='id name'>name</span><span class='period'>.</span><span class='id gsub'>gsub</span><span class='lparen'>(</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>.*::</span><span class='regexp_end'>/</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>

    <span class='comment'># handler specific options use the lower case handler name as hash key, if present
</span>    <span class='id handler_opts'>handler_opts</span> <span class='op'>=</span> <span class='id options'>options</span><span class='lbracket'>[</span><span class='id handler_name'>handler_name</span><span class='period'>.</span><span class='id downcase'>downcase</span><span class='period'>.</span><span class='id to_sym'>to_sym</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

    <span class='id puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>== Sinatra/</span><span class='embexpr_beg'>#{</span><span class='const'>Sinatra</span><span class='op'>::</span><span class='const'>VERSION</span><span class='rbrace'>}</span><span class='tstring_content'> has taken the stage </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
        <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>on </span><span class='embexpr_beg'>#{</span><span class='id port'>port</span><span class='rbrace'>}</span><span class='tstring_content'> for </span><span class='embexpr_beg'>#{</span><span class='id environment'>environment</span><span class='rbrace'>}</span><span class='tstring_content'> with backup from </span><span class='embexpr_beg'>#{</span><span class='id handler_name'>handler_name</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>unless</span> <span class='id handler_name'>handler_name</span> <span class='op'>=~</span><span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>cgi</span><span class='regexp_end'>/i</span></span>

    <span class='id handler'>handler</span><span class='period'>.</span><span class='id run'>run</span> <span class='kw'>self</span><span class='comma'>,</span> <span class='id handler_opts'>handler_opts</span><span class='period'>.</span><span class='id merge'>merge</span><span class='lparen'>(</span> <span class='symbol'>:Host</span> <span class='op'>=&gt;</span> <span class='id bind'>bind</span><span class='comma'>,</span> <span class='symbol'>:Port</span> <span class='op'>=&gt;</span> <span class='id port'>port</span> <span class='rparen'>)</span> <span class='kw'>do</span> <span class='op'>|</span><span class='id server'>server</span><span class='op'>|</span>
        <span class='lbracket'>[</span> <span class='symbol'>:INT</span><span class='comma'>,</span> <span class='symbol'>:TERM</span> <span class='rbracket'>]</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id sig'>sig</span><span class='op'>|</span> <span class='id trap'>trap</span><span class='lparen'>(</span> <span class='id sig'>sig</span> <span class='rparen'>)</span> <span class='lbrace'>{</span> <span class='id quit!'>quit!</span><span class='lparen'>(</span> <span class='id server'>server</span><span class='comma'>,</span> <span class='id handler_name'>handler_name</span> <span class='rparen'>)</span> <span class='rbrace'>}</span> <span class='rbrace'>}</span>

        <span class='id set'>set</span> <span class='symbol'>:running</span><span class='comma'>,</span> <span class='kw'>true</span>
    <span class='kw'>end</span>
<span class='kw'>rescue</span> <span class='const'>Errno</span><span class='op'>::</span><span class='const'>EADDRINUSE</span> <span class='op'>=&gt;</span> <span class='id e'>e</span>
    <span class='id puts'>puts</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>== Someone is already performing on port </span><span class='embexpr_beg'>#{</span><span class='id port'>port</span><span class='rbrace'>}</span><span class='tstring_content'>!</span><span class='tstring_end'>&quot;</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="component_cache_filled?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>component_cache_filled?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


379
380
381
382
383
384
385</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 379</span>

<span class='kw'>def</span> <span class='id component_cache_filled?'>component_cache_filled?</span>
    <span class='kw'>begin</span>
        <span class='kw'>return</span> <span class='cvar'>@@modules</span><span class='period'>.</span><span class='id size'>size</span> <span class='op'>+</span> <span class='cvar'>@@plugins</span><span class='period'>.</span><span class='id size'>size</span>
    <span class='kw'>rescue</span>
        <span class='kw'>return</span> <span class='kw'>false</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="connect_to_instance-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>connect_to_instance</strong>(port) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Provides an easy way to connect to an instance by port
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <span class='name'>port</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


209
210
211
212
213
214
215
216
217</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 209</span>

<span class='kw'>def</span> <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='id port'>port</span> <span class='rparen'>)</span>
    <span class='id prep_session'>prep_session</span>

    <span class='kw'>begin</span>
        <span class='kw'>return</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>RPC</span><span class='op'>::</span><span class='const'>XML</span><span class='op'>::</span><span class='const'>Client</span><span class='op'>::</span><span class='const'>Instance</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='id options'>options</span><span class='comma'>,</span> <span class='id port_to_url'>port_to_url</span><span class='lparen'>(</span> <span class='id port'>port</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span>
        <span class='id raise'>raise</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Instance on port </span><span class='embexpr_beg'>#{</span><span class='id port'>port</span><span class='rbrace'>}</span><span class='tstring_content'> has shutdown.</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="dispatcher-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>dispatcher</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Provides easy access to the dispatcher and handles failure
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


233
234
235
236
237
238
239</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 233</span>

<span class='kw'>def</span> <span class='id dispatcher'>dispatcher</span>
    <span class='kw'>begin</span>
        <span class='ivar'>@dispatcher</span> <span class='op'>||=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>RPC</span><span class='op'>::</span><span class='const'>XML</span><span class='op'>::</span><span class='const'>Client</span><span class='op'>::</span><span class='const'>Dispatcher</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='id options'>options</span><span class='comma'>,</span> <span class='id session'>session</span><span class='lbracket'>[</span><span class='symbol'>:dispatcher_url</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id e'>e</span>
        <span class='id redirect'>redirect</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/dispatcher_error</span><span class='tstring_end'>'</span></span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="dispatcher_stats-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>dispatcher_stats</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Provides statistics about running jobs etc using the dispatcher
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


244
245
246
247
248
249
250
251
252
253
254</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 244</span>

<span class='kw'>def</span> <span class='id dispatcher_stats'>dispatcher_stats</span>
    <span class='id stats'>stats</span> <span class='op'>=</span> <span class='id dispatcher'>dispatcher</span><span class='period'>.</span><span class='id stats'>stats</span>
    <span class='id stats'>stats</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>running_jobs</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id job'>job</span><span class='op'>|</span>
        <span class='kw'>begin</span>
            <span class='id job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>paused</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='id job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>port</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id framework'>framework</span><span class='period'>.</span><span class='id paused?'>paused?</span>
        <span class='kw'>rescue</span>
        <span class='kw'>end</span>
    <span class='rbrace'>}</span>
    <span class='kw'>return</span> <span class='id stats'>stats</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="ensure_dispatcher-instance_method">
  
    - (<tt>Bool</tt>) <strong>ensure_dispatcher</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Makes sure that we have a dispatcher, if not it redirects the user to an
appropriate error page.
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
true if alive, redirect if not
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


444
445
446
447
448
449
450</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 444</span>

<span class='kw'>def</span> <span class='id ensure_dispatcher'>ensure_dispatcher</span>
    <span class='kw'>begin</span>
        <span class='id dispatcher'>dispatcher</span><span class='period'>.</span><span class='id alive?'>alive?</span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id e'>e</span>
        <span class='id redirect'>redirect</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/dispatcher/error</span><span class='tstring_end'>'</span></span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="ensure_welcomed-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>ensure_welcomed</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


197
198
199
200
201
202</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 197</span>

<span class='kw'>def</span> <span class='id ensure_welcomed'>ensure_welcomed</span>
    <span class='kw'>return</span> <span class='kw'>if</span> <span class='id welcomed?'>welcomed?</span>

    <span class='id welcomed!'>welcomed!</span>
    <span class='id redirect'>redirect</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/welcome</span><span class='tstring_end'>'</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="escape_hash-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>escape_hash</strong>(hash) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


327
328
329
330
331
332
333
334
335</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 327</span>

<span class='kw'>def</span> <span class='id escape_hash'>escape_hash</span><span class='lparen'>(</span> <span class='id hash'>hash</span> <span class='rparen'>)</span>
    <span class='id hash'>hash</span><span class='period'>.</span><span class='id each_pair'>each_pair</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id k'>k</span><span class='comma'>,</span> <span class='id v'>v</span><span class='op'>|</span>
        <span class='id hash'>hash</span><span class='lbracket'>[</span><span class='id k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id escape'>escape</span><span class='lparen'>(</span> <span class='id hash'>hash</span><span class='lbracket'>[</span><span class='id k'>k</span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id hash'>hash</span><span class='lbracket'>[</span><span class='id k'>k</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span> <span class='const'>String</span> <span class='rparen'>)</span>
        <span class='id hash'>hash</span><span class='lbracket'>[</span><span class='id k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id escape_hash'>escape_hash</span><span class='lparen'>(</span> <span class='id v'>v</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id v'>v</span><span class='period'>.</span><span class='id is_a?'>is_a?</span> <span class='const'>Hash</span>
    <span class='rbrace'>}</span>

    <span class='kw'>return</span> <span class='id hash'>hash</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="exception_jail-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>exception_jail</strong>(&amp;block) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


172
173
174
175
176
177
178</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 172</span>

<span class='kw'>def</span> <span class='id exception_jail'>exception_jail</span><span class='lparen'>(</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
    <span class='comment'># begin
</span>        <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span>
    <span class='comment'># rescue Errno::ECONNREFUSED =&gt; e
</span>    <span class='comment'>#     erb :error, { :layout =&gt; true }, :error =&gt; 'Remote server has been shut down.'
</span>    <span class='comment'># end
</span><span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="fill_component_cache-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>fill_component_cache</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


387
388
389
390
391
392
393
394
395
396
397
398
399
400</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 387</span>

<span class='kw'>def</span> <span class='id fill_component_cache'>fill_component_cache</span>

    <span class='kw'>if</span> <span class='op'>!</span><span class='id component_cache_filled?'>component_cache_filled?</span>
        <span class='id do_shutdown'>do_shutdown</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>else</span>
        <span class='id do_shutdown'>do_shutdown</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='kw'>end</span>

    <span class='cvar'>@@modules</span> <span class='op'>||=</span> <span class='id helper_instance'>helper_instance</span><span class='period'>.</span><span class='id framework'>framework</span><span class='period'>.</span><span class='id lsmod'>lsmod</span><span class='period'>.</span><span class='id dup'>dup</span>
    <span class='cvar'>@@plugins</span> <span class='op'>||=</span> <span class='id helper_instance'>helper_instance</span><span class='period'>.</span><span class='id framework'>framework</span><span class='period'>.</span><span class='id lsplug'>lsplug</span><span class='period'>.</span><span class='id dup'>dup</span>

    <span class='comment'># shutdown the helper instance, we got what we wanted
</span>    <span class='id helper_instance'>helper_instance</span><span class='period'>.</span><span class='id service'>service</span><span class='period'>.</span><span class='id shutdown!'>shutdown!</span> <span class='kw'>if</span> <span class='id do_shutdown'>do_shutdown</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="helper_instance-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>helper_instance</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


366
367
368
369
370
371
372
373
374
375
376
377</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 366</span>

<span class='kw'>def</span> <span class='id helper_instance'>helper_instance</span>
    <span class='kw'>begin</span>
        <span class='cvar'>@@arachni</span> <span class='op'>||=</span> <span class='kw'>nil</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='cvar'>@@arachni</span>
            <span class='id instance'>instance</span> <span class='op'>=</span> <span class='id dispatcher'>dispatcher</span><span class='period'>.</span><span class='id dispatch'>dispatch</span><span class='lparen'>(</span> <span class='const'>HELPER_OWNER</span> <span class='rparen'>)</span>
            <span class='cvar'>@@arachni</span> <span class='op'>=</span> <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='id instance'>instance</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>port</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span>
        <span class='kw'>end</span>
        <span class='kw'>return</span> <span class='cvar'>@@arachni</span>
    <span class='kw'>rescue</span>
        <span class='id redirect'>redirect</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/dispatcher/error</span><span class='tstring_end'>'</span></span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="options-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>options</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


256
257
258</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 256</span>

<span class='kw'>def</span> <span class='id options'>options</span>
    <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Options</span><span class='period'>.</span><span class='id instance'>instance</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="port_to_url-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>port_to_url</strong>(port) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Converts a port to a URL instance.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
        <span class='name'>port</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


224
225
226
227
228</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 224</span>

<span class='kw'>def</span> <span class='id port_to_url'>port_to_url</span><span class='lparen'>(</span> <span class='id port'>port</span> <span class='rparen'>)</span>
    <span class='id uri'>uri</span> <span class='op'>=</span> <span class='const'>URI</span><span class='lparen'>(</span> <span class='id session'>session</span><span class='lbracket'>[</span><span class='symbol'>:dispatcher_url</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
    <span class='id uri'>uri</span><span class='period'>.</span><span class='id port'>port</span> <span class='op'>=</span> <span class='id port'>port</span><span class='period'>.</span><span class='id to_i'>to_i</span>
    <span class='id uri'>uri</span><span class='period'>.</span><span class='id to_s'>to_s</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="prep_modules-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>prep_modules</strong>(params) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


347
348
349
350
351
352</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 347</span>

<span class='kw'>def</span> <span class='id prep_modules'>prep_modules</span><span class='lparen'>(</span> <span class='id params'>params</span> <span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>-</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>modules</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
    <span class='id mods'>mods</span> <span class='op'>=</span> <span class='id params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>modules</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id keys'>keys</span>
    <span class='kw'>return</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>*</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id mods'>mods</span><span class='period'>.</span><span class='id empty?'>empty?</span>
    <span class='kw'>return</span> <span class='id mods'>mods</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="prep_opts-instance_method">
  
    - (<tt>Hash</tt>) <strong>prep_opts</strong>(params) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Prepares form params to be used as options for XMLRPC transmission
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <span class='name'>params</span>
      
      
      
    </li>
  
</ul>
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
normalized hash
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 280</span>

<span class='kw'>def</span> <span class='id prep_opts'>prep_opts</span><span class='lparen'>(</span> <span class='id params'>params</span> <span class='rparen'>)</span>

    <span class='id need_to_split'>need_to_split</span> <span class='op'>=</span> <span class='lbracket'>[</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>exclude_cookies</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>exclude</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>include</span><span class='tstring_end'>'</span></span>
    <span class='rbracket'>]</span>

    <span class='id cparams'>cparams</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='id params'>params</span><span class='period'>.</span><span class='id each_pair'>each_pair</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id name'>name</span><span class='comma'>,</span> <span class='id value'>value</span><span class='op'>|</span>

        <span class='kw'>next</span> <span class='kw'>if</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>_csrf</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>modules</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>plugins</span><span class='tstring_end'>'</span></span> <span class='rbracket'>]</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span> <span class='id name'>name</span> <span class='rparen'>)</span> <span class='op'>||</span> <span class='lparen'>(</span> <span class='id value'>value</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span> <span class='const'>String</span> <span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id value'>value</span><span class='period'>.</span><span class='id empty?'>empty?</span><span class='rparen'>)</span>

        <span class='id value'>value</span> <span class='op'>=</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='id value'>value</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>on</span><span class='tstring_end'>'</span></span>

        <span class='kw'>if</span> <span class='id name'>name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cookiejar</span><span class='tstring_end'>'</span></span>
           <span class='id cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cookies</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>HTTP</span><span class='period'>.</span><span class='id parse_cookiejar'>parse_cookiejar</span><span class='lparen'>(</span> <span class='id value'>value</span><span class='lbracket'>[</span><span class='symbol'>:tempfile</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
        <span class='kw'>elsif</span> <span class='id need_to_split'>need_to_split</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span> <span class='id name'>name</span> <span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id value'>value</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span> <span class='const'>String</span> <span class='rparen'>)</span>
            <span class='id cparams'>cparams</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id value'>value</span><span class='period'>.</span><span class='id split'>split</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span>

        <span class='kw'>elsif</span> <span class='id name'>name</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>redundant</span><span class='tstring_end'>'</span></span>
            <span class='id cparams'>cparams</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
            <span class='id value'>value</span><span class='period'>.</span><span class='id split'>split</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>\r\n</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id rule'>rule</span><span class='op'>|</span>
                <span class='id regexp'>regexp</span><span class='comma'>,</span> <span class='id counter'>counter</span> <span class='op'>=</span> <span class='id rule'>rule</span><span class='period'>.</span><span class='id split'>split</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>:</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='int'>2</span> <span class='rparen'>)</span>
                <span class='id cparams'>cparams</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='lbrace'>{</span>
                    <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>regexp</span><span class='tstring_end'>'</span></span>  <span class='op'>=&gt;</span> <span class='id regexp'>regexp</span><span class='comma'>,</span>
                    <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>count</span><span class='tstring_end'>'</span></span>   <span class='op'>=&gt;</span> <span class='id counter'>counter</span>
                <span class='rbrace'>}</span>
            <span class='rbrace'>}</span>
        <span class='kw'>else</span>
            <span class='id cparams'>cparams</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id to_i'>to_i</span><span class='lparen'>(</span> <span class='id value'>value</span> <span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='rbrace'>}</span>

    <span class='kw'>if</span> <span class='op'>!</span><span class='id cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_links</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_forms</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span>
          <span class='op'>!</span><span class='id cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_cookies</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_headers</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>

        <span class='id cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_links</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='kw'>true</span>
        <span class='id cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_forms</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='kw'>true</span>
        <span class='id cparams'>cparams</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_cookies</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='id cparams'>cparams</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="prep_plugins-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>prep_plugins</strong>(params) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


354
355
356
357
358
359
360
361
362
363
364</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 354</span>

<span class='kw'>def</span> <span class='id prep_plugins'>prep_plugins</span><span class='lparen'>(</span> <span class='id params'>params</span> <span class='rparen'>)</span>
    <span class='id plugins'>plugins</span>  <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>

    <span class='kw'>return</span> <span class='id plugins'>plugins</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>plugins</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
    <span class='id params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>plugins</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id keys'>keys</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id name'>name</span><span class='op'>|</span>
        <span class='id plugins'>plugins</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id params'>params</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>options</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='rbrace'>}</span>

    <span class='kw'>return</span> <span class='id plugins'>plugins</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="prep_session-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>prep_session</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Makes sure that all systems are go and populates the session with default
values
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 405</span>

<span class='kw'>def</span> <span class='id prep_session'>prep_session</span>
    <span class='id session'>session</span><span class='lbracket'>[</span><span class='symbol'>:dispatcher_url</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http://localhost:7331</span><span class='tstring_end'>'</span></span>

    <span class='id ensure_dispatcher'>ensure_dispatcher</span>

    <span class='id session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>opts</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='id session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>opts</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>settings</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbrace'>{</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_links</span><span class='tstring_end'>'</span></span>    <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_forms</span><span class='tstring_end'>'</span></span>    <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_cookies</span><span class='tstring_end'>'</span></span>  <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>http_req_limit</span><span class='tstring_end'>'</span></span> <span class='op'>=&gt;</span> <span class='int'>20</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>user_agent</span><span class='tstring_end'>'</span></span>     <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Arachni/</span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>VERSION</span>
    <span class='rbrace'>}</span>
    <span class='id session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>opts</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>modules</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>*</span><span class='tstring_end'>'</span></span> <span class='rbracket'>]</span>
    <span class='id session'>session</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>opts</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>plugins</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='const'>YAML</span><span class='op'>::</span><span class='id dump'>dump</span><span class='lparen'>(</span> <span class='lbrace'>{</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>content_types</span><span class='tstring_end'>'</span></span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>healthmap</span><span class='tstring_end'>'</span></span>     <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>metamodules</span><span class='tstring_end'>'</span></span>   <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='rbrace'>}</span> <span class='rparen'>)</span>


    <span class='comment'>#
</span>    <span class='comment'># Garbage collector, zombie killer. Reaps idle processes every 5 seconds.
</span>    <span class='comment'>#
</span>    <span class='cvar'>@@reaper</span> <span class='op'>||=</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id new'>new</span> <span class='lbrace'>{</span>
        <span class='kw'>while</span><span class='lparen'>(</span> <span class='kw'>true</span> <span class='rparen'>)</span>
            <span class='id shutdown_zombies'>shutdown_zombies</span>
            <span class='op'>::</span><span class='const'>IO</span><span class='op'>::</span><span class='id select'>select</span><span class='lparen'>(</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='kw'>nil</span><span class='comma'>,</span> <span class='int'>5</span> <span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='rbrace'>}</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="save_and_shutdown-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>save_and_shutdown</strong>(arachni) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Saves the report and shuts down the instance
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="../../RPC/XML/Client/Instance.html" title="Arachni::RPC::XML::Client::Instance (class)">Arachni::RPC::XML::Client::Instance</a></span></tt>)</span>
      
      
        <span class='name'>arachni</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


468
469
470
471
472
473</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 468</span>

<span class='kw'>def</span> <span class='id save_and_shutdown'>save_and_shutdown</span><span class='lparen'>(</span> <span class='id arachni'>arachni</span> <span class='rparen'>)</span>
    <span class='id arachni'>arachni</span><span class='period'>.</span><span class='id framework'>framework</span><span class='period'>.</span><span class='id clean_up!'>clean_up!</span>
    <span class='id report_path'>report_path</span> <span class='op'>=</span> <span class='id settings'>settings</span><span class='period'>.</span><span class='id reports'>reports</span><span class='period'>.</span><span class='id save'>save</span><span class='lparen'>(</span> <span class='id arachni'>arachni</span><span class='period'>.</span><span class='id framework'>framework</span><span class='period'>.</span><span class='id auditstore'>auditstore</span> <span class='rparen'>)</span>
    <span class='id arachni'>arachni</span><span class='period'>.</span><span class='id service'>service</span><span class='period'>.</span><span class='id shutdown!'>shutdown!</span>
    <span class='kw'>return</span> <span class='id report_path'>report_path</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="save_shutdown_and_show-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>save_shutdown_and_show</strong>(arachni) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Saves the report, shuts down the instance and returns the content as HTML
to be sent back to the user&#8217;s browser.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="../../RPC/XML/Client/Instance.html" title="Arachni::RPC::XML::Client::Instance (class)">Arachni::RPC::XML::Client::Instance</a></span></tt>)</span>
      
      
        <span class='name'>arachni</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


458
459
460
461</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 458</span>

<span class='kw'>def</span> <span class='id save_shutdown_and_show'>save_shutdown_and_show</span><span class='lparen'>(</span> <span class='id arachni'>arachni</span> <span class='rparen'>)</span>
    <span class='id report'>report</span> <span class='op'>=</span> <span class='id save_and_shutdown'>save_and_shutdown</span><span class='lparen'>(</span> <span class='id arachni'>arachni</span> <span class='rparen'>)</span>
    <span class='id settings'>settings</span><span class='period'>.</span><span class='id reports'>reports</span><span class='period'>.</span><span class='id get'>get</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>html</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='const'>File</span><span class='period'>.</span><span class='id basename'>basename</span><span class='lparen'>(</span> <span class='id report'>report</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>.afr</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="show-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>show</strong>(page, layout = true) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


180
181
182
183
184
185
186
187</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 180</span>

<span class='kw'>def</span> <span class='id show'>show</span><span class='lparen'>(</span> <span class='id page'>page</span><span class='comma'>,</span> <span class='id layout'>layout</span> <span class='op'>=</span> <span class='kw'>true</span> <span class='rparen'>)</span>
    <span class='kw'>if</span> <span class='id page'>page</span> <span class='op'>==</span> <span class='symbol'>:dispatcher</span>
        <span class='id ensure_dispatcher'>ensure_dispatcher</span>
        <span class='id erb'>erb</span> <span class='symbol'>:dispatcher</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='symbol'>:layout</span> <span class='op'>=&gt;</span> <span class='kw'>true</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='symbol'>:stats</span> <span class='op'>=&gt;</span> <span class='id dispatcher_stats'>dispatcher_stats</span>
    <span class='kw'>else</span>
        <span class='id erb'>erb</span> <span class='id page'>page</span><span class='period'>.</span><span class='id to_sym'>to_sym</span><span class='comma'>,</span> <span class='lbrace'>{</span> <span class='symbol'>:layout</span> <span class='op'>=&gt;</span> <span class='id layout'>layout</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="shutdown_all-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>shutdown_all</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Kills all running instances
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 478</span>

<span class='kw'>def</span> <span class='id shutdown_all'>shutdown_all</span>
    <span class='id settings'>settings</span><span class='period'>.</span><span class='id log'>log</span><span class='period'>.</span><span class='id dispatcher_global_shutdown'>dispatcher_global_shutdown</span><span class='lparen'>(</span> <span class='id env'>env</span> <span class='rparen'>)</span>
    <span class='id dispatcher'>dispatcher</span><span class='period'>.</span><span class='id stats'>stats</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>running_jobs</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id job'>job</span><span class='op'>|</span>
        <span class='kw'>begin</span>
            <span class='id save_and_shutdown'>save_and_shutdown</span><span class='lparen'>(</span> <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='id job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>port</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
        <span class='kw'>rescue</span>
            <span class='kw'>begin</span>
                <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='id job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>port</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id service'>service</span><span class='period'>.</span><span class='id shutdown!'>shutdown!</span>
            <span class='kw'>rescue</span>
                <span class='id settings'>settings</span><span class='period'>.</span><span class='id log'>log</span><span class='period'>.</span><span class='id instance_fucker_wont_die'>instance_fucker_wont_die</span><span class='lparen'>(</span> <span class='id env'>env</span><span class='comma'>,</span> <span class='id port_to_url'>port_to_url</span><span class='lparen'>(</span> <span class='id job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>port</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
                <span class='kw'>next</span>
            <span class='kw'>end</span>
        <span class='kw'>end</span>

        <span class='id settings'>settings</span><span class='period'>.</span><span class='id log'>log</span><span class='period'>.</span><span class='id instance_shutdown'>instance_shutdown</span><span class='lparen'>(</span> <span class='id env'>env</span><span class='comma'>,</span> <span class='id port_to_url'>port_to_url</span><span class='lparen'>(</span> <span class='id job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>port</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="shutdown_zombies-instance_method">
  
    - (<tt>Integer</tt>) <strong>shutdown_zombies</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Kills all idle instances
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
the number of reaped instances
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 502</span>

<span class='kw'>def</span> <span class='id shutdown_zombies'>shutdown_zombies</span>
    <span class='id i'>i</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='id dispatcher'>dispatcher</span><span class='period'>.</span><span class='id stats'>stats</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>running_jobs</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id job'>job</span><span class='op'>|</span>

        <span class='kw'>begin</span>
            <span class='id arachni'>arachni</span> <span class='op'>=</span> <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='id job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>port</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span>

            <span class='kw'>begin</span>
                <span class='kw'>if</span> <span class='op'>!</span><span class='id arachni'>arachni</span><span class='period'>.</span><span class='id framework'>framework</span><span class='period'>.</span><span class='id busy?'>busy?</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>owner</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='const'>HELPER_OWNER</span>
                    <span class='id save_and_shutdown'>save_and_shutdown</span><span class='lparen'>(</span> <span class='id arachni'>arachni</span> <span class='rparen'>)</span>
                    <span class='id settings'>settings</span><span class='period'>.</span><span class='id log'>log</span><span class='period'>.</span><span class='id webui_zombie_cleanup'>webui_zombie_cleanup</span><span class='lparen'>(</span> <span class='id env'>env</span><span class='comma'>,</span> <span class='id port_to_url'>port_to_url</span><span class='lparen'>(</span> <span class='id job'>job</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>port</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
                    <span class='id i'>i</span><span class='op'>+=</span><span class='int'>1</span>
                <span class='kw'>end</span>
            <span class='kw'>rescue</span>

            <span class='kw'>end</span>

        <span class='kw'>rescue</span>
        <span class='kw'>end</span>
    <span class='rbrace'>}</span>

    <span class='kw'>return</span> <span class='id i'>i</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="to_i-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>to_i</strong>(str) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Similar to String.to_i but it returns the original object if String is not
a number
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


263
264
265
266
267
268
269
270
271</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 263</span>

<span class='kw'>def</span> <span class='id to_i'>to_i</span><span class='lparen'>(</span> <span class='id str'>str</span> <span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='id str'>str</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id str'>str</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span> <span class='const'>String</span> <span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id str'>str</span><span class='period'>.</span><span class='id match'>match</span><span class='lparen'>(</span> <span class='tstring'><span class='regexp_beg'>/</span><span class='tstring_content'>\d+</span><span class='regexp_end'>/</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='period'>.</span><span class='id size'>size</span> <span class='op'>==</span> <span class='id str'>str</span><span class='period'>.</span><span class='id size'>size</span>
        <span class='kw'>return</span> <span class='id str'>str</span><span class='period'>.</span><span class='id to_i'>to_i</span>
    <span class='kw'>else</span>
        <span class='kw'>return</span> <span class='id str'>str</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="unescape_hash-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>unescape_hash</strong>(hash) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


337
338
339
340
341
342
343
344
345</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 337</span>

<span class='kw'>def</span> <span class='id unescape_hash'>unescape_hash</span><span class='lparen'>(</span> <span class='id hash'>hash</span> <span class='rparen'>)</span>
    <span class='id hash'>hash</span><span class='period'>.</span><span class='id each_pair'>each_pair</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id k'>k</span><span class='comma'>,</span> <span class='id v'>v</span><span class='op'>|</span>
        <span class='id hash'>hash</span><span class='lbracket'>[</span><span class='id k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id unescape'>unescape</span><span class='lparen'>(</span> <span class='id hash'>hash</span><span class='lbracket'>[</span><span class='id k'>k</span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id hash'>hash</span><span class='lbracket'>[</span><span class='id k'>k</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id is_a?'>is_a?</span><span class='lparen'>(</span> <span class='const'>String</span> <span class='rparen'>)</span>
        <span class='id hash'>hash</span><span class='lbracket'>[</span><span class='id k'>k</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id unescape_hash'>unescape_hash</span><span class='lparen'>(</span> <span class='id v'>v</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id v'>v</span><span class='period'>.</span><span class='id is_a?'>is_a?</span> <span class='const'>Hash</span>
    <span class='rbrace'>}</span>

    <span class='kw'>return</span> <span class='id hash'>hash</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="welcomed!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>welcomed!</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


193
194
195</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 193</span>

<span class='kw'>def</span> <span class='id welcomed!'>welcomed!</span>
    <span class='const'>File</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='id settings'>settings</span><span class='period'>.</span><span class='id db'>db</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/welcomed</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>w</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span><span class='period'>.</span><span class='id close'>close</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="welcomed?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>welcomed?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


189
190
191</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/ui/web/server.rb', line 189</span>

<span class='kw'>def</span> <span class='id welcomed?'>welcomed?</span>
    <span class='const'>File</span><span class='period'>.</span><span class='id exist?'>exist?</span><span class='lparen'>(</span> <span class='id settings'>settings</span><span class='period'>.</span><span class='id db'>db</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>/welcomed</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Mon Feb 14 15:42:57 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.4 (ruby-1.9.2).
</div>

  </body>
</html>