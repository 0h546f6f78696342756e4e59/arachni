<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Arachni::Framework
  
    &mdash; Arachni - Web Application Security Scanner Framework
  
</title>

  <link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (F)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../Arachni.html" title="Arachni (module)">Arachni</a></span></span>
     &raquo; 
    <span class="title">Framework</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Arachni::Framework
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Arachni::Framework</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="Mixins/Observable.html" title="Arachni::Mixins::Observable (module)">Mixins::Observable</a></span>, <span class='object_link'><a href="Module/Utilities.html" title="Arachni::Module::Utilities (module)">Module::Utilities</a></span>, <span class='object_link'><a href="UI/Output.html" title="Arachni::UI::Output (module)">UI::Output</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/arachni/framework.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>The Framework class ties together all the components.</p>

<p>It should be wrapped by a UI class.</p>

<p>It's the brains of the operation, it bosses the rest of the classes around.</p>

<p>It runs the audit, loads modules and reports and runs them according to
user options.</p>

<p>@author: Tasos "Zapotek" Laskos</p>

<pre class="code">&lt;tasos.laskos@gmail.com&gt;
&lt;zapotek@segfault.gr&gt;</pre>

<p>@version: 0.2.5</p>


  </div>
</div>
<div class="tags">
  

</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="RPC/Server/Framework.html" title="Arachni::RPC::Server::Framework (class)">RPC::Server::Framework</a></span></p>
</div>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="REVISION-constant" class="">REVISION =
          <div class="docstring">
  <div class="discussion">
    
<p>the version of <b>this</b> class</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>0.2.5</span><span class='tstring_end'>'</span></span></pre></dd>
      
    </dl>
  


  
  
  
  
  
  
  
  
  
  
  
  
  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#auditmap-instance_method" title="#auditmap (instance method)">- (Array) <strong>auditmap</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Array of URLs that have been audited.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#modules-instance_method" title="#modules (instance method)">- (Arachni::Module::Manager) <strong>modules</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Module manager.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#opts-instance_method" title="#opts (instance method)">- (Options) <strong>opts</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Instance options.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#page_queue_size-instance_method" title="#page_queue_size (instance method)">- (Integer) <strong>page_queue_size</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Current amount of pages in the audit queue.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#page_queue_total_size-instance_method" title="#page_queue_total_size (instance method)">- (Integer) <strong>page_queue_total_size</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Total number of pages added to their audit queue.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#plugins-instance_method" title="#plugins (instance method)">- (Arachni::Plugin::Manager) <strong>plugins</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Plugin manager.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#reports-instance_method" title="#reports (instance method)">- (Arachni::Report::Manager) <strong>reports</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Report manager.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#sitemap-instance_method" title="#sitemap (instance method)">- (Array) <strong>sitemap</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>URLs of all discovered pages.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#spider-instance_method" title="#spider (instance method)">- (Arachni::Spider) <strong>spider</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Spider.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#url_queue_size-instance_method" title="#url_queue_size (instance method)">- (Integer) <strong>url_queue_size</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Current amount of urls in the audit queue.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#url_queue_total_size-instance_method" title="#url_queue_total_size (instance method)">- (Integer) <strong>url_queue_total_size</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Total number of urls added to their audit queue.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  
  
  
  
  
  
  

  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit-instance_method" title="#audit (instance method)">- (Object) <strong>audit</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Performs the audit.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit_page_queue-instance_method" title="#audit_page_queue (instance method)">- (Object) <strong>audit_page_queue</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Audits the page queue.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit_queue-instance_method" title="#audit_queue (instance method)">- (Object) <strong>audit_queue</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Audits the URL and Page queues.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit_store-instance_method" title="#audit_store (instance method)">- (AuditStore) <strong>audit_store</strong>(fresh = true) </a>
    

    
      (also: #auditstore)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the results of the audit as an <span class='object_link'><a href="AuditStore.html" title="Arachni::AuditStore (class)">AuditStore</a></span> instance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit_store_sitemap-instance_method" title="#audit_store_sitemap (instance method)">- (Array) <strong>audit_store_sitemap</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Special sitemap for the auditstore.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clean_up%21-instance_method" title="#clean_up! (instance method)">- (True) <strong>clean_up!</strong>(skip_audit_queue = false) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Cleans up the framework; should be called after running the audit or after
canceling a running scan.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#http-instance_method" title="#http (instance method)">- (Arachni::HTTP) <strong>http</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>HTTP instance.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Framework) <strong>initialize</strong>(opts) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Initializes system components.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#lsmod-instance_method" title="#lsmod (instance method)">- (Array&lt;Hash&gt;) <strong>lsmod</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns an array of hashes with information about all available modules.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#lsplug-instance_method" title="#lsplug (instance method)">- (Array&lt;Hash&gt;) <strong>lsplug</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns an array of hashes with information about all available reports.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#lsrep-instance_method" title="#lsrep (instance method)">- (Array&lt;Hash&gt;) <strong>lsrep</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns an array of hashes with information about all available reports.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pause%21-instance_method" title="#pause! (instance method)">- (True) <strong>pause!</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Pauses the framework on a best effort basis, might take a while to take
effect.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#paused%3F-instance_method" title="#paused? (instance method)">- (Bool) <strong>paused?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>True if the framework is paused or in the process of.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#plugin_store-instance_method" title="#plugin_store (instance method)">- (Object) <strong>plugin_store</strong>(plugin, obj) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Adds an object to the plugin store.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#prepare-instance_method" title="#prepare (instance method)">- (Object) <strong>prepare</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Prepares the framework for the audit.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#push_to_page_queue-instance_method" title="#push_to_page_queue (instance method)">- (Object) <strong>push_to_page_queue</strong>(page) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Pushes a page to the page audit queue and updates <span class='object_link'><a href="#page_queue_total_size-instance_method" title="Arachni::Framework#page_queue_total_size (method)">#page_queue_total_size</a></span>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#push_to_url_queue-instance_method" title="#push_to_url_queue (instance method)">- (Object) <strong>push_to_url_queue</strong>(url) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Pushes a URL to the URL audit queue and updates <span class='object_link'><a href="#url_queue_total_size-instance_method" title="Arachni::Framework#url_queue_total_size (method)">#url_queue_total_size</a></span>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resume%21-instance_method" title="#resume! (instance method)">- (True) <strong>resume!</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Resumes the scan/audit.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#revision-instance_method" title="#revision (instance method)">- (String) <strong>revision</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the revision of the <span class='object_link'><a href="" title="Arachni::Framework (class)">Framework</a></span> (this) class.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#run-instance_method" title="#run (instance method)">- (Object) <strong>run</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Runs the system.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#running%3F-instance_method" title="#running? (instance method)">- (Bool) <strong>running?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>True if the framework is running.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stats-instance_method" title="#stats (instance method)">- (Hash) <strong>stats</strong>(refresh_time = false, override_refresh = false) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the following framework stats:.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#version-instance_method" title="#version (instance method)">- (String) <strong>version</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the version of the framework.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Mixins/Observable.html" title="Arachni::Mixins::Observable (module)">Mixins::Observable</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Mixins/Observable.html#method_missing-instance_method" title="Arachni::Mixins::Observable#method_missing (method)">#method_missing</a></span></p>

  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/Utilities.html" title="Arachni::Module::Utilities (module)">Module::Utilities</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Utilities.html#exception_jail-instance_method" title="Arachni::Module::Utilities#exception_jail (method)">#exception_jail</a></span>, <span class='object_link'><a href="Module/Utilities.html#get_path-instance_method" title="Arachni::Module::Utilities#get_path (method)">#get_path</a></span>, <span class='object_link'><a href="Module/Utilities.html#hash_keys_to_str-instance_method" title="Arachni::Module::Utilities#hash_keys_to_str (method)">#hash_keys_to_str</a></span>, <span class='object_link'><a href="Module/Utilities.html#normalize_url-instance_method" title="Arachni::Module::Utilities#normalize_url (method)">#normalize_url</a></span>, <span class='object_link'><a href="Module/Utilities.html#read_file-instance_method" title="Arachni::Module::Utilities#read_file (method)">#read_file</a></span>, <span class='object_link'><a href="Module/Utilities.html#seed-instance_method" title="Arachni::Module::Utilities#seed (method)">#seed</a></span>, <span class='object_link'><a href="Module/Utilities.html#uri_decode-instance_method" title="Arachni::Module::Utilities#uri_decode (method)">#uri_decode</a></span>, <span class='object_link'><a href="Module/Utilities.html#uri_encode-instance_method" title="Arachni::Module::Utilities#uri_encode (method)">#uri_encode</a></span>, <span class='object_link'><a href="Module/Utilities.html#uri_parser-instance_method" title="Arachni::Module::Utilities#uri_parser (method)">#uri_parser</a></span>, <span class='object_link'><a href="Module/Utilities.html#url_sanitize-instance_method" title="Arachni::Module::Utilities#url_sanitize (method)">#url_sanitize</a></span></p>

  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="UI/Output.html" title="Arachni::UI::Output (module)">UI::Output</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="UI/Output.html#buffer-instance_method" title="Arachni::UI::Output#buffer (method)">#buffer</a></span>, <span class='object_link'><a href="UI/Output.html#debug%21-instance_method" title="Arachni::UI::Output#debug! (method)">#debug!</a></span>, <span class='object_link'><a href="UI/Output.html#debug%3F-instance_method" title="Arachni::UI::Output#debug? (method)">#debug?</a></span>, <span class='object_link'><a href="UI/Output.html#flush_buffer-instance_method" title="Arachni::UI::Output#flush_buffer (method)">#flush_buffer</a></span>, <span class='object_link'><a href="UI/Output.html#mute%21-instance_method" title="Arachni::UI::Output#mute! (method)">#mute!</a></span>, <span class='object_link'><a href="UI/Output.html#muted%3F-instance_method" title="Arachni::UI::Output#muted? (method)">#muted?</a></span>, <span class='object_link'><a href="UI/Output.html#only_positives%21-instance_method" title="Arachni::UI::Output#only_positives! (method)">#only_positives!</a></span>, <span class='object_link'><a href="UI/Output.html#only_positives%3F-instance_method" title="Arachni::UI::Output#only_positives? (method)">#only_positives?</a></span>, <span class='object_link'><a href="UI/Output.html#print_bad-instance_method" title="Arachni::UI::Output#print_bad (method)">#print_bad</a></span>, <span class='object_link'><a href="UI/Output.html#print_debug-instance_method" title="Arachni::UI::Output#print_debug (method)">#print_debug</a></span>, <span class='object_link'><a href="UI/Output.html#print_debug_backtrace-instance_method" title="Arachni::UI::Output#print_debug_backtrace (method)">#print_debug_backtrace</a></span>, <span class='object_link'><a href="UI/Output.html#print_debug_pp-instance_method" title="Arachni::UI::Output#print_debug_pp (method)">#print_debug_pp</a></span>, <span class='object_link'><a href="UI/Output.html#print_error-instance_method" title="Arachni::UI::Output#print_error (method)">#print_error</a></span>, <span class='object_link'><a href="UI/Output.html#print_error_backtrace-instance_method" title="Arachni::UI::Output#print_error_backtrace (method)">#print_error_backtrace</a></span>, <span class='object_link'><a href="UI/Output.html#print_info-instance_method" title="Arachni::UI::Output#print_info (method)">#print_info</a></span>, <span class='object_link'><a href="UI/Output.html#print_line-instance_method" title="Arachni::UI::Output#print_line (method)">#print_line</a></span>, <span class='object_link'><a href="UI/Output.html#print_ok-instance_method" title="Arachni::UI::Output#print_ok (method)">#print_ok</a></span>, <span class='object_link'><a href="UI/Output.html#print_status-instance_method" title="Arachni::UI::Output#print_status (method)">#print_status</a></span>, <span class='object_link'><a href="UI/Output.html#print_verbose-instance_method" title="Arachni::UI::Output#print_verbose (method)">#print_verbose</a></span>, <span class='object_link'><a href="UI/Output.html#reroute_to_file-instance_method" title="Arachni::UI::Output#reroute_to_file (method)">#reroute_to_file</a></span>, <span class='object_link'><a href="UI/Output.html#reroute_to_file%3F-instance_method" title="Arachni::UI::Output#reroute_to_file? (method)">#reroute_to_file?</a></span>, <span class='object_link'><a href="UI/Output.html#uncap_buffer%21-instance_method" title="Arachni::UI::Output#uncap_buffer! (method)">#uncap_buffer!</a></span>, <span class='object_link'><a href="UI/Output.html#unmute%21-instance_method" title="Arachni::UI::Output#unmute! (method)">#unmute!</a></span>, <span class='object_link'><a href="UI/Output.html#verbose%21-instance_method" title="Arachni::UI::Output#verbose! (method)">#verbose!</a></span>, <span class='object_link'><a href="UI/Output.html#verbose%3F-instance_method" title="Arachni::UI::Output#verbose? (method)">#verbose?</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Arachni::Framework (class)">Framework</a></span></tt>) <strong>initialize</strong>(opts) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Initializes system components.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Options.html" title="Arachni::Options (class)">Options</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 141</span>

<span class='kw'>def</span> <span class='id initialize'>initialize</span><span class='lparen'>(</span> <span class='id opts'>opts</span> <span class='rparen'>)</span>

    <span class='const'>Encoding</span><span class='period'>.</span><span class='id default_external'>default_external</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BINARY</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'>Encoding</span><span class='period'>.</span><span class='id default_internal'>default_internal</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BINARY</span><span class='tstring_end'>&quot;</span></span>

    <span class='ivar'>@opts</span> <span class='op'>=</span> <span class='id opts'>opts</span>

    <span class='ivar'>@modules</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Manager</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='ivar'>@opts</span> <span class='rparen'>)</span>
    <span class='ivar'>@reports</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Report</span><span class='op'>::</span><span class='const'>Manager</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='ivar'>@opts</span> <span class='rparen'>)</span>
    <span class='ivar'>@plugins</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Plugin</span><span class='op'>::</span><span class='const'>Manager</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='kw'>self</span> <span class='rparen'>)</span>

    <span class='comment'># will store full-fledged pages generated by the Trainer since these
</span>    <span class='comment'># may not be be accessible simply by their URL
</span>    <span class='comment'># @page_queue = ::Arachni::Database::Queue.new
</span>    <span class='ivar'>@page_queue</span> <span class='op'>=</span> <span class='const'>Queue</span><span class='period'>.</span><span class='id new'>new</span>
    <span class='ivar'>@page_queue_total_size</span> <span class='op'>=</span> <span class='int'>0</span>

    <span class='comment'># will hold paths found by the spider in order to be converted to pages
</span>    <span class='comment'># and ultimately audited by the modules
</span>    <span class='ivar'>@url_queue</span> <span class='op'>=</span> <span class='const'>Queue</span><span class='period'>.</span><span class='id new'>new</span>
    <span class='ivar'>@url_queue_total_size</span> <span class='op'>=</span> <span class='int'>0</span>

    <span class='id prepare_cookie_jar'>prepare_cookie_jar</span><span class='lparen'>(</span> <span class='rparen'>)</span>
    <span class='id prepare_user_agent'>prepare_user_agent</span><span class='lparen'>(</span> <span class='rparen'>)</span>

    <span class='comment'># deep clone the redundancy rules to preserve their counter
</span>    <span class='comment'># for the reports
</span>    <span class='ivar'>@orig_redundant</span> <span class='op'>=</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id redundant'>redundant</span><span class='period'>.</span><span class='id deep_clone'>deep_clone</span>

    <span class='ivar'>@running</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='ivar'>@paused</span>  <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='ivar'>@plugin_store</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@store</span> <span class='op'>=</span> <span class='kw'>nil</span>

    <span class='ivar'>@auditmap</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@sitemap</span>  <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='ivar'>@current_url</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>
<div id="method_missing_details" class="method_details_list">
  <h2>Dynamic Method Handling</h2>
  <p class="notice super">
    This class handles dynamic methods through the <tt>method_missing</tt> method
    
      in the class <span class='object_link'><a href="Mixins/Observable.html#method_missing-instance_method" title="Arachni::Mixins::Observable#method_missing (method)">Arachni::Mixins::Observable</a></span>
    
  </p>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <span id="auditmap-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="auditmap-instance_method">
  
    - (<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></tt>) <strong>auditmap</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Array of URLs that have been audited</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


105
106
107</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 105</span>

<span class='kw'>def</span> <span class='id auditmap'>auditmap</span>
  <span class='ivar'>@auditmap</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="modules-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="modules-instance_method">
  
    - (<tt><span class='object_link'><a href="Module/Manager.html" title="Arachni::Module::Manager (class)">Arachni::Module::Manager</a></span></tt>) <strong>modules</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Module manager</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Module/Manager.html" title="Arachni::Module::Manager (class)">Arachni::Module::Manager</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>module manager</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


81
82
83</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 81</span>

<span class='kw'>def</span> <span class='id modules'>modules</span>
  <span class='ivar'>@modules</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="opts-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="opts-instance_method">
  
    - (<tt><span class='object_link'><a href="Options.html" title="Arachni::Options (class)">Options</a></span></tt>) <strong>opts</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Instance options</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Options.html" title="Arachni::Options (class)">Options</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


71
72
73</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 71</span>

<span class='kw'>def</span> <span class='id opts'>opts</span>
  <span class='ivar'>@opts</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="page_queue_size-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="page_queue_size-instance_method">
  
    - (<tt>Integer</tt>) <strong>page_queue_size</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Current amount of pages in the audit queue</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


119
120
121</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 119</span>

<span class='kw'>def</span> <span class='id page_queue_size'>page_queue_size</span>
  <span class='ivar'>@page_queue_size</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="page_queue_total_size-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="page_queue_total_size-instance_method">
  
    - (<tt>Integer</tt>) <strong>page_queue_total_size</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Total number of pages added to their audit queue</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


112
113
114</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 112</span>

<span class='kw'>def</span> <span class='id page_queue_total_size'>page_queue_total_size</span>
  <span class='ivar'>@page_queue_total_size</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="plugins-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="plugins-instance_method">
  
    - (<tt><span class='object_link'><a href="Plugin/Manager.html" title="Arachni::Plugin::Manager (class)">Arachni::Plugin::Manager</a></span></tt>) <strong>plugins</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Plugin manager</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Plugin/Manager.html" title="Arachni::Plugin::Manager (class)">Arachni::Plugin::Manager</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>plugin manager</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


86
87
88</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 86</span>

<span class='kw'>def</span> <span class='id plugins'>plugins</span>
  <span class='ivar'>@plugins</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="reports-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="reports-instance_method">
  
    - (<tt><span class='object_link'><a href="Report/Manager.html" title="Arachni::Report::Manager (class)">Arachni::Report::Manager</a></span></tt>) <strong>reports</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Report manager</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Report/Manager.html" title="Arachni::Report::Manager (class)">Arachni::Report::Manager</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>report manager</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


76
77
78</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 76</span>

<span class='kw'>def</span> <span class='id reports'>reports</span>
  <span class='ivar'>@reports</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="sitemap-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="sitemap-instance_method">
  
    - (<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></tt>) <strong>sitemap</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>URLs of all discovered pages</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


98
99
100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 98</span>

<span class='kw'>def</span> <span class='id sitemap'>sitemap</span>
  <span class='ivar'>@sitemap</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="spider-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="spider-instance_method">
  
    - (<tt><span class='object_link'><a href="Spider.html" title="Arachni::Spider (class)">Arachni::Spider</a></span></tt>) <strong>spider</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Spider</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="Spider.html" title="Arachni::Spider (class)">Arachni::Spider</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>spider</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


91
92
93</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 91</span>

<span class='kw'>def</span> <span class='id spider'>spider</span>
  <span class='ivar'>@spider</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="url_queue_size-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="url_queue_size-instance_method">
  
    - (<tt>Integer</tt>) <strong>url_queue_size</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Current amount of urls in the audit queue</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


133
134
135</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 133</span>

<span class='kw'>def</span> <span class='id url_queue_size'>url_queue_size</span>
  <span class='ivar'>@url_queue_size</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="url_queue_total_size-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="url_queue_total_size-instance_method">
  
    - (<tt>Integer</tt>) <strong>url_queue_total_size</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Total number of urls added to their audit queue</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Integer</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126
127
128</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 126</span>

<span class='kw'>def</span> <span class='id url_queue_total_size'>url_queue_total_size</span>
  <span class='ivar'>@url_queue_total_size</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="audit-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>audit</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Performs the audit</p>

<p>Runs the spider, pushes each page or url to their respective audit queue,
calls <span class='object_link'><a href="#audit_queue-instance_method" title="Arachni::Framework#audit_queue (method)">#audit_queue</a></span>, runs the timeout attacks
(<span class='object_link'><a href="Module/Auditor.html#timeout_audit_run-class_method" title="Arachni::Module::Auditor.timeout_audit_run (method)">Module::Auditor.timeout_audit_run</a></span>) and finally re-runs
<span class='object_link'><a href="#audit_queue-instance_method" title="Arachni::Framework#audit_queue (method)">#audit_queue</a></span> in case the timing attacks uncovered a new page.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


404
405
406
407
408
409
410
411
412
413
414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 404</span>

<span class='kw'>def</span> <span class='id audit'>audit</span>
    <span class='id wait_if_paused'>wait_if_paused</span>

    <span class='ivar'>@spider</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Spider</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='ivar'>@opts</span> <span class='rparen'>)</span>

    <span class='comment'># if we're restricted to a given list of paths there's no reason to run the spider
</span>    <span class='kw'>if</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id restrict_paths'>restrict_paths</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='ivar'>@opts</span><span class='period'>.</span><span class='id restrict_paths'>restrict_paths</span><span class='period'>.</span><span class='id empty?'>empty?</span>
        <span class='ivar'>@sitemap</span> <span class='op'>=</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id restrict_paths'>restrict_paths</span>
        <span class='ivar'>@sitemap</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id url'>url</span><span class='op'>|</span>
            <span class='id push_to_url_queue'>push_to_url_queue</span><span class='lparen'>(</span> <span class='id url_sanitize'>url_sanitize</span><span class='lparen'>(</span> <span class='id url'>url</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
        <span class='rbrace'>}</span>
    <span class='kw'>else</span>
        <span class='comment'># initiates the crawl
</span>        <span class='ivar'>@spider</span><span class='period'>.</span><span class='id run'>run</span><span class='lparen'>(</span> <span class='kw'>false</span> <span class='rparen'>)</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id response'>response</span><span class='op'>|</span>
            <span class='ivar'>@sitemap</span> <span class='op'>|=</span> <span class='ivar'>@spider</span><span class='period'>.</span><span class='id sitemap'>sitemap</span>
            <span class='id push_to_url_queue'>push_to_url_queue</span><span class='lparen'>(</span> <span class='id url_sanitize'>url_sanitize</span><span class='lparen'>(</span> <span class='id response'>response</span><span class='period'>.</span><span class='id effective_url'>effective_url</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
        <span class='rbrace'>}</span>
    <span class='kw'>end</span>

    <span class='id audit_queue'>audit_queue</span>

    <span class='id exception_jail'>exception_jail</span> <span class='lbrace'>{</span>
        <span class='kw'>if</span> <span class='op'>!</span><span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Auditor</span><span class='period'>.</span><span class='id timeout_audit_blocks'>timeout_audit_blocks</span><span class='period'>.</span><span class='id empty?'>empty?</span>
            <span class='id print_line'>print_line</span>
            <span class='id print_status'>print_status</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Running timing attacks.</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
            <span class='id print_info'>print_info</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>---------------------------------------</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
            <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Auditor</span><span class='period'>.</span><span class='id on_timing_attacks'>on_timing_attacks</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id res'>res</span><span class='comma'>,</span> <span class='id elem'>elem</span><span class='op'>|</span>
                <span class='ivar'>@current_url</span> <span class='op'>=</span> <span class='id elem'>elem</span><span class='period'>.</span><span class='id action'>action</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id elem'>elem</span><span class='period'>.</span><span class='id action'>action</span><span class='period'>.</span><span class='id empty?'>empty?</span>
            <span class='rbrace'>}</span>
            <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Auditor</span><span class='period'>.</span><span class='id timeout_audit_run'>timeout_audit_run</span>
        <span class='kw'>end</span>

        <span class='id audit_queue'>audit_queue</span>
    <span class='rbrace'>}</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit_page_queue-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>audit_page_queue</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Audits the page queue</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


485
486
487
488
489
490
491
492
493</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 485</span>

<span class='kw'>def</span> <span class='id audit_page_queue'>audit_page_queue</span>
    <span class='comment'># this will run until no new elements appear for the given page
</span>    <span class='kw'>while</span><span class='lparen'>(</span> <span class='op'>!</span><span class='ivar'>@page_queue</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='id page'>page</span> <span class='op'>=</span> <span class='ivar'>@page_queue</span><span class='period'>.</span><span class='id pop'>pop</span> <span class='rparen'>)</span>

        <span class='comment'># audit the page
</span>        <span class='id exception_jail'>exception_jail</span><span class='lbrace'>{</span> <span class='id run_mods'>run_mods</span><span class='lparen'>(</span> <span class='id page'>page</span> <span class='rparen'>)</span> <span class='rbrace'>}</span>
        <span class='id harvest_http_responses'>harvest_http_responses</span> <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@opts</span><span class='period'>.</span><span class='id http_harvest_last'>http_harvest_last</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit_queue-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>audit_queue</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Audits the URL and Page queues</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470
471
472
473
474
475
476
477
478
479
480</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 447</span>

<span class='kw'>def</span> <span class='id audit_queue'>audit_queue</span>

    <span class='comment'># goes through the URLs discovered by the spider, repeats the request
</span>    <span class='comment'># and parses the responses into page objects
</span>    <span class='comment'>#
</span>    <span class='comment'># yes...repeating the request is wasteful but we can't store the
</span>    <span class='comment'># responses of the spider to consume them here because there's no way
</span>    <span class='comment'># of knowing how big the site will be.
</span>    <span class='comment'>#
</span>    <span class='kw'>while</span><span class='lparen'>(</span> <span class='op'>!</span><span class='ivar'>@url_queue</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='id url'>url</span> <span class='op'>=</span> <span class='ivar'>@url_queue</span><span class='period'>.</span><span class='id pop'>pop</span> <span class='rparen'>)</span>

        <span class='id http'>http</span><span class='period'>.</span><span class='id get'>get</span><span class='lparen'>(</span> <span class='id url'>url</span><span class='comma'>,</span> <span class='symbol'>:remove_id</span> <span class='op'>=&gt;</span> <span class='kw'>true</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id on_complete'>on_complete</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id res'>res</span><span class='op'>|</span>

            <span class='id page'>page</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Parser</span><span class='op'>::</span><span class='const'>Page</span><span class='period'>.</span><span class='id from_http_response'>from_http_response</span><span class='lparen'>(</span> <span class='id res'>res</span><span class='comma'>,</span> <span class='ivar'>@opts</span> <span class='rparen'>)</span>

            <span class='comment'># audit the page
</span>            <span class='id exception_jail'>exception_jail</span><span class='lbrace'>{</span> <span class='id run_mods'>run_mods</span><span class='lparen'>(</span> <span class='id page'>page</span> <span class='rparen'>)</span> <span class='rbrace'>}</span>

            <span class='comment'># don't let the page queue build up,
</span>            <span class='comment'># consume it as soon as possible because the pages are stored
</span>            <span class='comment'># in the FS and thus take up precious system resources
</span>            <span class='id audit_page_queue'>audit_page_queue</span>
        <span class='rbrace'>}</span>

        <span class='id harvest_http_responses'>harvest_http_responses</span> <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@opts</span><span class='period'>.</span><span class='id http_harvest_last'>http_harvest_last</span>
    <span class='kw'>end</span>

    <span class='id harvest_http_responses'>harvest_http_responses</span> <span class='kw'>if</span><span class='lparen'>(</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id http_harvest_last'>http_harvest_last</span> <span class='rparen'>)</span>

    <span class='id audit_page_queue'>audit_page_queue</span>

    <span class='id harvest_http_responses'>harvest_http_responses</span> <span class='kw'>if</span><span class='lparen'>(</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id http_harvest_last'>http_harvest_last</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit_store-instance_method">
  
    - (<tt><span class='object_link'><a href="AuditStore.html" title="Arachni::AuditStore (class)">AuditStore</a></span></tt>) <strong>audit_store</strong>(fresh = true) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='auditstore-instance_method'>auditstore</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the results of the audit as an <span class='object_link'><a href="AuditStore.html" title="Arachni::AuditStore (class)">AuditStore</a></span> instance</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="AuditStore.html" title="Arachni::AuditStore (class)">AuditStore</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="AuditStore.html" title="Arachni::AuditStore (class)">AuditStore</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 503</span>

<span class='kw'>def</span> <span class='id audit_store'>audit_store</span><span class='lparen'>(</span> <span class='id fresh'>fresh</span> <span class='op'>=</span> <span class='kw'>true</span> <span class='rparen'>)</span>

    <span class='comment'># restore the original redundancy rules and their counters
</span>    <span class='ivar'>@opts</span><span class='period'>.</span><span class='id redundant'>redundant</span> <span class='op'>=</span> <span class='ivar'>@orig_redundant</span>
    <span class='id opts'>opts</span> <span class='op'>=</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id to_h'>to_h</span>
    <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>mods</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@modules</span><span class='period'>.</span><span class='id keys'>keys</span>

    <span class='kw'>if</span><span class='lparen'>(</span> <span class='op'>!</span><span class='id fresh'>fresh</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@store</span> <span class='rparen'>)</span>
        <span class='kw'>return</span> <span class='ivar'>@store</span>
    <span class='kw'>else</span>
        <span class='kw'>return</span> <span class='ivar'>@store</span> <span class='op'>=</span> <span class='const'>AuditStore</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='lbrace'>{</span>
            <span class='symbol'>:version</span>  <span class='op'>=&gt;</span> <span class='id version'>version</span><span class='lparen'>(</span> <span class='rparen'>)</span><span class='comma'>,</span>
            <span class='symbol'>:revision</span> <span class='op'>=&gt;</span> <span class='const'>REVISION</span><span class='comma'>,</span>
            <span class='symbol'>:options</span>  <span class='op'>=&gt;</span> <span class='id opts'>opts</span><span class='comma'>,</span>
            <span class='symbol'>:sitemap</span>  <span class='op'>=&gt;</span> <span class='id audit_store_sitemap'>audit_store_sitemap</span> <span class='op'>||</span> <span class='lbracket'>[</span><span class='rbracket'>]</span><span class='comma'>,</span>
            <span class='symbol'>:issues</span>   <span class='op'>=&gt;</span> <span class='ivar'>@modules</span><span class='period'>.</span><span class='id results'>results</span><span class='lparen'>(</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id deep_clone'>deep_clone</span><span class='comma'>,</span>
            <span class='symbol'>:plugins</span>  <span class='op'>=&gt;</span> <span class='ivar'>@plugin_store</span>
        <span class='rbrace'>}</span><span class='rparen'>)</span>
     <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit_store_sitemap-instance_method">
  
    - (<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></tt>) <strong>audit_store_sitemap</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Special sitemap for the auditstore.</p>

<p>Used only under special circumstances, will usually return the <span class='object_link'><a href="#sitemap-instance_method" title="Arachni::Framework#sitemap (method)">#sitemap</a></span>
but can be overridden by the RPC::Framework.</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


533
534
535</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 533</span>

<span class='kw'>def</span> <span class='id audit_store_sitemap'>audit_store_sitemap</span>
    <span class='ivar'>@override_sitemap</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='ivar'>@override_sitemap</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='op'>?</span> <span class='ivar'>@override_sitemap</span> <span class='op'>:</span> <span class='ivar'>@sitemap</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="clean_up!-instance_method">
  
    - (<tt>True</tt>) <strong>clean_up!</strong>(skip_audit_queue = false) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Cleans up the framework; should be called after running the audit or after
canceling a running scan.</p>

<p>It stops the clock, waits for the plugins to finish up, register their
results and also refreshes the auditstore.</p>

<p>It also runs <span class='object_link'><a href="#audit_queue-instance_method" title="Arachni::Framework#audit_queue (method)">#audit_queue</a></span> in case any new pages have been added by the
plugins.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>skip_audit_queue</span>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>skips running <span class='object_link'><a href="#audit_queue-instance_method" title="Arachni::Framework#audit_queue (method)">#audit_queue</a></span>, set to true if you don't want any delays.</p>
</div>
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>True</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


720
721
722
723
724
725
726
727
728
729
730
731
732
733
734
735
736
737
738
739</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 720</span>

<span class='kw'>def</span> <span class='id clean_up!'>clean_up!</span><span class='lparen'>(</span> <span class='id skip_audit_queue'>skip_audit_queue</span> <span class='op'>=</span> <span class='kw'>false</span> <span class='rparen'>)</span>
    <span class='ivar'>@opts</span><span class='period'>.</span><span class='id finish_datetime'>finish_datetime</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id now'>now</span>
    <span class='ivar'>@opts</span><span class='period'>.</span><span class='id delta_time'>delta_time</span> <span class='op'>=</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id finish_datetime'>finish_datetime</span> <span class='op'>-</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id start_datetime'>start_datetime</span>

    <span class='comment'># make sure this is disabled or it'll break report output
</span>    <span class='cvar'>@@only_positives</span> <span class='op'>=</span> <span class='kw'>false</span>

    <span class='ivar'>@running</span> <span class='op'>=</span> <span class='kw'>false</span>

    <span class='comment'># wait for the plugins to finish
</span>    <span class='ivar'>@plugins</span><span class='period'>.</span><span class='id block!'>block!</span>

    <span class='comment'># a plug-in may have updated the page queue, rock it!
</span>    <span class='id audit_queue'>audit_queue</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id skip_audit_queue'>skip_audit_queue</span>

    <span class='comment'># refresh the audit store
</span>    <span class='id audit_store'>audit_store</span><span class='lparen'>(</span> <span class='kw'>true</span> <span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="http-instance_method">
  
    - (<tt><span class='object_link'><a href="HTTP.html" title="Arachni::HTTP (class)">Arachni::HTTP</a></span></tt>) <strong>http</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>HTTP instance</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="HTTP.html" title="Arachni::HTTP (class)">Arachni::HTTP</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>HTTP instance</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


185
186
187</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 185</span>

<span class='kw'>def</span> <span class='id http'>http</span>
    <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>HTTP</span><span class='period'>.</span><span class='id instance'>instance</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="lsmod-instance_method">
  
    - (<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;Hash&gt;</tt>) <strong>lsmod</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns an array of hashes with information about all available modules</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;Hash&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 570</span>

<span class='kw'>def</span> <span class='id lsmod'>lsmod</span>

    <span class='id mod_info'>mod_info</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@modules</span><span class='period'>.</span><span class='id available'>available</span><span class='lparen'>(</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id name'>name</span><span class='op'>|</span>

        <span class='id path'>path</span> <span class='op'>=</span> <span class='ivar'>@modules</span><span class='period'>.</span><span class='id name_to_path'>name_to_path</span><span class='lparen'>(</span> <span class='id name'>name</span> <span class='rparen'>)</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id lsmod_match?'>lsmod_match?</span><span class='lparen'>(</span> <span class='id path'>path</span> <span class='rparen'>)</span>

        <span class='id info'>info</span> <span class='op'>=</span> <span class='ivar'>@modules</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id info'>info</span><span class='lparen'>(</span> <span class='rparen'>)</span>

        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:mod_name</span><span class='rbracket'>]</span>    <span class='op'>=</span> <span class='id name'>name</span>
        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>        <span class='op'>=</span> <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id strip'>strip</span>
        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:description</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:description</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id strip'>strip</span>

        <span class='kw'>if</span><span class='lparen'>(</span> <span class='op'>!</span><span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:dependencies</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
            <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:dependencies</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
        <span class='kw'>end</span>

        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:author</span><span class='rbracket'>]</span>    <span class='op'>=</span> <span class='lbracket'>[</span><span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:author</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id flatten'>flatten</span><span class='period'>.</span><span class='id map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id a'>a</span><span class='op'>|</span> <span class='id a'>a</span><span class='period'>.</span><span class='id strip'>strip</span> <span class='rbrace'>}</span>
        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:version</span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:version</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id strip'>strip</span>
        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:path</span><span class='rbracket'>]</span>      <span class='op'>=</span> <span class='id path'>path</span><span class='period'>.</span><span class='id strip'>strip</span>

        <span class='id mod_info'>mod_info</span> <span class='op'>&lt;&lt;</span> <span class='id info'>info</span>
    <span class='rbrace'>}</span>

    <span class='comment'># unload all modules
</span>    <span class='ivar'>@modules</span><span class='period'>.</span><span class='id clear'>clear</span><span class='lparen'>(</span> <span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='id mod_info'>mod_info</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="lsplug-instance_method">
  
    - (<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;Hash&gt;</tt>) <strong>lsplug</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns an array of hashes with information about all available reports</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;Hash&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 634</span>

<span class='kw'>def</span> <span class='id lsplug'>lsplug</span>

    <span class='id plug_info'>plug_info</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='ivar'>@plugins</span><span class='period'>.</span><span class='id available'>available</span><span class='lparen'>(</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id plugin'>plugin</span><span class='op'>|</span>

        <span class='id info'>info</span> <span class='op'>=</span> <span class='ivar'>@plugins</span><span class='lbracket'>[</span><span class='id plugin'>plugin</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id info'>info</span>

        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:plug_name</span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='id plugin'>plugin</span>
        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:path</span><span class='rbracket'>]</span>        <span class='op'>=</span> <span class='ivar'>@plugins</span><span class='period'>.</span><span class='id name_to_path'>name_to_path</span><span class='lparen'>(</span> <span class='id plugin'>plugin</span> <span class='rparen'>)</span>
        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:author</span><span class='rbracket'>]</span>    <span class='op'>=</span> <span class='lbracket'>[</span><span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:author</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id flatten'>flatten</span><span class='period'>.</span><span class='id map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id a'>a</span><span class='op'>|</span> <span class='id a'>a</span><span class='period'>.</span><span class='id strip'>strip</span> <span class='rbrace'>}</span>

        <span class='id plug_info'>plug_info</span> <span class='op'>&lt;&lt;</span> <span class='id info'>info</span>
    <span class='rbrace'>}</span>

    <span class='ivar'>@plugins</span><span class='period'>.</span><span class='id clear'>clear</span><span class='lparen'>(</span> <span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='id plug_info'>plug_info</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="lsrep-instance_method">
  
    - (<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;Hash&gt;</tt>) <strong>lsrep</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns an array of hashes with information about all available reports</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Array.html" title="Array (class)">Array</a></span>&lt;Hash&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


609
610
611
612
613
614
615
616
617
618
619
620
621
622
623
624
625
626</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 609</span>

<span class='kw'>def</span> <span class='id lsrep'>lsrep</span>

    <span class='id rep_info'>rep_info</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@reports</span><span class='period'>.</span><span class='id available'>available</span><span class='lparen'>(</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id report'>report</span><span class='op'>|</span>

        <span class='id info'>info</span> <span class='op'>=</span> <span class='ivar'>@reports</span><span class='lbracket'>[</span><span class='id report'>report</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id info'>info</span>

        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:rep_name</span><span class='rbracket'>]</span>    <span class='op'>=</span> <span class='id report'>report</span>
        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:path</span><span class='rbracket'>]</span>        <span class='op'>=</span> <span class='ivar'>@reports</span><span class='period'>.</span><span class='id name_to_path'>name_to_path</span><span class='lparen'>(</span> <span class='id report'>report</span> <span class='rparen'>)</span>
        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:author</span><span class='rbracket'>]</span>    <span class='op'>=</span> <span class='lbracket'>[</span><span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:author</span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id flatten'>flatten</span><span class='period'>.</span><span class='id map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id a'>a</span><span class='op'>|</span> <span class='id a'>a</span><span class='period'>.</span><span class='id strip'>strip</span> <span class='rbrace'>}</span>

        <span class='id rep_info'>rep_info</span> <span class='op'>&lt;&lt;</span> <span class='id info'>info</span>
    <span class='rbrace'>}</span>
    <span class='ivar'>@reports</span><span class='period'>.</span><span class='id clear'>clear</span><span class='lparen'>(</span> <span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='id rep_info'>rep_info</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="pause!-instance_method">
  
    - (<tt>True</tt>) <strong>pause!</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Pauses the framework on a best effort basis, might take a while to take
effect</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>True</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>pauses the framework on a best effort basis, might take a while to take
effect</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


673
674
675
676
677</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 673</span>

<span class='kw'>def</span> <span class='id pause!'>pause!</span>
    <span class='ivar'>@spider</span><span class='period'>.</span><span class='id pause!'>pause!</span> <span class='kw'>if</span> <span class='ivar'>@spider</span>
    <span class='ivar'>@paused</span> <span class='op'>&lt;&lt;</span> <span class='id caller'>caller</span>
    <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="paused?-instance_method">
  
    - (<tt>Bool</tt>) <strong>paused?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>True if the framework is paused or in the process of</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>true if the framework is paused or in the process of</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


665
666
667</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 665</span>

<span class='kw'>def</span> <span class='id paused?'>paused?</span>
    <span class='op'>!</span><span class='ivar'>@paused</span><span class='period'>.</span><span class='id empty?'>empty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="plugin_store-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>plugin_store</strong>(plugin, obj) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Adds an object to the plugin store.</p>

<p>Should only be called once, if an entry for a plugin already exists it will
just return.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>plugin</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>plugin/owner name</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>obj</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>object to store</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


546
547
548
549
550
551
552
553
554
555
556
557
558
559
560
561
562</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 546</span>

<span class='kw'>def</span> <span class='id plugin_store'>plugin_store</span><span class='lparen'>(</span> <span class='id plugin'>plugin</span><span class='comma'>,</span> <span class='id obj'>obj</span> <span class='rparen'>)</span>
    <span class='id name'>name</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span>
    <span class='ivar'>@plugins</span><span class='period'>.</span><span class='id each_pair'>each_pair</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id k'>k</span><span class='comma'>,</span> <span class='id v'>v</span><span class='op'>|</span>

        <span class='kw'>if</span> <span class='id plugin'>plugin</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id name'>name</span> <span class='op'>==</span> <span class='id v'>v</span><span class='period'>.</span><span class='id name'>name</span>
            <span class='id name'>name</span> <span class='op'>=</span> <span class='id k'>k</span>
            <span class='kw'>break</span>
        <span class='kw'>end</span>
    <span class='rbrace'>}</span>

    <span class='kw'>return</span> <span class='kw'>if</span> <span class='ivar'>@plugin_store</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span>

    <span class='ivar'>@plugin_store</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span>
        <span class='symbol'>:results</span> <span class='op'>=&gt;</span> <span class='id obj'>obj</span>
    <span class='rbrace'>}</span><span class='period'>.</span><span class='id merge'>merge</span><span class='lparen'>(</span> <span class='id plugin'>plugin</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id info'>info</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="prepare-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>prepare</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Prepares the framework for the audit.</p>

<p>Sets the status to 'running', starts the clock and runs the plugins.</p>

<p>Must be called just before calling <span class='object_link'><a href="#audit-instance_method" title="Arachni::Framework#audit (method)">#audit</a></span>.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


196
197
198
199
200
201
202</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 196</span>

<span class='kw'>def</span> <span class='id prepare'>prepare</span>
    <span class='ivar'>@running</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='ivar'>@opts</span><span class='period'>.</span><span class='id start_datetime'>start_datetime</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id now'>now</span>

    <span class='comment'># run all plugins
</span>    <span class='ivar'>@plugins</span><span class='period'>.</span><span class='id run'>run</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="push_to_page_queue-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>push_to_page_queue</strong>(page) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Pushes a page to the page audit queue and updates <span class='object_link'><a href="#page_queue_total_size-instance_method" title="Arachni::Framework#page_queue_total_size (method)">#page_queue_total_size</a></span></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


384
385
386
387</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 384</span>

<span class='kw'>def</span> <span class='id push_to_page_queue'>push_to_page_queue</span><span class='lparen'>(</span> <span class='id page'>page</span> <span class='rparen'>)</span>
    <span class='ivar'>@page_queue</span> <span class='op'>&lt;&lt;</span> <span class='id page'>page</span>
    <span class='ivar'>@page_queue_total_size</span> <span class='op'>+=</span> <span class='int'>1</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="push_to_url_queue-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>push_to_url_queue</strong>(url) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Pushes a URL to the URL audit queue and updates <span class='object_link'><a href="#url_queue_total_size-instance_method" title="Arachni::Framework#url_queue_total_size (method)">#url_queue_total_size</a></span></p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


392
393
394
395</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 392</span>

<span class='kw'>def</span> <span class='id push_to_url_queue'>push_to_url_queue</span><span class='lparen'>(</span> <span class='id url'>url</span> <span class='rparen'>)</span>
    <span class='ivar'>@url_queue</span> <span class='op'>&lt;&lt;</span> <span class='id url'>url</span>
    <span class='ivar'>@url_queue_total_size</span> <span class='op'>+=</span> <span class='int'>1</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="resume!-instance_method">
  
    - (<tt>True</tt>) <strong>resume!</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Resumes the scan/audit</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>True</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>resumes the scan/audit</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


682
683
684
685
686</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 682</span>

<span class='kw'>def</span> <span class='id resume!'>resume!</span>
    <span class='ivar'>@paused</span><span class='period'>.</span><span class='id delete'>delete</span><span class='lparen'>(</span> <span class='id caller'>caller</span> <span class='rparen'>)</span>
    <span class='ivar'>@spider</span><span class='period'>.</span><span class='id resume!'>resume!</span> <span class='kw'>if</span> <span class='ivar'>@spider</span>
    <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="revision-instance_method">
  
    - (<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>) <strong>revision</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the revision of the <span class='object_link'><a href="" title="Arachni::Framework (class)">Arachni::Framework</a></span> (this) class</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


702
703
704</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 702</span>

<span class='kw'>def</span> <span class='id revision'>revision</span>
    <span class='const'>REVISION</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="run-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>run</strong>(&amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Runs the system</p>

<p>It parses the instance options, <span class='object_link'><a href="#prepare-instance_method" title="Arachni::Framework#prepare (method)">#prepare</a></span>, runs the <span class='object_link'><a href="#audit-instance_method" title="Arachni::Framework#audit (method)">#audit</a></span> and
<span class='object_link'><a href="#clean_up%21-instance_method" title="Arachni::Framework#clean_up! (method)">#clean_up!</a></span>.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>&amp;block</span>
      
      
        <span class='type'>(<tt>Block</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>a block to call after the audit has finished but before running the reports</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 212</span>

<span class='kw'>def</span> <span class='id run'>run</span><span class='lparen'>(</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
    <span class='id prepare'>prepare</span>

    <span class='comment'># catch exceptions so that if something breaks down or the user opted to
</span>    <span class='comment'># exit the reports will still run with whatever results
</span>    <span class='comment'># Arachni managed to gather
</span>    <span class='kw'>begin</span>
        <span class='comment'># start the audit
</span>        <span class='id exception_jail'>exception_jail</span><span class='lbrace'>{</span> <span class='id audit'>audit</span><span class='lparen'>(</span> <span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id e'>e</span>
        <span class='comment'># ap e
</span>        <span class='comment'># ap e.backtrace
</span>    <span class='kw'>end</span>

    <span class='id clean_up!'>clean_up!</span>
    <span class='kw'>begin</span>
        <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span> <span class='kw'>if</span> <span class='id block'>block</span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span>
    <span class='kw'>end</span>

    <span class='comment'># run reports
</span>    <span class='kw'>if</span><span class='lparen'>(</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id reports'>reports</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='ivar'>@opts</span><span class='period'>.</span><span class='id reports'>reports</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='rparen'>)</span>
        <span class='id exception_jail'>exception_jail</span><span class='lbrace'>{</span> <span class='ivar'>@reports</span><span class='period'>.</span><span class='id run'>run</span><span class='lparen'>(</span> <span class='id audit_store'>audit_store</span><span class='lparen'>(</span> <span class='rparen'>)</span> <span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="running?-instance_method">
  
    - (<tt>Bool</tt>) <strong>running?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>True if the framework is running</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>true if the framework is running</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


658
659
660</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 658</span>

<span class='kw'>def</span> <span class='id running?'>running?</span>
    <span class='ivar'>@running</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="stats-instance_method">
  
    - (<tt>Hash</tt>) <strong>stats</strong>(refresh_time = false, override_refresh = false) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the following framework stats:</p>
<ul><li>
<p>:requests         -- HTTP request count</p>
</li><li>
<p>:responses        -- HTTP response count</p>
</li><li>
<p>:time_out_count   -- Amount of timed-out requests</p>
</li><li>
<p>:time             -- Amount of running time</p>
</li><li>
<p>:avg              -- Average requests per second</p>
</li><li>
<p>:sitemap_size     -- Number of discovered pages</p>
</li><li>
<p>:auditmap_size    -- Number of audited pages</p>
</li><li>
<p>:progress         -- Progress percentage</p>
</li><li>
<p>:curr_res_time    -- Average response time for the current burst of
requests</p>
</li><li>
<p>:curr_res_cnt     -- Amount of responses for the current burst</p>
</li><li>
<p>:curr_avg         -- Average requests per second for the current burst</p>
</li><li>
<p>:average_res_time -- Average response time</p>
</li><li>
<p>:max_concurrency  -- Current maximum concurrency of HTTP requests</p>
</li><li>
<p>:current_page     -- URL of the currently audited page</p>
</li><li>
<p>:eta              -- Estimated time of arrival i.e. estimated remaining
time</p>
</li></ul>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>refresh_time</span>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>updates the running time of the audit (usefully when you want stats while
paused without messing with the clocks)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>override_refresh</span>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353
354
355
356
357
358
359
360
361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 266</span>

<span class='kw'>def</span> <span class='id stats'>stats</span><span class='lparen'>(</span> <span class='id refresh_time'>refresh_time</span> <span class='op'>=</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='id override_refresh'>override_refresh</span> <span class='op'>=</span> <span class='kw'>false</span> <span class='rparen'>)</span>
    <span class='id req_cnt'>req_cnt</span> <span class='op'>=</span> <span class='id http'>http</span><span class='period'>.</span><span class='id request_count'>request_count</span>
    <span class='id res_cnt'>res_cnt</span> <span class='op'>=</span> <span class='id http'>http</span><span class='period'>.</span><span class='id response_count'>response_count</span>

    <span class='ivar'>@opts</span><span class='period'>.</span><span class='id start_datetime'>start_datetime</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id now'>now</span> <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@opts</span><span class='period'>.</span><span class='id start_datetime'>start_datetime</span>

    <span class='id sitemap_sz'>sitemap_sz</span>  <span class='op'>=</span> <span class='ivar'>@url_queue_total_size</span> <span class='op'>+</span> <span class='ivar'>@page_queue_total_size</span>
    <span class='id auditmap_sz'>auditmap_sz</span> <span class='op'>=</span> <span class='ivar'>@auditmap</span><span class='period'>.</span><span class='id size'>size</span>

    <span class='kw'>if</span><span class='lparen'>(</span> <span class='op'>!</span><span class='id refresh_time'>refresh_time</span> <span class='op'>||</span> <span class='id auditmap_sz'>auditmap_sz</span> <span class='op'>==</span> <span class='id sitemap_sz'>sitemap_sz</span> <span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id override_refresh'>override_refresh</span>
        <span class='ivar'>@opts</span><span class='period'>.</span><span class='id delta_time'>delta_time</span> <span class='op'>||=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id now'>now</span> <span class='op'>-</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id start_datetime'>start_datetime</span>
    <span class='kw'>else</span>
        <span class='ivar'>@opts</span><span class='period'>.</span><span class='id delta_time'>delta_time</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id now'>now</span> <span class='op'>-</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id start_datetime'>start_datetime</span>
    <span class='kw'>end</span>

    <span class='id curr_avg'>curr_avg</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='kw'>if</span> <span class='id http'>http</span><span class='period'>.</span><span class='id curr_res_cnt'>curr_res_cnt</span> <span class='op'>&gt;</span> <span class='int'>0</span> <span class='op'>&amp;&amp;</span> <span class='id http'>http</span><span class='period'>.</span><span class='id curr_res_time'>curr_res_time</span> <span class='op'>&gt;</span> <span class='int'>0</span>
        <span class='id curr_avg'>curr_avg</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='id http'>http</span><span class='period'>.</span><span class='id curr_res_cnt'>curr_res_cnt</span> <span class='op'>/</span> <span class='id http'>http</span><span class='period'>.</span><span class='id curr_res_time'>curr_res_time</span><span class='rparen'>)</span><span class='period'>.</span><span class='id to_i'>to_i</span>
    <span class='kw'>end</span>

    <span class='id avg'>avg</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='kw'>if</span> <span class='id res_cnt'>res_cnt</span> <span class='op'>&gt;</span> <span class='int'>0</span>
        <span class='id avg'>avg</span> <span class='op'>=</span> <span class='lparen'>(</span> <span class='id res_cnt'>res_cnt</span> <span class='op'>/</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id delta_time'>delta_time</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id to_i'>to_i</span>
    <span class='kw'>end</span>

    <span class='comment'># we need to remove URLs that lead to redirects from the sitemap
</span>    <span class='comment'># when calculating the progress %.
</span>    <span class='comment'>#
</span>    <span class='comment'># this is because even though these URLs are valid webapp paths
</span>    <span class='comment'># they are not actual pages and thus can't be audited;
</span>    <span class='comment'># so the sitemap and auditmap will never match and the progress will
</span>    <span class='comment'># never get to 100% which may confuse users.
</span>    <span class='comment'>#
</span>    <span class='kw'>if</span> <span class='ivar'>@spider</span>
        <span class='id redir_sz'>redir_sz</span> <span class='op'>=</span> <span class='ivar'>@spider</span><span class='period'>.</span><span class='id redirects'>redirects</span><span class='period'>.</span><span class='id size'>size</span>
    <span class='kw'>else</span>
        <span class='id redir_sz'>redir_sz</span> <span class='op'>=</span> <span class='int'>0</span>
    <span class='kw'>end</span>

    <span class='comment'>#
</span>    <span class='comment'># There are 2 audit phases:
</span>    <span class='comment'>#  * regular analysis attacks
</span>    <span class='comment'>#  * timing attacks
</span>    <span class='comment'>#
</span>    <span class='comment'># When calculating the progress % we have to take both into account,
</span>    <span class='comment'># however each is calculated using different criteria.
</span>    <span class='comment'>#
</span>    <span class='comment'># Progress of regular attacks is calculated as:
</span>    <span class='comment'>#     amount of audited pages / amount of all discovered pages
</span>    <span class='comment'>#
</span>    <span class='comment'># However, the progress of the timing attacks is calculated as:
</span>    <span class='comment'>#     amount of called timeout blocks / amount of total blocks
</span>    <span class='comment'>#
</span>    <span class='comment'># The timing attack modules are run with the regular ones however
</span>    <span class='comment'># their procedures are piled up into an array of Procs
</span>    <span class='comment'># which are called after the regular attacks.
</span>    <span class='comment'>#
</span>    <span class='comment'># So when we reach the point of needing to include their progress in
</span>    <span class='comment'># the overall progress percentage we'll be working with accurate
</span>    <span class='comment'># data regarding the total blocks, etc.
</span>    <span class='comment'>#
</span>
    <span class='comment'>#
</span>    <span class='comment'># If we have timing attacks then each phase must account for half
</span>    <span class='comment'># of the progress.
</span>    <span class='comment'>#
</span>    <span class='comment'># This is not very granular but it's good enough for now...
</span>    <span class='comment'>#
</span>    <span class='kw'>if</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Auditor</span><span class='period'>.</span><span class='id timeout_loaded_modules'>timeout_loaded_modules</span><span class='period'>.</span><span class='id size'>size</span> <span class='op'>&gt;</span> <span class='int'>0</span>
        <span class='id multi'>multi</span> <span class='op'>=</span> <span class='int'>50</span>
    <span class='kw'>else</span>
        <span class='id multi'>multi</span> <span class='op'>=</span> <span class='int'>100</span>
    <span class='kw'>end</span>

    <span class='id progress'>progress</span> <span class='op'>=</span> <span class='lparen'>(</span><span class='const'>Float</span><span class='lparen'>(</span> <span class='id auditmap_sz'>auditmap_sz</span> <span class='rparen'>)</span> <span class='op'>/</span>
        <span class='lparen'>(</span> <span class='id sitemap_sz'>sitemap_sz</span> <span class='op'>-</span> <span class='id redir_sz'>redir_sz</span> <span class='rparen'>)</span> <span class='rparen'>)</span> <span class='op'>*</span> <span class='id multi'>multi</span>

    <span class='kw'>if</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Auditor</span><span class='period'>.</span><span class='id running_timeout_attacks?'>running_timeout_attacks?</span>

        <span class='id called_blocks'>called_blocks</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Auditor</span><span class='period'>.</span><span class='id timeout_audit_operations_cnt'>timeout_audit_operations_cnt</span> <span class='op'>-</span>
            <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Auditor</span><span class='period'>.</span><span class='id current_timeout_audit_operations_cnt'>current_timeout_audit_operations_cnt</span>

        <span class='id progress'>progress</span> <span class='op'>+=</span> <span class='lparen'>(</span> <span class='const'>Float</span><span class='lparen'>(</span> <span class='id called_blocks'>called_blocks</span> <span class='rparen'>)</span> <span class='op'>/</span>
            <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Auditor</span><span class='period'>.</span><span class='id timeout_audit_operations_cnt'>timeout_audit_operations_cnt</span> <span class='rparen'>)</span> <span class='op'>*</span> <span class='id multi'>multi</span>
    <span class='kw'>end</span>

    <span class='kw'>begin</span>
        <span class='id progress'>progress</span> <span class='op'>=</span> <span class='const'>Float</span><span class='lparen'>(</span> <span class='id sprintf'>sprintf</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>%.2f</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id progress'>progress</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
    <span class='kw'>rescue</span>
        <span class='id progress'>progress</span> <span class='op'>=</span> <span class='float'>0.0</span>
    <span class='kw'>end</span>

    <span class='comment'># sometimes progress may slightly exceed 100%
</span>    <span class='comment'># which can cause a few strange stuff to happen
</span>    <span class='id progress'>progress</span> <span class='op'>=</span> <span class='float'>100.0</span> <span class='kw'>if</span> <span class='id progress'>progress</span> <span class='op'>&gt;</span> <span class='float'>100.0</span>

    <span class='kw'>return</span> <span class='lbrace'>{</span>
        <span class='symbol'>:requests</span>   <span class='op'>=&gt;</span> <span class='id req_cnt'>req_cnt</span><span class='comma'>,</span>
        <span class='symbol'>:responses</span>  <span class='op'>=&gt;</span> <span class='id res_cnt'>res_cnt</span><span class='comma'>,</span>
        <span class='symbol'>:time_out_count</span>  <span class='op'>=&gt;</span> <span class='id http'>http</span><span class='period'>.</span><span class='id time_out_count'>time_out_count</span><span class='comma'>,</span>
        <span class='symbol'>:time</span>       <span class='op'>=&gt;</span> <span class='id audit_store'>audit_store</span><span class='period'>.</span><span class='id delta_time'>delta_time</span><span class='comma'>,</span>
        <span class='symbol'>:avg</span>        <span class='op'>=&gt;</span> <span class='id avg'>avg</span><span class='comma'>,</span>
        <span class='symbol'>:sitemap_size</span>  <span class='op'>=&gt;</span> <span class='ivar'>@sitemap</span><span class='period'>.</span><span class='id size'>size</span><span class='comma'>,</span>
        <span class='symbol'>:auditmap_size</span> <span class='op'>=&gt;</span> <span class='id auditmap_sz'>auditmap_sz</span><span class='comma'>,</span>
        <span class='symbol'>:progress</span>      <span class='op'>=&gt;</span> <span class='id progress'>progress</span><span class='comma'>,</span>
        <span class='symbol'>:curr_res_time</span> <span class='op'>=&gt;</span> <span class='id http'>http</span><span class='period'>.</span><span class='id curr_res_time'>curr_res_time</span><span class='comma'>,</span>
        <span class='symbol'>:curr_res_cnt</span>  <span class='op'>=&gt;</span> <span class='id http'>http</span><span class='period'>.</span><span class='id curr_res_cnt'>curr_res_cnt</span><span class='comma'>,</span>
        <span class='symbol'>:curr_avg</span>      <span class='op'>=&gt;</span> <span class='id curr_avg'>curr_avg</span><span class='comma'>,</span>
        <span class='symbol'>:average_res_time</span> <span class='op'>=&gt;</span> <span class='id http'>http</span><span class='period'>.</span><span class='id average_res_time'>average_res_time</span><span class='comma'>,</span>
        <span class='symbol'>:max_concurrency</span>  <span class='op'>=&gt;</span> <span class='id http'>http</span><span class='period'>.</span><span class='id max_concurrency'>max_concurrency</span><span class='comma'>,</span>
        <span class='symbol'>:current_page</span>     <span class='op'>=&gt;</span> <span class='ivar'>@current_url</span><span class='comma'>,</span>
        <span class='symbol'>:eta</span>           <span class='op'>=&gt;</span> <span class='op'>::</span><span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Mixins</span><span class='op'>::</span><span class='const'>ProgressBar</span><span class='period'>.</span><span class='id eta'>eta</span><span class='lparen'>(</span> <span class='id progress'>progress</span><span class='comma'>,</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id start_datetime'>start_datetime</span> <span class='rparen'>)</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="version-instance_method">
  
    - (<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>) <strong>version</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the version of the framework</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


693
694
695</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/framework.rb', line 693</span>

<span class='kw'>def</span> <span class='id version'>version</span>
    <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>VERSION</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Thu Dec 15 09:15:08 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.3 (ruby-1.9.3).
</div>

  </body>
</html>