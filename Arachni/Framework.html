<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta name="Content-Type" content="text/html; charset=utf-8" />
<title>Class: Arachni::Framework</title>
<link rel="stylesheet" href="../css/style.css" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '..';
  if (relpath != '') relpath += '/';
</script>
<script type="text/javascript" charset="utf-8" src="../js/jquery.js"></script>
<script type="text/javascript" charset="utf-8" src="../js/app.js"></script>

  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../_index.html">Index (F)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../Arachni.html" title="Arachni (module)">Arachni</a></span></span>
     &raquo; 
    <span class="title">Framework</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  <a id="class_list_link" href="#">Class List</a>
  <a id="method_list_link" href="#">Method List</a>
  <a id ="file_list_link" href="#">File List</a>
</div>

      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Arachni::Framework
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Arachni::Framework</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="Module/Utilities.html" title="Arachni::Module::Utilities (module)">Module::Utilities</a></span>, <span class='object_link'><a href="UI/Output.html" title="Arachni::UI::Output (module)">UI::Output</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/framework.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
Arachni::Framework class
</p>
<p>
The Framework class ties together all the components.<br/> It should be
wrapped by a UI class.
</p>
<p>
It&#8217;s the brains of the operation, it bosses the rest of the classes
around.<br/> It runs the audit, loads modules and reports and runs them
according to user options.
</p>
<p>
@author: Tasos &#8220;Zapotek&#8221; Laskos
</p>
<pre class="code">
                                     &lt;tasos.laskos@gmail.com&gt;
                                     &lt;zapotek@segfault.gr&gt;
</pre>
<p>
@version: 0.2
</p>


  </div>
</div>
<div class="tags">
  
</div><div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="UI/RPCD/Framework.html" title="Arachni::UI::RPCD::Framework (class)">UI::RPCD::Framework</a></span></p>
</div>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="VERSION-constant" class="">VERSION =
          <div class="docstring">
  <div class="discussion">
    <p>
the universal system version
</p>


  </div>
</div>
<div class="tags">
  
</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>0.2.1</span><span class='tstring_end'>'</span></span></pre></dd>
      
        <dt id="REVISION-constant" class="">REVISION =
          <div class="docstring">
  <div class="discussion">
    <p>
the version of <b>this</b> class
</p>


  </div>
</div>
<div class="tags">
  
</div>
        </dt>
        <dd><pre class="code"><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>0.2</span><span class='tstring_end'>'</span></span></pre></dd>
      
    </dl>
  


  
  
  
  
  
  
  
  
  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#http-instance_method" title="#http (instance method)">- (Arachni::HTTP) <strong>http</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#modules-instance_method" title="#modules (instance method)">- (Arachni::Module::Manager) <strong>modules</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Module manager.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#opts-instance_method" title="#opts (instance method)">- (Options) <strong>opts</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Instance options.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#page_queue-instance_method" title="#page_queue (instance method)">- (Queue&lt;Arachni::Parser::Page&gt;) <strong>page_queue</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Holds candidate pages to be audited.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#plugins-instance_method" title="#plugins (instance method)">- (Arachni::Plugin::Manager) <strong>plugins</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Plugin manager.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#reports-instance_method" title="#reports (instance method)">- (Arachni::Report::Manager) <strong>reports</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Report manager.
</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#spider-instance_method" title="#spider (instance method)">- (Arachni::Spider) <strong>spider</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Spider.
</p>
</div></span>
  
</li>

    
  </ul>


  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit-instance_method" title="#audit (instance method)">- (Object) <strong>audit</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Audits the site.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit_queue-instance_method" title="#audit_queue (instance method)">- (Object) <strong>audit_queue</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit_store-instance_method" title="#audit_store (instance method)">- (AuditStore) <strong>audit_store</strong>(fresh = false) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the results of the audit as an <span class='object_link'><a href="AuditStore.html" title="Arachni::AuditStore (class)">AuditStore</a></span> instance.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Framework) <strong>initialize</strong>(opts) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Initializes system components.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#lsmod-instance_method" title="#lsmod (instance method)">- (Array&lt;Hash&gt;) <strong>lsmod</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns an array of hashes with information about all available modules.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#lsplug-instance_method" title="#lsplug (instance method)">- (Array&lt;Hash&gt;) <strong>lsplug</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns an array of hashes with information about all available reports.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#lsrep-instance_method" title="#lsrep (instance method)">- (Array&lt;Hash&gt;) <strong>lsrep</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns an array of hashes with information about all available reports.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pause%21-instance_method" title="#pause! (instance method)">- (Object) <strong>pause!</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#paused%3F-instance_method" title="#paused? (instance method)">- (Boolean) <strong>paused?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resume%21-instance_method" title="#resume! (instance method)">- (Object) <strong>resume!</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#revision-instance_method" title="#revision (instance method)">- (String) <strong>revision</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the revision of the <span class='object_link'><a href="" title="Arachni::Framework (class)">Framework</a></span> (this) class.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#run-instance_method" title="#run (instance method)">- (Object) <strong>run</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Runs the system.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#running%3F-instance_method" title="#running? (instance method)">- (Boolean) <strong>running?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stats-instance_method" title="#stats (instance method)">- (Object) <strong>stats</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#version-instance_method" title="#version (instance method)">- (String) <strong>version</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the version of the framework.
</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="Module/Utilities.html" title="Arachni::Module::Utilities (module)">Module::Utilities</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="Module/Utilities.html#exception_jail-instance_method" title="Arachni::Module::Utilities#exception_jail (method)">#exception_jail</a></span>, <span class='object_link'><a href="Module/Utilities.html#get_path-instance_method" title="Arachni::Module::Utilities#get_path (method)">#get_path</a></span>, <span class='object_link'><a href="Module/Utilities.html#read_file-instance_method" title="Arachni::Module::Utilities#read_file (method)">#read_file</a></span>, <span class='object_link'><a href="Module/Utilities.html#seed-instance_method" title="Arachni::Module::Utilities#seed (method)">#seed</a></span></p>

  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="UI/Output.html" title="Arachni::UI::Output (module)">UI::Output</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="UI/Output.html#debug%21-instance_method" title="Arachni::UI::Output#debug! (method)">#debug!</a></span>, <span class='object_link'><a href="UI/Output.html#debug%3F-instance_method" title="Arachni::UI::Output#debug? (method)">#debug?</a></span>, <span class='object_link'><a href="UI/Output.html#flush_buffer-instance_method" title="Arachni::UI::Output#flush_buffer (method)">#flush_buffer</a></span>, <span class='object_link'><a href="UI/Output.html#only_positives%21-instance_method" title="Arachni::UI::Output#only_positives! (method)">#only_positives!</a></span>, <span class='object_link'><a href="UI/Output.html#only_positives%3F-instance_method" title="Arachni::UI::Output#only_positives? (method)">#only_positives?</a></span>, <span class='object_link'><a href="UI/Output.html#print_debug-instance_method" title="Arachni::UI::Output#print_debug (method)">#print_debug</a></span>, <span class='object_link'><a href="UI/Output.html#print_debug_backtrace-instance_method" title="Arachni::UI::Output#print_debug_backtrace (method)">#print_debug_backtrace</a></span>, <span class='object_link'><a href="UI/Output.html#print_debug_pp-instance_method" title="Arachni::UI::Output#print_debug_pp (method)">#print_debug_pp</a></span>, <span class='object_link'><a href="UI/Output.html#print_error-instance_method" title="Arachni::UI::Output#print_error (method)">#print_error</a></span>, <span class='object_link'><a href="UI/Output.html#print_info-instance_method" title="Arachni::UI::Output#print_info (method)">#print_info</a></span>, <span class='object_link'><a href="UI/Output.html#print_line-instance_method" title="Arachni::UI::Output#print_line (method)">#print_line</a></span>, <span class='object_link'><a href="UI/Output.html#print_ok-instance_method" title="Arachni::UI::Output#print_ok (method)">#print_ok</a></span>, <span class='object_link'><a href="UI/Output.html#print_status-instance_method" title="Arachni::UI::Output#print_status (method)">#print_status</a></span>, <span class='object_link'><a href="UI/Output.html#print_verbose-instance_method" title="Arachni::UI::Output#print_verbose (method)">#print_verbose</a></span>, <span class='object_link'><a href="UI/Output.html#verbose%21-instance_method" title="Arachni::UI::Output#verbose! (method)">#verbose!</a></span>, <span class='object_link'><a href="UI/Output.html#verbose%3F-instance_method" title="Arachni::UI::Output#verbose? (method)">#verbose?</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Arachni::Framework (class)">Framework</a></span></tt>) <strong>initialize</strong>(opts) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Initializes system components.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="Options.html" title="Arachni::Options (class)">Options</a></span></tt>)</span>
      
      
        <span class='name'>opts</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 128</span>

<span class='kw'>def</span> <span class='id initialize'>initialize</span><span class='lparen'>(</span> <span class='id opts'>opts</span> <span class='rparen'>)</span>

    <span class='const'>Encoding</span><span class='period'>.</span><span class='id default_external'>default_external</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BINARY</span><span class='tstring_end'>&quot;</span></span>
    <span class='const'>Encoding</span><span class='period'>.</span><span class='id default_internal'>default_internal</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>BINARY</span><span class='tstring_end'>&quot;</span></span>

    <span class='ivar'>@opts</span> <span class='op'>=</span> <span class='id opts'>opts</span>

    <span class='ivar'>@modules</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Manager</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='ivar'>@opts</span> <span class='rparen'>)</span>
    <span class='ivar'>@reports</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Report</span><span class='op'>::</span><span class='const'>Manager</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='ivar'>@opts</span> <span class='rparen'>)</span>
    <span class='ivar'>@plugins</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Plugin</span><span class='op'>::</span><span class='const'>Manager</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='kw'>self</span> <span class='rparen'>)</span>

    <span class='ivar'>@page_queue</span> <span class='op'>=</span> <span class='const'>Queue</span><span class='period'>.</span><span class='id new'>new</span>

    <span class='id prepare_cookie_jar'>prepare_cookie_jar</span><span class='lparen'>(</span> <span class='rparen'>)</span>
    <span class='id prepare_user_agent'>prepare_user_agent</span><span class='lparen'>(</span> <span class='rparen'>)</span>

    <span class='comment'># deep clone the redundancy rules to preserve their counter
</span>    <span class='comment'># for the reports
</span>    <span class='ivar'>@orig_redundant</span> <span class='op'>=</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id redundant'>redundant</span><span class='period'>.</span><span class='id deep_clone'>deep_clone</span>

    <span class='ivar'>@running</span> <span class='op'>=</span> <span class='kw'>false</span>
    <span class='ivar'>@paused</span>  <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <span id="http-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="http-instance_method">
  
    - (<tt><span class='object_link'><a href="HTTP.html" title="Arachni::HTTP (class)">Arachni::HTTP</a></span></tt>) <strong>http</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="HTTP.html" title="Arachni::HTTP (class)">Arachni::HTTP</a></span></tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


108
109
110</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 108</span>

<span class='kw'>def</span> <span class='id http'>http</span>
    <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>HTTP</span><span class='period'>.</span><span class='id instance'>instance</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="modules-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="modules-instance_method">
  
    - (<tt><span class='object_link'><a href="Module/Manager.html" title="Arachni::Module::Manager (class)">Arachni::Module::Manager</a></span></tt>) <strong>modules</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Module manager
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="Module/Manager.html" title="Arachni::Module::Manager (class)">Arachni::Module::Manager</a></span></tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
module manager
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


93
94
95</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 93</span>

<span class='kw'>def</span> <span class='id modules'>modules</span>
  <span class='ivar'>@modules</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="opts-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="opts-instance_method">
  
    - (<tt><span class='object_link'><a href="Options.html" title="Arachni::Options (class)">Options</a></span></tt>) <strong>opts</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Instance options
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="Options.html" title="Arachni::Options (class)">Options</a></span></tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


83
84
85</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 83</span>

<span class='kw'>def</span> <span class='id opts'>opts</span>
  <span class='ivar'>@opts</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="page_queue-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="page_queue-instance_method">
  
    - (<tt>Queue&lt;<span class='object_link'><a href="Parser/Page.html" title="Arachni::Parser::Page (class)">Arachni::Parser::Page</a></span>&gt;</tt>) <strong>page_queue</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Holds candidate pages to be audited.
</p>
<p>
Pages in the queue are pushed in by the trainer, the queue doesn&#8217;t
hold pages returned by the spider.
</p>
<p>
Plug-ins can push their own pages to be audited if they wish to&#8230;
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Queue&lt;<span class='object_link'><a href="Parser/Page.html" title="Arachni::Parser::Page (class)">Arachni::Parser::Page</a></span>&gt;</tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
page queue
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


120
121
122</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 120</span>

<span class='kw'>def</span> <span class='id page_queue'>page_queue</span>
  <span class='ivar'>@page_queue</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="plugins-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="plugins-instance_method">
  
    - (<tt><span class='object_link'><a href="Plugin/Manager.html" title="Arachni::Plugin::Manager (class)">Arachni::Plugin::Manager</a></span></tt>) <strong>plugins</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Plugin manager
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="Plugin/Manager.html" title="Arachni::Plugin::Manager (class)">Arachni::Plugin::Manager</a></span></tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
plugin manager
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


98
99
100</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 98</span>

<span class='kw'>def</span> <span class='id plugins'>plugins</span>
  <span class='ivar'>@plugins</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="reports-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="reports-instance_method">
  
    - (<tt><span class='object_link'><a href="Report/Manager.html" title="Arachni::Report::Manager (class)">Arachni::Report::Manager</a></span></tt>) <strong>reports</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Report manager
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="Report/Manager.html" title="Arachni::Report::Manager (class)">Arachni::Report::Manager</a></span></tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
report manager
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


88
89
90</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 88</span>

<span class='kw'>def</span> <span class='id reports'>reports</span>
  <span class='ivar'>@reports</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="spider-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="spider-instance_method">
  
    - (<tt><span class='object_link'><a href="Spider.html" title="Arachni::Spider (class)">Arachni::Spider</a></span></tt>) <strong>spider</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Spider
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="Spider.html" title="Arachni::Spider (class)">Arachni::Spider</a></span></tt>)</span>
      
      
      
      
        &mdash;
        <div class='inline'><p>
spider
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103
104
105</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 103</span>

<span class='kw'>def</span> <span class='id spider'>spider</span>
  <span class='ivar'>@spider</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="audit-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>audit</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Audits the site.
</p>
<p>
Runs the spider, analyzes each page as it appears and passes it to
(#run_mods} to be audited.
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 223</span>

<span class='kw'>def</span> <span class='id audit'>audit</span>

    <span class='id wait_if_paused'>wait_if_paused</span>

    <span class='ivar'>@spider</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Spider</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='ivar'>@opts</span> <span class='rparen'>)</span>

    <span class='comment'># initiates the crawl
</span>    <span class='ivar'>@sitemap</span> <span class='op'>=</span> <span class='ivar'>@spider</span><span class='period'>.</span><span class='id run'>run</span> <span class='lbrace'>{</span>
        <span class='op'>|</span> <span class='id page'>page</span> <span class='op'>|</span>

        <span class='id exception_jail'>exception_jail</span><span class='lbrace'>{</span>
            <span class='id run_mods'>run_mods</span><span class='lparen'>(</span> <span class='id page'>page</span> <span class='rparen'>)</span>
        <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>

    <span class='kw'>if</span><span class='lparen'>(</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id http_harvest_last'>http_harvest_last</span> <span class='rparen'>)</span>
        <span class='id harvest_http_responses'>harvest_http_responses</span><span class='lparen'>(</span> <span class='rparen'>)</span>
    <span class='kw'>end</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit_queue-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>audit_queue</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 244</span>

<span class='kw'>def</span> <span class='id audit_queue'>audit_queue</span>

    <span class='comment'># this will run until no new elements appear for the given page
</span>    <span class='kw'>while</span><span class='lparen'>(</span> <span class='op'>!</span><span class='ivar'>@page_queue</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='id page'>page</span> <span class='op'>=</span> <span class='ivar'>@page_queue</span><span class='period'>.</span><span class='id pop'>pop</span> <span class='rparen'>)</span>

        <span class='comment'># audit the page
</span>        <span class='id run_mods'>run_mods</span><span class='lparen'>(</span> <span class='id page'>page</span> <span class='rparen'>)</span>

        <span class='comment'># run all the queued HTTP requests and harvest the responses
</span>        <span class='id http'>http</span><span class='period'>.</span><span class='id run'>run</span>

        <span class='comment'># check to see if the page was updated
</span>        <span class='id page'>page</span> <span class='op'>=</span> <span class='id http'>http</span><span class='period'>.</span><span class='id trainer'>trainer</span><span class='period'>.</span><span class='id page'>page</span>
        <span class='comment'># and push it in the queue to be audited as well
</span>        <span class='ivar'>@page_queue</span> <span class='op'>&lt;&lt;</span> <span class='id page'>page</span> <span class='kw'>if</span> <span class='id page'>page</span>

    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit_store-instance_method">
  
    - (<tt><span class='object_link'><a href="AuditStore.html" title="Arachni::AuditStore (class)">AuditStore</a></span></tt>) <strong>audit_store</strong>(fresh = false) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the results of the audit as an <span class='object_link'><a href="AuditStore.html" title="Arachni::AuditStore (class)">AuditStore</a></span> instance
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="AuditStore.html" title="Arachni::AuditStore (class)">AuditStore</a></span></tt>)</span>
      
      
      
      
    </li>
  
</ul>

  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="AuditStore.html" title="Arachni::AuditStore (class)">AuditStore</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286
287
288
289</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 271</span>

<span class='kw'>def</span> <span class='id audit_store'>audit_store</span><span class='lparen'>(</span> <span class='id fresh'>fresh</span> <span class='op'>=</span> <span class='kw'>false</span> <span class='rparen'>)</span>

    <span class='comment'># restore the original redundacy rules and their counters
</span>    <span class='ivar'>@opts</span><span class='period'>.</span><span class='id redundant'>redundant</span> <span class='op'>=</span> <span class='ivar'>@orig_redundant</span>
    <span class='id opts'>opts</span> <span class='op'>=</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id to_h'>to_h</span>
    <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>mods</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='ivar'>@modules</span><span class='period'>.</span><span class='id keys'>keys</span>

    <span class='kw'>if</span><span class='lparen'>(</span> <span class='op'>!</span><span class='id fresh'>fresh</span> <span class='op'>&amp;&amp;</span> <span class='ivar'>@store</span> <span class='rparen'>)</span>
        <span class='kw'>return</span> <span class='ivar'>@store</span>
    <span class='kw'>else</span>
        <span class='kw'>return</span> <span class='ivar'>@store</span> <span class='op'>=</span> <span class='const'>AuditStore</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='lbrace'>{</span>
            <span class='symbol'>:version</span>  <span class='op'>=&gt;</span> <span class='const'>VERSION</span><span class='comma'>,</span>
            <span class='symbol'>:revision</span> <span class='op'>=&gt;</span> <span class='const'>REVISION</span><span class='comma'>,</span>
            <span class='symbol'>:options</span>  <span class='op'>=&gt;</span> <span class='id opts'>opts</span><span class='comma'>,</span>
            <span class='symbol'>:sitemap</span>  <span class='op'>=&gt;</span> <span class='ivar'>@sitemap</span> <span class='op'>?</span> <span class='ivar'>@sitemap</span><span class='period'>.</span><span class='id sort'>sort</span> <span class='op'>:</span> <span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>N/A</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
            <span class='symbol'>:vulns</span>    <span class='op'>=&gt;</span> <span class='ivar'>@modules</span><span class='period'>.</span><span class='id results'>results</span><span class='lparen'>(</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id deep_clone'>deep_clone</span>
        <span class='rbrace'>}</span> <span class='rparen'>)</span>
     <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="lsmod-instance_method">
  
    - (<tt>Array&lt;Hash&gt;</tt>) <strong>lsmod</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns an array of hashes with information about all available modules
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Array&lt;Hash&gt;</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324
325
326
327
328
329</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 298</span>

<span class='kw'>def</span> <span class='id lsmod'>lsmod</span>

    <span class='id mod_info'>mod_info</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@modules</span><span class='period'>.</span><span class='id available'>available</span><span class='lparen'>(</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id name'>name</span><span class='op'>|</span>

        <span class='id path'>path</span> <span class='op'>=</span> <span class='ivar'>@modules</span><span class='period'>.</span><span class='id name_to_path'>name_to_path</span><span class='lparen'>(</span> <span class='id name'>name</span> <span class='rparen'>)</span>
        <span class='kw'>next</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id lsmod_match?'>lsmod_match?</span><span class='lparen'>(</span> <span class='id path'>path</span> <span class='rparen'>)</span>

        <span class='id info'>info</span> <span class='op'>=</span> <span class='ivar'>@modules</span><span class='lbracket'>[</span><span class='id name'>name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id info'>info</span><span class='lparen'>(</span> <span class='rparen'>)</span>

        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:mod_name</span><span class='rbracket'>]</span>    <span class='op'>=</span> <span class='id name'>name</span>
        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>        <span class='op'>=</span> <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id strip'>strip</span>
        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:description</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:description</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id strip'>strip</span>

        <span class='kw'>if</span><span class='lparen'>(</span> <span class='op'>!</span><span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:dependencies</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
            <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:dependencies</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
        <span class='kw'>end</span>

        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:author</span><span class='rbracket'>]</span>    <span class='op'>=</span> <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:author</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id strip'>strip</span>
        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:version</span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:version</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id strip'>strip</span>
        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:path</span><span class='rbracket'>]</span>      <span class='op'>=</span> <span class='id path'>path</span><span class='period'>.</span><span class='id strip'>strip</span>

        <span class='id mod_info'>mod_info</span> <span class='op'>&lt;&lt;</span> <span class='id info'>info</span>
    <span class='rbrace'>}</span>

    <span class='comment'># unload all modules
</span>    <span class='ivar'>@modules</span><span class='period'>.</span><span class='id clear'>clear</span><span class='lparen'>(</span> <span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='id mod_info'>mod_info</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="lsplug-instance_method">
  
    - (<tt>Array&lt;Hash&gt;</tt>) <strong>lsplug</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns an array of hashes with information about all available reports
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Array&lt;Hash&gt;</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


361
362
363
364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 361</span>

<span class='kw'>def</span> <span class='id lsplug'>lsplug</span>

    <span class='id plug_info'>plug_info</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='ivar'>@plugins</span><span class='period'>.</span><span class='id available'>available</span><span class='lparen'>(</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id plugin'>plugin</span><span class='op'>|</span>

        <span class='id info'>info</span> <span class='op'>=</span> <span class='ivar'>@plugins</span><span class='lbracket'>[</span><span class='id plugin'>plugin</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id info'>info</span>

        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:plug_name</span><span class='rbracket'>]</span>   <span class='op'>=</span> <span class='id plugin'>plugin</span>
        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:path</span><span class='rbracket'>]</span>        <span class='op'>=</span> <span class='ivar'>@plugins</span><span class='period'>.</span><span class='id name_to_path'>name_to_path</span><span class='lparen'>(</span> <span class='id plugin'>plugin</span> <span class='rparen'>)</span>

        <span class='id plug_info'>plug_info</span> <span class='op'>&lt;&lt;</span> <span class='id info'>info</span>
    <span class='rbrace'>}</span>

    <span class='ivar'>@plugins</span><span class='period'>.</span><span class='id clear'>clear</span><span class='lparen'>(</span> <span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='id plug_info'>plug_info</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="lsrep-instance_method">
  
    - (<tt>Array&lt;Hash&gt;</tt>) <strong>lsrep</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns an array of hashes with information about all available reports
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Array&lt;Hash&gt;</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


337
338
339
340
341
342
343
344
345
346
347
348
349
350
351
352
353</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 337</span>

<span class='kw'>def</span> <span class='id lsrep'>lsrep</span>

    <span class='id rep_info'>rep_info</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@reports</span><span class='period'>.</span><span class='id available'>available</span><span class='lparen'>(</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id report'>report</span><span class='op'>|</span>

        <span class='id info'>info</span> <span class='op'>=</span> <span class='ivar'>@reports</span><span class='lbracket'>[</span><span class='id report'>report</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id info'>info</span>

        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:rep_name</span><span class='rbracket'>]</span>    <span class='op'>=</span> <span class='id report'>report</span>
        <span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:path</span><span class='rbracket'>]</span>        <span class='op'>=</span> <span class='ivar'>@reports</span><span class='period'>.</span><span class='id name_to_path'>name_to_path</span><span class='lparen'>(</span> <span class='id report'>report</span> <span class='rparen'>)</span>

        <span class='id rep_info'>rep_info</span> <span class='op'>&lt;&lt;</span> <span class='id info'>info</span>
    <span class='rbrace'>}</span>
    <span class='ivar'>@reports</span><span class='period'>.</span><span class='id clear'>clear</span><span class='lparen'>(</span> <span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='id rep_info'>rep_info</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="pause!-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>pause!</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


389
390
391
392</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 389</span>

<span class='kw'>def</span> <span class='id pause!'>pause!</span>
    <span class='ivar'>@paused</span> <span class='op'>&lt;&lt;</span> <span class='id caller'>caller</span>
    <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="paused?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>paused?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


385
386
387</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 385</span>

<span class='kw'>def</span> <span class='id paused?'>paused?</span>
    <span class='op'>!</span><span class='ivar'>@paused</span><span class='period'>.</span><span class='id empty?'>empty?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="resume!-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>resume!</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


394
395
396
397</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 394</span>

<span class='kw'>def</span> <span class='id resume!'>resume!</span>
    <span class='ivar'>@paused</span><span class='period'>.</span><span class='id delete'>delete</span><span class='lparen'>(</span> <span class='id caller'>caller</span> <span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="revision-instance_method">
  
    - (<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>) <strong>revision</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the revision of the <span class='object_link'><a href="" title="Arachni::Framework (class)">Arachni::Framework</a></span> (this) class
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


413
414
415</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 413</span>

<span class='kw'>def</span> <span class='id revision'>revision</span>
    <span class='const'>REVISION</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="run-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>run</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Runs the system
</p>
<p>
It parses the instanse options and runs the audit
</p>


  </div>
</div>
<div class="tags">
  
</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 162</span>

<span class='kw'>def</span> <span class='id run'>run</span>
    <span class='ivar'>@running</span> <span class='op'>=</span> <span class='kw'>true</span>

    <span class='ivar'>@opts</span><span class='period'>.</span><span class='id start_datetime'>start_datetime</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id now'>now</span>

    <span class='comment'># run all plugins
</span>    <span class='ivar'>@plugins</span><span class='period'>.</span><span class='id run'>run</span>

    <span class='comment'># catch exceptions so that if something breaks down or the user opted to
</span>    <span class='comment'># exit the reports will still run with whatever results
</span>    <span class='comment'># Arachni managed to gather
</span>    <span class='kw'>begin</span>
        <span class='comment'># start the audit
</span>        <span class='id audit'>audit</span><span class='lparen'>(</span> <span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span>

    <span class='kw'>end</span>

    <span class='ivar'>@opts</span><span class='period'>.</span><span class='id finish_datetime'>finish_datetime</span> <span class='op'>=</span> <span class='const'>Time</span><span class='period'>.</span><span class='id now'>now</span>
    <span class='ivar'>@opts</span><span class='period'>.</span><span class='id delta_time'>delta_time</span> <span class='op'>=</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id finish_datetime'>finish_datetime</span> <span class='op'>-</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id start_datetime'>start_datetime</span>

    <span class='comment'># make sure this is disabled or it'll break report output
</span>    <span class='cvar'>@@only_positives</span> <span class='op'>=</span> <span class='kw'>false</span>

    <span class='ivar'>@running</span> <span class='op'>=</span> <span class='kw'>false</span>

    <span class='comment'># wait for the plugins to finish
</span>    <span class='ivar'>@plugins</span><span class='period'>.</span><span class='id block!'>block!</span>

    <span class='comment'># a plug-in may have updated the page queue, rock it!
</span>    <span class='id audit_queue'>audit_queue</span>

    <span class='comment'># refresh the audit store
</span>    <span class='id audit_store'>audit_store</span><span class='lparen'>(</span> <span class='kw'>true</span> <span class='rparen'>)</span>

    <span class='comment'># run reports
</span>    <span class='kw'>if</span><span class='lparen'>(</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id reports'>reports</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='ivar'>@opts</span><span class='period'>.</span><span class='id reports'>reports</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='rparen'>)</span>
        <span class='id exception_jail'>exception_jail</span><span class='lbrace'>{</span> <span class='ivar'>@reports</span><span class='period'>.</span><span class='id run'>run</span><span class='lparen'>(</span> <span class='id audit_store'>audit_store</span><span class='lparen'>(</span> <span class='rparen'>)</span> <span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="running?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>running?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


381
382
383</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 381</span>

<span class='kw'>def</span> <span class='id running?'>running?</span>
    <span class='ivar'>@running</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="stats-instance_method">
  
    - (<tt><span class='object_link'><a href="../Object.html" title="Object (class)">Object</a></span></tt>) <strong>stats</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


205
206
207
208
209
210
211
212
213
214
215</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 205</span>

<span class='kw'>def</span> <span class='id stats'>stats</span><span class='lparen'>(</span> <span class='rparen'>)</span>
    <span class='id req_cnt'>req_cnt</span> <span class='op'>=</span> <span class='id http'>http</span><span class='period'>.</span><span class='id request_count'>request_count</span>
    <span class='id res_cnt'>res_cnt</span> <span class='op'>=</span> <span class='id http'>http</span><span class='period'>.</span><span class='id response_count'>response_count</span>

    <span class='kw'>return</span> <span class='lbrace'>{</span>
        <span class='symbol'>:requests</span>   <span class='op'>=&gt;</span> <span class='id req_cnt'>req_cnt</span><span class='comma'>,</span>
        <span class='symbol'>:responses</span>  <span class='op'>=&gt;</span> <span class='id res_cnt'>res_cnt</span><span class='comma'>,</span>
        <span class='symbol'>:time</span>       <span class='op'>=&gt;</span> <span class='id audit_store'>audit_store</span><span class='period'>.</span><span class='id delta_time'>delta_time</span><span class='comma'>,</span>
        <span class='symbol'>:avg</span>        <span class='op'>=&gt;</span> <span class='lparen'>(</span> <span class='id req_cnt'>req_cnt</span> <span class='op'>/</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id delta_time'>delta_time</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id to_i'>to_i</span><span class='period'>.</span><span class='id to_s'>to_s</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="version-instance_method">
  
    - (<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>) <strong>version</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the version of the framework
</p>


  </div>
</div>
<div class="tags">
  <h3>Returns:</h3>
<ul class="return">
  
    <li>
      
        <span class='type'>(<tt><span class='object_link'><a href="../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


404
405
406</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/framework.rb', line 404</span>

<span class='kw'>def</span> <span class='id version'>version</span>
    <span class='const'>VERSION</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Wed Nov 24 18:44:34 2010 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.6.2 (ruby-1.9.2).
</div>

  </body>
</html>