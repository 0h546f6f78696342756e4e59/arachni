<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Arachni::Element::Auditable
  
    &mdash; Arachni - Web Application Security Scanner Framework
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (A)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../Arachni.html" title="Arachni (module)">Arachni</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Element.html" title="Arachni::Element (module)">Element</a></span></span>
     &raquo; 
    <span class="title">Auditable</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Arachni::Element::Auditable
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Arachni::Element::Auditable</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="../Module/Utilities.html" title="Arachni::Module::Utilities (module)">Module::Utilities</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/arachni/parser/auditable.rb</dd>
  
</dl>
<div class="clear"></div>

<div id="subclasses">
  <h2>Direct Known Subclasses</h2>
  <p class="children"><span class='object_link'><a href="../Parser/Element/Base.html" title="Arachni::Parser::Element::Base (class)">Parser::Element::Base</a></span></p>
</div>
<h2>Defined Under Namespace</h2>
<p class="children">
   
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Auditable/Format.html" title="Arachni::Element::Auditable::Format (module)">Format</a></span>
    
   
    
  
</p>


  
  
  
  
  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#altered-instance_method" title="#altered (instance method)">- (Object) <strong>altered</strong> </a>
    

    
  </span>
  
  
    
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute altered.</p>
</div></span>
  
</li>

    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#opts-instance_method" title="#opts (instance method)">- (Object) <strong>opts</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the value of attribute opts.</p>
</div></span>
  
</li>

    
  </ul>



  
  
  

  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#reset-class_method" title="reset (class method)">+ (Object) <strong>reset</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#restrict_to_elements%21-class_method" title="restrict_to_elements! (class method)">+ (Object) <strong>restrict_to_elements!</strong>(elements) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit-instance_method" title="#audit (instance method)">- (Object) <strong>audit</strong>(injection_str, opts = { }, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Audits self.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit_id-instance_method" title="#audit_id (instance method)">- (String) <strong>audit_id</strong>(injection_str = '', opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns am audit identifier string to be registered using <span class='object_link'><a href="#audited-instance_method" title="Arachni::Element::Auditable#audited (method)">#audited</a></span>.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#auditor-instance_method" title="#auditor (instance method)">- (Object) <strong>auditor</strong>(auditor) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#debug%3F-instance_method" title="#debug? (instance method)">- (Boolean) <strong>debug?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Delegate output related methods to the auditor.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_auditor-instance_method" title="#get_auditor (instance method)">- (Object) <strong>get_auditor</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_status_str-instance_method" title="#get_status_str (instance method)">- (String) <strong>get_status_str</strong>(altered) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns a status string that explaining what's happening.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#http_request-instance_method" title="#http_request (instance method)">- (Object) <strong>http_request</strong>(url, opts) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Callback invoked by <span class='object_link'><a href="#audit-instance_method" title="Arachni::Element::Auditable#audit (method)">#audit</a></span> to submit the
object via Module::HTTP.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#info-instance_method" title="#info (instance method)">- (Object) <strong>info</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>impersonate the auditor to the output methods.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#injection_sets-instance_method" title="#injection_sets (instance method)">- (Array) <strong>injection_sets</strong>(injection_str, opts = { }) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Injects the injecton_str in self's values according to formatting options
and returns an array of Element permutations.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#override_instance_scope%21-instance_method" title="#override_instance_scope! (instance method)">- (Object) <strong>override_instance_scope!</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#override_instance_scope%3F-instance_method" title="#override_instance_scope? (instance method)">- (Boolean) <strong>override_instance_scope?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#print_debug-instance_method" title="#print_debug (instance method)">- (Object) <strong>print_debug</strong>(str = '') </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#print_error-instance_method" title="#print_error (instance method)">- (Object) <strong>print_error</strong>(str = '') </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#print_status-instance_method" title="#print_status (instance method)">- (Object) <strong>print_status</strong>(str = '') </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#skip%3F-instance_method" title="#skip? (instance method)">- (Boolean) <strong>skip?</strong>(elem) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#submit-instance_method" title="#submit (instance method)">- (Object) <strong>submit</strong>(opts = {}) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Submits self using <span class='object_link'><a href="#http_request-instance_method" title="Arachni::Element::Auditable#http_request (method)">#http_request</a></span>.</p>
</div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../Module/Utilities.html" title="Arachni::Module::Utilities (module)">Module::Utilities</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../Module/Utilities.html#exception_jail-instance_method" title="Arachni::Module::Utilities#exception_jail (method)">#exception_jail</a></span>, <span class='object_link'><a href="../Module/Utilities.html#get_path-instance_method" title="Arachni::Module::Utilities#get_path (method)">#get_path</a></span>, <span class='object_link'><a href="../Module/Utilities.html#hash_keys_to_str-instance_method" title="Arachni::Module::Utilities#hash_keys_to_str (method)">#hash_keys_to_str</a></span>, <span class='object_link'><a href="../Module/Utilities.html#normalize_url-instance_method" title="Arachni::Module::Utilities#normalize_url (method)">#normalize_url</a></span>, <span class='object_link'><a href="../Module/Utilities.html#read_file-instance_method" title="Arachni::Module::Utilities#read_file (method)">#read_file</a></span>, <span class='object_link'><a href="../Module/Utilities.html#seed-instance_method" title="Arachni::Module::Utilities#seed (method)">#seed</a></span>, <span class='object_link'><a href="../Module/Utilities.html#uri_decode-instance_method" title="Arachni::Module::Utilities#uri_decode (method)">#uri_decode</a></span>, <span class='object_link'><a href="../Module/Utilities.html#uri_encode-instance_method" title="Arachni::Module::Utilities#uri_encode (method)">#uri_encode</a></span>, <span class='object_link'><a href="../Module/Utilities.html#uri_parse-instance_method" title="Arachni::Module::Utilities#uri_parse (method)">#uri_parse</a></span>, <span class='object_link'><a href="../Module/Utilities.html#uri_parser-instance_method" title="Arachni::Module::Utilities#uri_parser (method)">#uri_parser</a></span>, <span class='object_link'><a href="../Module/Utilities.html#url_sanitize-instance_method" title="Arachni::Module::Utilities#url_sanitize (method)">#url_sanitize</a></span></p>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id="altered=-instance_method"></span>
      <span id="altered-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="altered-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>altered</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute altered</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


17
18
19</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 17</span>

<span class='kw'>def</span> <span class='id identifier rubyid_altered'>altered</span>
  <span class='ivar'>@altered</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      
      <span id=""></span>
      <span id="opts-instance_method"></span>
      <div class="method_details ">
  <p class="signature " id="opts-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>opts</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the value of attribute opts</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


18
19
20</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 18</span>

<span class='kw'>def</span> <span class='id identifier rubyid_opts'>opts</span>
  <span class='ivar'>@opts</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="reset-class_method">
  
    + (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>reset</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


13
14
15</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 13</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_reset'>reset</span>
    <span class='cvar'>@@audited</span> <span class='op'>=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="restrict_to_elements!-class_method">
  
    + (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>restrict_to_elements!</strong>(elements) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


331
332
333
334
335
336
337</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 331</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_restrict_to_elements!'>restrict_to_elements!</span><span class='lparen'>(</span> <span class='id identifier rubyid_elements'>elements</span> <span class='rparen'>)</span>
    <span class='cvar'>@@restrict_to_elements</span> <span class='op'>=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>
    <span class='id identifier rubyid_elements'>elements</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id identifier rubyid_elem'>elem</span><span class='op'>|</span>
        <span class='cvar'>@@restrict_to_elements</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_elem'>elem</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="audit-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>audit</strong>(injection_str, opts = { }, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Audits self</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>injection_str</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the string to be injected</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{ }</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>options as described in Module::Auditor#OPTIONS</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>&amp;block</span>
      
      
        <span class='type'>(<tt>Block</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>block to be passed the:</p>
<ul><li>
<p>HTTP response</p>
</li><li>
<p>name of the input vector</p>
</li><li>
<p>updated opts</p>
</li></ul>

<pre class="code">The block will be called as soon as the
HTTP response is received.</pre>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


128
129
130
131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 128</span>

<span class='kw'>def</span> <span class='id identifier rubyid_audit'>audit</span><span class='lparen'>(</span> <span class='id identifier rubyid_injection_str'>injection_str</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span> <span class='rparen'>)</span>

    <span class='comment'># respect user audit options
</span>    <span class='id identifier rubyid_audit_opt'>audit_opt</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>@audit_</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='rbrace'>}</span><span class='tstring_content'>s</span><span class='tstring_end'>&quot;</span></span>
    <span class='kw'>return</span> <span class='kw'>if</span> <span class='op'>!</span><span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Options</span><span class='period'>.</span><span class='id identifier rubyid_instance'>instance</span><span class='period'>.</span><span class='id identifier rubyid_instance_variable_get'>instance_variable_get</span><span class='lparen'>(</span> <span class='id identifier rubyid_audit_opt'>audit_opt</span> <span class='rparen'>)</span>

    <span class='cvar'>@@audited</span> <span class='op'>||=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id identifier rubyid_new'>new</span>

    <span class='id identifier rubyid_opts'>opts</span>            <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Auditor</span><span class='op'>::</span><span class='const'>OPTIONS</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span> <span class='id identifier rubyid_opts'>opts</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:element</span><span class='rbracket'>]</span>  <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span>

    <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:injected_orig</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_injection_str'>injection_str</span>

    <span class='comment'># if we don't have any auditable elements just return
</span>    <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_auditable'>auditable</span><span class='period'>.</span><span class='id identifier rubyid_empty?'>empty?</span>

    <span class='id identifier rubyid_audit_id'>audit_id</span> <span class='op'>=</span> <span class='id identifier rubyid_audit_id'>audit_id</span><span class='lparen'>(</span> <span class='id identifier rubyid_injection_str'>injection_str</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:redundant</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id identifier rubyid_audited?'>audited?</span><span class='lparen'>(</span> <span class='id identifier rubyid_audit_id'>audit_id</span> <span class='rparen'>)</span>

    <span class='id identifier rubyid_results'>results</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='comment'># iterate through all variation and audit each one
</span>    <span class='id identifier rubyid_injection_sets'>injection_sets</span><span class='lparen'>(</span> <span class='id identifier rubyid_injection_str'>injection_str</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id identifier rubyid_elem'>elem</span><span class='op'>|</span>

        <span class='id identifier rubyid_elem'>elem</span><span class='period'>.</span><span class='id identifier rubyid_auditor'>auditor</span><span class='lparen'>(</span> <span class='id identifier rubyid_get_auditor'>get_auditor</span> <span class='rparen'>)</span>
        <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:altered</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_elem'>elem</span><span class='period'>.</span><span class='id identifier rubyid_altered'>altered</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>

        <span class='kw'>return</span> <span class='kw'>if</span> <span class='id identifier rubyid_skip?'>skip?</span><span class='lparen'>(</span> <span class='id identifier rubyid_elem'>elem</span> <span class='rparen'>)</span>

        <span class='comment'># inform the user about what we're auditing
</span>        <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span> <span class='id identifier rubyid_get_status_str'>get_status_str</span><span class='lparen'>(</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:altered</span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='rparen'>)</span>  <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:silent</span><span class='rbracket'>]</span>

        <span class='comment'># submit the element with the injection values
</span>        <span class='id identifier rubyid_req'>req</span> <span class='op'>=</span> <span class='id identifier rubyid_elem'>elem</span><span class='period'>.</span><span class='id identifier rubyid_submit'>submit</span><span class='lparen'>(</span> <span class='id identifier rubyid_opts'>opts</span> <span class='rparen'>)</span>
        <span class='kw'>return</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_req'>req</span>

        <span class='id identifier rubyid_on_complete'>on_complete</span><span class='lparen'>(</span> <span class='id identifier rubyid_req'>req</span><span class='comma'>,</span> <span class='id identifier rubyid_elem'>elem</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id identifier rubyid_block'>block</span> <span class='rparen'>)</span>
        <span class='id identifier rubyid_req'>req</span><span class='period'>.</span><span class='id identifier rubyid_after_complete'>after_complete</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id identifier rubyid_result'>result</span><span class='op'>|</span>
            <span class='id identifier rubyid_results'>results</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id identifier rubyid_result'>result</span><span class='period'>.</span><span class='id identifier rubyid_flatten'>flatten</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span>
        <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>

    <span class='id identifier rubyid_audited'>audited</span><span class='lparen'>(</span> <span class='id identifier rubyid_audit_id'>audit_id</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit_id-instance_method">
  
    - (<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>) <strong>audit_id</strong>(injection_str = '', opts = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns am audit identifier string to be registered using <span class='object_link'><a href="#audited-instance_method" title="Arachni::Element::Auditable#audited (method)">#audited</a></span>.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>input</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


318
319
320
321
322
323
324
325
326
327
328
329</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 318</span>

<span class='kw'>def</span> <span class='id identifier rubyid_audit_id'>audit_id</span><span class='lparen'>(</span> <span class='id identifier rubyid_injection_str'>injection_str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_vars'>vars</span> <span class='op'>=</span> <span class='id identifier rubyid_auditable'>auditable</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_sort'>sort</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span>

    <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span>
    <span class='id identifier rubyid_str'>str</span> <span class='op'>+=</span> <span class='op'>!</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:no_auditor</span><span class='rbracket'>]</span> <span class='op'>?</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@auditor</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span> <span class='op'>:</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span>

    <span class='id identifier rubyid_str'>str</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='ivar'>@action</span><span class='rbrace'>}</span><span class='tstring_content'>:</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='rbrace'>}</span><span class='tstring_content'>:</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_vars'>vars</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span>
    <span class='id identifier rubyid_str'>str</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_injection_str'>injection_str</span><span class='period'>.</span><span class='id identifier rubyid_to_s'>to_s</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:no_injection_str</span><span class='rbracket'>]</span>
    <span class='id identifier rubyid_str'>str</span> <span class='op'>+=</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>:timeout=</span><span class='embexpr_beg'>#{</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span> <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:no_timeout</span><span class='rbracket'>]</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_str'>str</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="auditor-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>auditor</strong>(auditor) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


48
49
50</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 48</span>

<span class='kw'>def</span> <span class='id identifier rubyid_auditor'>auditor</span><span class='lparen'>(</span> <span class='id identifier rubyid_auditor'>auditor</span> <span class='rparen'>)</span>
    <span class='ivar'>@auditor</span> <span class='op'>=</span> <span class='id identifier rubyid_auditor'>auditor</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="debug?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>debug?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Delegate output related methods to the auditor</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


68
69
70</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 68</span>

<span class='kw'>def</span> <span class='id identifier rubyid_debug?'>debug?</span>
    <span class='ivar'>@auditor</span><span class='period'>.</span><span class='id identifier rubyid_debug?'>debug?</span> <span class='kw'>rescue</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_auditor-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>get_auditor</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


52
53
54</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 52</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_auditor'>get_auditor</span>
    <span class='ivar'>@auditor</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_status_str-instance_method">
  
    - (<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>) <strong>get_status_str</strong>(altered) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns a status string that explaining what's happening.</p>

<p>The string contains the name of the input that is being audited the url and
the type of the input (form, link, cookie...)</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>url</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the url under audit</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>input</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


306
307
308</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 306</span>

<span class='kw'>def</span> <span class='id identifier rubyid_get_status_str'>get_status_str</span><span class='lparen'>(</span> <span class='id identifier rubyid_altered'>altered</span> <span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Auditing </span><span class='embexpr_beg'>#{</span><span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_type'>type</span><span class='rbrace'>}</span><span class='tstring_content'> variable '</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id identifier rubyid_altered'>altered</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>' of </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='ivar'>@action</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="http_request-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>http_request</strong>(url, opts) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Callback invoked by <span class='object_link'><a href="#audit-instance_method" title="Arachni::Element::Auditable#audit (method)">#audit</a></span> to submit the
object via Module::HTTP.</p>

<p>Must be implemented by the extending class.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>url</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>


  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="#submit-instance_method" title="Arachni::Element::Auditable#submit (method)">#submit</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


96
97
98</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 96</span>

<span class='kw'>def</span> <span class='id identifier rubyid_http_request'>http_request</span><span class='lparen'>(</span> <span class='id identifier rubyid_url'>url</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='rparen'>)</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="info-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>info</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>impersonate the auditor to the output methods</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


290
291
292</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 290</span>

<span class='kw'>def</span> <span class='id identifier rubyid_info'>info</span>
    <span class='ivar'>@auditor</span> <span class='op'>?</span> <span class='ivar'>@auditor</span><span class='period'>.</span><span class='id identifier rubyid_class'>class</span><span class='period'>.</span><span class='id identifier rubyid_info'>info</span> <span class='op'>:</span> <span class='lbrace'>{</span> <span class='symbol'>:name</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span> <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="injection_sets-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>) <strong>injection_sets</strong>(injection_str, opts = { }) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Injects the injecton_str in self's values according to formatting options
and returns an array of Element permutations.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>injection_str</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the string to inject</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{ }</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>formatting and permutation options</p>
<ul><li>
<p>:skip_orig =&gt; skip submission with default/original values (for
<span class='object_link'><a href="../Parser/Element/Form.html" title="Arachni::Parser::Element::Form (class)">Parser::Element::Form</a></span> elements)</p>
</li><li>
<p>:format =&gt; <span class='object_link'><a href="Auditable/Format.html" title="Arachni::Element::Auditable::Format (module)">Format</a></span></p>
</li><li>
<p>:param_flip =&gt; flip injection value and input name</p>
</li></ul>
</div>
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278
279
280
281
282
283
284
285
286</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 190</span>

<span class='kw'>def</span> <span class='id identifier rubyid_injection_sets'>injection_sets</span><span class='lparen'>(</span> <span class='id identifier rubyid_injection_str'>injection_str</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='rbrace'>}</span> <span class='rparen'>)</span>

    <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Auditor</span><span class='op'>::</span><span class='const'>OPTIONS</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span> <span class='id identifier rubyid_opts'>opts</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_hash'>hash</span> <span class='op'>=</span> <span class='id identifier rubyid_auditable'>auditable</span><span class='lparen'>(</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>

    <span class='id identifier rubyid_var_combo'>var_combo</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='kw'>if</span><span class='lparen'>(</span> <span class='op'>!</span><span class='id identifier rubyid_hash'>hash</span> <span class='op'>||</span> <span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_size'>size</span> <span class='op'>==</span> <span class='int'>0</span> <span class='rparen'>)</span> <span class='kw'>then</span> <span class='kw'>return</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='kw'>end</span>

    <span class='kw'>if</span><span class='lparen'>(</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Parser</span><span class='op'>::</span><span class='const'>Element</span><span class='op'>::</span><span class='const'>Form</span> <span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:skip_orig</span><span class='rbracket'>]</span> <span class='rparen'>)</span>

        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_audited?'>audited?</span><span class='lparen'>(</span> <span class='id identifier rubyid_audit_id'>audit_id</span><span class='lparen'>(</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Parser</span><span class='op'>::</span><span class='const'>Element</span><span class='op'>::</span><span class='const'>Form</span><span class='op'>::</span><span class='const'>FORM_VALUES_ORIGINAL</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
            <span class='comment'># this is the original hash, in case the default values
</span>            <span class='comment'># are valid and present us with new attack vectors
</span>            <span class='id identifier rubyid_elem'>elem</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
            <span class='id identifier rubyid_elem'>elem</span><span class='period'>.</span><span class='id identifier rubyid_altered'>altered</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Parser</span><span class='op'>::</span><span class='const'>Element</span><span class='op'>::</span><span class='const'>Form</span><span class='op'>::</span><span class='const'>FORM_VALUES_ORIGINAL</span>
            <span class='id identifier rubyid_var_combo'>var_combo</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_elem'>elem</span>
        <span class='kw'>end</span>

        <span class='kw'>if</span> <span class='op'>!</span><span class='id identifier rubyid_audited?'>audited?</span><span class='lparen'>(</span> <span class='id identifier rubyid_audit_id'>audit_id</span><span class='lparen'>(</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Parser</span><span class='op'>::</span><span class='const'>Element</span><span class='op'>::</span><span class='const'>Form</span><span class='op'>::</span><span class='const'>FORM_VALUES_SAMPLE</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
            <span class='id identifier rubyid_duphash'>duphash</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
            <span class='id identifier rubyid_elem'>elem</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
            <span class='id identifier rubyid_elem'>elem</span><span class='period'>.</span><span class='id identifier rubyid_auditable'>auditable</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>KeyFiller</span><span class='period'>.</span><span class='id identifier rubyid_fill'>fill</span><span class='lparen'>(</span> <span class='id identifier rubyid_duphash'>duphash</span> <span class='rparen'>)</span>
            <span class='id identifier rubyid_elem'>elem</span><span class='period'>.</span><span class='id identifier rubyid_altered'>altered</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Parser</span><span class='op'>::</span><span class='const'>Element</span><span class='op'>::</span><span class='const'>Form</span><span class='op'>::</span><span class='const'>FORM_VALUES_SAMPLE</span>
            <span class='id identifier rubyid_var_combo'>var_combo</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_elem'>elem</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>

    <span class='id identifier rubyid_chash'>chash</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
    <span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_keys'>keys</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id identifier rubyid_k'>k</span><span class='op'>|</span>

        <span class='comment'># don't audit parameter flips
</span>        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id identifier rubyid_hash'>hash</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id identifier rubyid_seed'>seed</span>

        <span class='id identifier rubyid_chash'>chash</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>KeyFiller</span><span class='period'>.</span><span class='id identifier rubyid_fill'>fill</span><span class='lparen'>(</span> <span class='id identifier rubyid_chash'>chash</span> <span class='rparen'>)</span>
        <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:format</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>

            <span class='id identifier rubyid_str'>str</span>  <span class='op'>=</span> <span class='id identifier rubyid_format_str'>format_str</span><span class='lparen'>(</span> <span class='id identifier rubyid_injection_str'>injection_str</span><span class='comma'>,</span> <span class='id identifier rubyid_chash'>chash</span><span class='lbracket'>[</span><span class='id identifier rubyid_k'>k</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_format'>format</span> <span class='rparen'>)</span>

            <span class='id identifier rubyid_elem'>elem</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
            <span class='id identifier rubyid_elem'>elem</span><span class='period'>.</span><span class='id identifier rubyid_altered'>altered</span> <span class='op'>=</span> <span class='id identifier rubyid_k'>k</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
            <span class='id identifier rubyid_elem'>elem</span><span class='period'>.</span><span class='id identifier rubyid_auditable'>auditable</span> <span class='op'>=</span> <span class='id identifier rubyid_chash'>chash</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span> <span class='lbrace'>{</span> <span class='id identifier rubyid_k'>k</span> <span class='op'>=&gt;</span> <span class='id identifier rubyid_str'>str</span> <span class='rbrace'>}</span> <span class='rparen'>)</span>
            <span class='id identifier rubyid_var_combo'>var_combo</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_elem'>elem</span>
        <span class='rbrace'>}</span>

    <span class='rbrace'>}</span>

    <span class='kw'>if</span> <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:param_flip</span><span class='rbracket'>]</span> <span class='comment'>#&amp;&amp; !self.is_a?( Arachni::Parser::Element::Cookie )
</span>        <span class='id identifier rubyid_elem'>elem</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>

        <span class='comment'># when under HPG mode element auditing is strictly regulated
</span>        <span class='comment'># and when we flip params we essentially create a new element
</span>        <span class='comment'># which won't be on the whitelist
</span>        <span class='id identifier rubyid_elem'>elem</span><span class='period'>.</span><span class='id identifier rubyid_override_instance_scope!'>override_instance_scope!</span>

        <span class='id identifier rubyid_elem'>elem</span><span class='period'>.</span><span class='id identifier rubyid_altered'>altered</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Parameter flip</span><span class='tstring_end'>'</span></span>
        <span class='id identifier rubyid_elem'>elem</span><span class='period'>.</span><span class='id identifier rubyid_auditable'>auditable</span><span class='lbracket'>[</span><span class='id identifier rubyid_injection_str'>injection_str</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id identifier rubyid_seed'>seed</span>
        <span class='id identifier rubyid_var_combo'>var_combo</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_elem'>elem</span>
    <span class='kw'>end</span>

    <span class='comment'># if there are two password type fields in the form there's a good
</span>    <span class='comment'># chance that it's a 'please retype your password' thing so make sure
</span>    <span class='comment'># that we have a variation which has identical password values
</span>    <span class='kw'>if</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_is_a?'>is_a?</span><span class='lparen'>(</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Parser</span><span class='op'>::</span><span class='const'>Element</span><span class='op'>::</span><span class='const'>Form</span> <span class='rparen'>)</span>
        <span class='id identifier rubyid_chash'>chash</span> <span class='op'>=</span> <span class='id identifier rubyid_hash'>hash</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
        <span class='id identifier rubyid_chash'>chash</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>KeyFiller</span><span class='period'>.</span><span class='id identifier rubyid_fill'>fill</span><span class='lparen'>(</span> <span class='id identifier rubyid_chash'>chash</span> <span class='rparen'>)</span>
        <span class='id identifier rubyid_delem'>delem</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>

        <span class='id identifier rubyid_add'>add</span> <span class='op'>=</span> <span class='kw'>false</span>
        <span class='ivar'>@raw</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>auditable</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id identifier rubyid_input'>input</span><span class='op'>|</span>

            <span class='kw'>if</span> <span class='id identifier rubyid_input'>input</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>type</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>password</span><span class='tstring_end'>'</span></span>
                <span class='id identifier rubyid_delem'>delem</span><span class='period'>.</span><span class='id identifier rubyid_altered'>altered</span> <span class='op'>=</span> <span class='id identifier rubyid_input'>input</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>name</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>

                <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:format</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id identifier rubyid_each'>each</span> <span class='lbrace'>{</span>
                    <span class='op'>|</span><span class='id identifier rubyid_format'>format</span><span class='op'>|</span>
                    <span class='id identifier rubyid_chash'>chash</span><span class='lbracket'>[</span><span class='id identifier rubyid_input'>input</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>name</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span>
                        <span class='id identifier rubyid_format_str'>format_str</span><span class='lparen'>(</span> <span class='id identifier rubyid_injection_str'>injection_str</span><span class='comma'>,</span> <span class='id identifier rubyid_chash'>chash</span><span class='lbracket'>[</span><span class='id identifier rubyid_input'>input</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>name</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id identifier rubyid_format'>format</span> <span class='rparen'>)</span>
                <span class='rbrace'>}</span>

                <span class='id identifier rubyid_add'>add</span> <span class='op'>=</span> <span class='kw'>true</span>
            <span class='kw'>end</span>
        <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='ivar'>@raw</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>auditable</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>

        <span class='kw'>if</span> <span class='id identifier rubyid_add'>add</span>
            <span class='id identifier rubyid_delem'>delem</span><span class='period'>.</span><span class='id identifier rubyid_auditable'>auditable</span> <span class='op'>=</span> <span class='id identifier rubyid_chash'>chash</span>
            <span class='id identifier rubyid_var_combo'>var_combo</span> <span class='op'>&lt;&lt;</span> <span class='id identifier rubyid_delem'>delem</span>
        <span class='kw'>end</span>
    <span class='kw'>end</span>


    <span class='id identifier rubyid_print_debug_injection_set'>print_debug_injection_set</span><span class='lparen'>(</span> <span class='id identifier rubyid_var_combo'>var_combo</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='rparen'>)</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_var_combo'>var_combo</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="override_instance_scope!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>override_instance_scope!</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


56
57
58</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 56</span>

<span class='kw'>def</span> <span class='id identifier rubyid_override_instance_scope!'>override_instance_scope!</span>
    <span class='ivar'>@override_instance_scope</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="override_instance_scope?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>override_instance_scope?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


60
61
62</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 60</span>

<span class='kw'>def</span> <span class='id identifier rubyid_override_instance_scope?'>override_instance_scope?</span>
    <span class='ivar'>@override_instance_scope</span> <span class='op'>||=</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="print_debug-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>print_debug</strong>(str = '') 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


80
81
82</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 80</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_debug'>print_debug</span><span class='lparen'>(</span> <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
    <span class='ivar'>@auditor</span><span class='period'>.</span><span class='id identifier rubyid_print_debug'>print_debug</span><span class='lparen'>(</span> <span class='id identifier rubyid_str'>str</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="print_error-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>print_error</strong>(str = '') 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


72
73
74</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 72</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_error'>print_error</span><span class='lparen'>(</span> <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
    <span class='ivar'>@auditor</span><span class='period'>.</span><span class='id identifier rubyid_print_error'>print_error</span><span class='lparen'>(</span> <span class='id identifier rubyid_str'>str</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="print_status-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>print_status</strong>(str = '') 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


76
77
78</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 76</span>

<span class='kw'>def</span> <span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span> <span class='id identifier rubyid_str'>str</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
    <span class='ivar'>@auditor</span><span class='period'>.</span><span class='id identifier rubyid_print_status'>print_status</span><span class='lparen'>(</span> <span class='id identifier rubyid_str'>str</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="skip?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>skip?</strong>(elem) 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


174
175
176</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 174</span>

<span class='kw'>def</span> <span class='id identifier rubyid_skip?'>skip?</span><span class='lparen'>(</span> <span class='id identifier rubyid_elem'>elem</span> <span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='ivar'>@auditor</span><span class='period'>.</span><span class='id identifier rubyid_skip?'>skip?</span><span class='lparen'>(</span> <span class='id identifier rubyid_elem'>elem</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="submit-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>submit</strong>(opts = {}) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Submits self using <span class='object_link'><a href="#http_request-instance_method" title="Arachni::Element::Auditable#http_request (method)">#http_request</a></span>.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
    </li>
  
</ul>


  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="#http_request-instance_method" title="Arachni::Element::Auditable#http_request (method)">#http_request</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


107
108
109
110
111
112
113
114</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/parser/auditable.rb', line 107</span>

<span class='kw'>def</span> <span class='id identifier rubyid_submit'>submit</span><span class='lparen'>(</span> <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='rparen'>)</span>

    <span class='id identifier rubyid_opts'>opts</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Auditor</span><span class='op'>::</span><span class='const'>OPTIONS</span><span class='period'>.</span><span class='id identifier rubyid_merge'>merge</span><span class='lparen'>(</span> <span class='id identifier rubyid_opts'>opts</span> <span class='rparen'>)</span>
    <span class='id identifier rubyid_opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:params</span><span class='rbracket'>]</span>  <span class='op'>=</span> <span class='ivar'>@auditable</span><span class='period'>.</span><span class='id identifier rubyid_dup'>dup</span>
    <span class='ivar'>@opts</span> <span class='op'>=</span> <span class='id identifier rubyid_opts'>opts</span>

    <span class='kw'>return</span> <span class='id identifier rubyid_http_request'>http_request</span><span class='lparen'>(</span> <span class='ivar'>@action</span><span class='comma'>,</span> <span class='id identifier rubyid_opts'>opts</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Sat Jan  7 08:47:19 2012 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.4 (ruby-1.9.3).
</div>

  </body>
</html>