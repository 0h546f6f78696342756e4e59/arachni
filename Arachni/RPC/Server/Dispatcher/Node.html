<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Arachni::RPC::Server::Dispatcher::Node
  
    &mdash; Arachni - Web Application Security Scanner Framework
  
</title>

  <link rel="stylesheet" href="../../../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../../../..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../../../_index.html">Index (N)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../../../Arachni.html" title="Arachni (module)">Arachni</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../RPC.html" title="Arachni::RPC (module)">RPC</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Server.html" title="Arachni::RPC::Server (class)">Server</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Dispatcher.html" title="Arachni::RPC::Server::Dispatcher (class)">Dispatcher</a></span></span>
     &raquo; 
    <span class="title">Node</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Arachni::RPC::Server::Dispatcher::Node
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Arachni::RPC::Server::Dispatcher::Node</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="../../../UI/Output.html" title="Arachni::UI::Output (module)">UI::Output</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/arachni/rpc/server/node.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Dispatcher node class, helps maintain a list of all available Dispatchers
in the grid and announce itself to neighbouring Dispatchers.</p>

<p>As soon as a new Node is fired up it checks-in with its neighbour and grabs
a list of all available peers.</p>

<p>As soon as it receives the peer list it then announces itself to them.</p>

<p>Upon convergence there will be a grid of Dispatchers each one with its own
copy of all available Dispatcher URLs.</p>

<p>@author: Tasos "Zapotek" Laskos</p>

<pre class="code">&lt;tasos.laskos@gmail.com&gt;
&lt;zapotek@segfault.gr&gt;</pre>

<p>@version: 0.1</p>


  </div>
</div>
<div class="tags">
  

</div>

  
  
  
  


  
  
  

  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_neighbour-instance_method" title="#add_neighbour (instance method)">- (Object) <strong>add_neighbour</strong>(node_url, propagate = false) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Adds a neighbour to the peer list.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#info-instance_method" title="#info (instance method)">- (Hash) <strong>info</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns node specific info:</p>
<ul><li>
<p>Bandwidth Pipe ID</p>
</li><li>
<p>Weight</p>
</li><li>
<p>Nickname</p>
</li><li>
<p>Cost.</p>
</li></ul>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Node) <strong>initialize</strong>(opts, logfile) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Initializes the node by:</p>
<ul><li>
<p>Adding the neighbour (if the user has supplied one) to the peer list</p>
</li><li>
<p>Getting the neighbour's peer list and appending them to its own</p>
</li><li>
<p>Announces itself to the neighbour and instructs it to propagate our URL to
the others.</p>
</li></ul>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#neighbours-instance_method" title="#neighbours (instance method)">- (Array) <strong>neighbours</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns all neighbour/node/peer URLs.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#neighbours_with_info-instance_method" title="#neighbours_with_info (instance method)">- (Object) <strong>neighbours_with_info</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remove_neighbour-instance_method" title="#remove_neighbour (instance method)">- (Object) <strong>remove_neighbour</strong>(node_url) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../../UI/Output.html" title="Arachni::UI::Output (module)">UI::Output</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../../UI/Output.html#buffer-instance_method" title="Arachni::UI::Output#buffer (method)">#buffer</a></span>, <span class='object_link'><a href="../../../UI/Output.html#debug%21-instance_method" title="Arachni::UI::Output#debug! (method)">#debug!</a></span>, <span class='object_link'><a href="../../../UI/Output.html#debug%3F-instance_method" title="Arachni::UI::Output#debug? (method)">#debug?</a></span>, <span class='object_link'><a href="../../../UI/Output.html#flush_buffer-instance_method" title="Arachni::UI::Output#flush_buffer (method)">#flush_buffer</a></span>, <span class='object_link'><a href="../../../UI/Output.html#mute%21-instance_method" title="Arachni::UI::Output#mute! (method)">#mute!</a></span>, <span class='object_link'><a href="../../../UI/Output.html#muted%3F-instance_method" title="Arachni::UI::Output#muted? (method)">#muted?</a></span>, <span class='object_link'><a href="../../../UI/Output.html#only_positives%21-instance_method" title="Arachni::UI::Output#only_positives! (method)">#only_positives!</a></span>, <span class='object_link'><a href="../../../UI/Output.html#only_positives%3F-instance_method" title="Arachni::UI::Output#only_positives? (method)">#only_positives?</a></span>, <span class='object_link'><a href="../../../UI/Output.html#print_debug-instance_method" title="Arachni::UI::Output#print_debug (method)">#print_debug</a></span>, <span class='object_link'><a href="../../../UI/Output.html#print_debug_backtrace-instance_method" title="Arachni::UI::Output#print_debug_backtrace (method)">#print_debug_backtrace</a></span>, <span class='object_link'><a href="../../../UI/Output.html#print_debug_pp-instance_method" title="Arachni::UI::Output#print_debug_pp (method)">#print_debug_pp</a></span>, <span class='object_link'><a href="../../../UI/Output.html#print_error-instance_method" title="Arachni::UI::Output#print_error (method)">#print_error</a></span>, <span class='object_link'><a href="../../../UI/Output.html#print_error_backtrace-instance_method" title="Arachni::UI::Output#print_error_backtrace (method)">#print_error_backtrace</a></span>, <span class='object_link'><a href="../../../UI/Output.html#print_info-instance_method" title="Arachni::UI::Output#print_info (method)">#print_info</a></span>, <span class='object_link'><a href="../../../UI/Output.html#print_line-instance_method" title="Arachni::UI::Output#print_line (method)">#print_line</a></span>, <span class='object_link'><a href="../../../UI/Output.html#print_ok-instance_method" title="Arachni::UI::Output#print_ok (method)">#print_ok</a></span>, <span class='object_link'><a href="../../../UI/Output.html#print_status-instance_method" title="Arachni::UI::Output#print_status (method)">#print_status</a></span>, <span class='object_link'><a href="../../../UI/Output.html#print_verbose-instance_method" title="Arachni::UI::Output#print_verbose (method)">#print_verbose</a></span>, <span class='object_link'><a href="../../../UI/Output.html#reroute_to_file-instance_method" title="Arachni::UI::Output#reroute_to_file (method)">#reroute_to_file</a></span>, <span class='object_link'><a href="../../../UI/Output.html#reroute_to_file%3F-instance_method" title="Arachni::UI::Output#reroute_to_file? (method)">#reroute_to_file?</a></span>, <span class='object_link'><a href="../../../UI/Output.html#uncap_buffer%21-instance_method" title="Arachni::UI::Output#uncap_buffer! (method)">#uncap_buffer!</a></span>, <span class='object_link'><a href="../../../UI/Output.html#unmute%21-instance_method" title="Arachni::UI::Output#unmute! (method)">#unmute!</a></span>, <span class='object_link'><a href="../../../UI/Output.html#verbose%21-instance_method" title="Arachni::UI::Output#verbose! (method)">#verbose!</a></span>, <span class='object_link'><a href="../../../UI/Output.html#verbose%3F-instance_method" title="Arachni::UI::Output#verbose? (method)">#verbose?</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Arachni::RPC::Server::Dispatcher::Node (class)">Node</a></span></tt>) <strong>initialize</strong>(opts, logfile) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Initializes the node by:</p>
<ul><li>
<p>Adding the neighbour (if the user has supplied one) to the peer list</p>
</li><li>
<p>Getting the neighbour's peer list and appending them to its own</p>
</li><li>
<p>Announces itself to the neighbour and instructs it to propagate our URL to
the others</p>
</li></ul>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../Options.html" title="Arachni::Options (class)">Arachni::Options</a></span></tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>logfile</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>were to send the output</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87
88
89
90
91
92
93
94</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/rpc/server/node.rb', line 51</span>

<span class='kw'>def</span> <span class='id initialize'>initialize</span><span class='lparen'>(</span> <span class='id opts'>opts</span><span class='comma'>,</span> <span class='id logfile'>logfile</span> <span class='rparen'>)</span>
    <span class='ivar'>@opts</span> <span class='op'>=</span> <span class='id opts'>opts</span>

    <span class='id reroute_to_file'>reroute_to_file</span><span class='lparen'>(</span> <span class='id logfile'>logfile</span> <span class='rparen'>)</span>

    <span class='id print_status'>print_status</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Initing grid node...</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>

    <span class='ivar'>@dead_nodes</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@neighbours</span> <span class='op'>=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id new'>new</span>
    <span class='ivar'>@nodes_info_cache</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='kw'>if</span> <span class='id neighbour'>neighbour</span> <span class='op'>=</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id neighbour'>neighbour</span>
        <span class='id add_neighbour'>add_neighbour</span><span class='lparen'>(</span> <span class='id neighbour'>neighbour</span> <span class='rparen'>)</span>

        <span class='id peer'>peer</span> <span class='op'>=</span> <span class='id connect_to_peer'>connect_to_peer</span><span class='lparen'>(</span> <span class='id neighbour'>neighbour</span> <span class='rparen'>)</span>
        <span class='id peer'>peer</span><span class='period'>.</span><span class='id node'>node</span><span class='period'>.</span><span class='id neighbours'>neighbours</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id urls'>urls</span><span class='op'>|</span>
            <span class='id urls'>urls</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id url'>url</span><span class='op'>|</span>
                <span class='ivar'>@neighbours</span> <span class='op'>&lt;&lt;</span> <span class='id url'>url</span> <span class='kw'>if</span> <span class='id url'>url</span> <span class='op'>!=</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id datastore'>datastore</span><span class='lbracket'>[</span><span class='symbol'>:dispatcher_url</span><span class='rbracket'>]</span>
            <span class='rbrace'>}</span>
        <span class='rbrace'>}</span>

        <span class='id peer'>peer</span><span class='period'>.</span><span class='id node'>node</span><span class='period'>.</span><span class='id add_neighbour'>add_neighbour</span><span class='lparen'>(</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id datastore'>datastore</span><span class='lbracket'>[</span><span class='symbol'>:dispatcher_url</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='kw'>true</span> <span class='rparen'>)</span><span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id res'>res</span><span class='op'>|</span>

            <span class='kw'>if</span> <span class='id res'>res</span><span class='period'>.</span><span class='id rpc_exception?'>rpc_exception?</span>
                <span class='id print_info'>print_info</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Neighbour seems dead: </span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id neighbour'>neighbour</span> <span class='rparen'>)</span>
                <span class='id remove_neighbour'>remove_neighbour</span><span class='lparen'>(</span> <span class='id neighbour'>neighbour</span> <span class='rparen'>)</span>
            <span class='kw'>end</span>
        <span class='rbrace'>}</span>
    <span class='kw'>end</span>

    <span class='id print_status'>print_status</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Node ready.</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>

    <span class='id log_updated_neighbours'>log_updated_neighbours</span>

    <span class='op'>::</span><span class='const'>EM</span><span class='period'>.</span><span class='id add_periodic_timer'>add_periodic_timer</span><span class='lparen'>(</span> <span class='int'>60</span> <span class='rparen'>)</span> <span class='lbrace'>{</span>
        <span class='op'>::</span><span class='const'>EM</span><span class='period'>.</span><span class='id defer'>defer</span> <span class='lbrace'>{</span>
            <span class='id ping'>ping</span>
            <span class='id check_for_comebacks'>check_for_comebacks</span>
        <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="add_neighbour-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>add_neighbour</strong>(node_url, propagate = false) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Adds a neighbour to the peer list</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>node_url</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>URL of a neighbouring node</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>propagate</span>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>wether or not to announce the new node to the ones in the peer list</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


103
104
105
106
107
108
109
110
111
112
113
114</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/rpc/server/node.rb', line 103</span>

<span class='kw'>def</span> <span class='id add_neighbour'>add_neighbour</span><span class='lparen'>(</span> <span class='id node_url'>node_url</span><span class='comma'>,</span> <span class='id propagate'>propagate</span> <span class='op'>=</span> <span class='kw'>false</span> <span class='rparen'>)</span>
    <span class='comment'># we don't want ourselves in the Set
</span>    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='id node_url'>node_url</span> <span class='op'>==</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id datastore'>datastore</span><span class='lbracket'>[</span><span class='symbol'>:dispatcher_url</span><span class='rbracket'>]</span>

    <span class='id print_status'>print_status</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Adding neighbour: </span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id node_url'>node_url</span>

    <span class='ivar'>@neighbours</span> <span class='op'>&lt;&lt;</span> <span class='id node_url'>node_url</span>
    <span class='id log_updated_neighbours'>log_updated_neighbours</span>
    <span class='id announce'>announce</span><span class='lparen'>(</span> <span class='id node_url'>node_url</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id propagate'>propagate</span>

    <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="info-instance_method">
  
    - (<tt>Hash</tt>) <strong>info</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns node specific info:</p>
<ul><li>
<p>Bandwidth Pipe ID</p>
</li><li>
<p>Weight</p>
</li><li>
<p>Nickname</p>
</li><li>
<p>Cost</p>
</li></ul>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


174
175
176
177
178
179
180
181
182</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/rpc/server/node.rb', line 174</span>

<span class='kw'>def</span> <span class='id info'>info</span>
    <span class='kw'>return</span> <span class='lbrace'>{</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span>        <span class='op'>=&gt;</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id datastore'>datastore</span><span class='lbracket'>[</span><span class='symbol'>:dispatcher_url</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>pipe_id</span><span class='tstring_end'>'</span></span>    <span class='op'>=&gt;</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id pipe_id'>pipe_id</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>weight</span><span class='tstring_end'>'</span></span>     <span class='op'>=&gt;</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id weight'>weight</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>nickname</span><span class='tstring_end'>'</span></span>   <span class='op'>=&gt;</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id nickname'>nickname</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>cost</span><span class='tstring_end'>'</span></span>       <span class='op'>=&gt;</span> <span class='ivar'>@opts</span><span class='period'>.</span><span class='id cost'>cost</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="neighbours-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Array.html" title="Array (class)">Array</a></span></tt>) <strong>neighbours</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns all neighbour/node/peer URLs</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


122
123
124</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/rpc/server/node.rb', line 122</span>

<span class='kw'>def</span> <span class='id neighbours'>neighbours</span>
    <span class='ivar'>@neighbours</span><span class='period'>.</span><span class='id to_a'>to_a</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="neighbours_with_info-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>neighbours_with_info</strong>(&amp;block) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


131
132
133
134
135
136
137
138
139
140
141
142
143
144
145
146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/rpc/server/node.rb', line 131</span>

<span class='kw'>def</span> <span class='id neighbours_with_info'>neighbours_with_info</span><span class='lparen'>(</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
    <span class='id raise'>raise</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>This method requires a block!</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id block_given?'>block_given?</span>

    <span class='ivar'>@neighbours_cmp</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span>
    <span class='kw'>if</span> <span class='ivar'>@nodes_info_cache</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='op'>||</span> <span class='ivar'>@neighbours_cmp</span> <span class='op'>!=</span> <span class='id neighbours'>neighbours</span><span class='period'>.</span><span class='id to_s'>to_s</span>

        <span class='ivar'>@neighbours_cmp</span> <span class='op'>=</span> <span class='id neighbours'>neighbours</span><span class='period'>.</span><span class='id to_s'>to_s</span>

        <span class='op'>::</span><span class='const'>EM</span><span class='op'>::</span><span class='const'>Iterator</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='id neighbours'>neighbours</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id map'>map</span><span class='lparen'>(</span> <span class='id proc'>proc</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id neighbour'>neighbour</span><span class='comma'>,</span> <span class='id iter'>iter</span><span class='op'>|</span>

            <span class='id connect_to_peer'>connect_to_peer</span><span class='lparen'>(</span> <span class='id neighbour'>neighbour</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id node'>node</span><span class='period'>.</span><span class='id info'>info</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id info'>info</span><span class='op'>|</span>

                <span class='kw'>if</span> <span class='id info'>info</span><span class='period'>.</span><span class='id rpc_exception?'>rpc_exception?</span>
                    <span class='id print_info'>print_info</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Neighbour seems dead: </span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id neighbour'>neighbour</span> <span class='rparen'>)</span>
                    <span class='id remove_neighbour'>remove_neighbour</span><span class='lparen'>(</span> <span class='id neighbour'>neighbour</span> <span class='rparen'>)</span>
                    <span class='id log_updated_neighbours'>log_updated_neighbours</span>

                    <span class='id iter'>iter</span><span class='period'>.</span><span class='id return'>return</span><span class='lparen'>(</span> <span class='kw'>nil</span> <span class='rparen'>)</span>
                <span class='kw'>else</span>
                    <span class='id iter'>iter</span><span class='period'>.</span><span class='id return'>return</span><span class='lparen'>(</span> <span class='id info'>info</span> <span class='rparen'>)</span>
                <span class='kw'>end</span>
            <span class='rbrace'>}</span>
        <span class='rbrace'>}</span><span class='comma'>,</span> <span class='id proc'>proc</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id nodes'>nodes</span><span class='op'>|</span>
            <span class='ivar'>@nodes_info_cache</span> <span class='op'>=</span> <span class='id nodes'>nodes</span><span class='period'>.</span><span class='id compact'>compact</span>
            <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='ivar'>@nodes_info_cache</span> <span class='rparen'>)</span>
        <span class='rbrace'>}</span><span class='rparen'>)</span>
    <span class='kw'>else</span>
        <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='ivar'>@nodes_info_cache</span> <span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="remove_neighbour-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>remove_neighbour</strong>(node_url) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


126
127
128
129</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/rpc/server/node.rb', line 126</span>

<span class='kw'>def</span> <span class='id remove_neighbour'>remove_neighbour</span><span class='lparen'>(</span> <span class='id node_url'>node_url</span> <span class='rparen'>)</span>
    <span class='ivar'>@neighbours</span> <span class='op'>-=</span> <span class='lbracket'>[</span><span class='id node_url'>node_url</span><span class='rbracket'>]</span>
    <span class='ivar'>@dead_nodes</span> <span class='op'>&lt;&lt;</span> <span class='id node_url'>node_url</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Tue Dec  6 12:30:04 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.3 (ruby-1.9.3).
</div>

  </body>
</html>