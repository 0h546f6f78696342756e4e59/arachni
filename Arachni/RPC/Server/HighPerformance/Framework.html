<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Class: Arachni::RPC::Server::HighPerformance::Framework
  
    &mdash; Arachni - Web Application Security Scanner Framework
  
</title>

  <link rel="stylesheet" href="../../../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../../../..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../../../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../../../_index.html">Index (F)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../../../Arachni.html" title="Arachni (module)">Arachni</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../../RPC.html" title="Arachni::RPC (module)">RPC</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../../Server.html" title="Arachni::RPC::Server (class)">Server</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../HighPerformance.html" title="Arachni::RPC::Server::HighPerformance (module)">HighPerformance</a></span></span>
     &raquo; 
    <span class="title">Framework</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Class: Arachni::RPC::Server::HighPerformance::Framework
  
  
  
</h1>

<dl class="box">
  
    <dt class="r1">Inherits:</dt>
    <dd class="r1">
      <span class="inheritName"><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></span>
      
        <ul class="fullTree">
          <li><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></li>
          
            <li class="next">Arachni::RPC::Server::HighPerformance::Framework</li>
          
        </ul>
        <a href="#" class="inheritanceTree">show all</a>
      
      </dd>
    
  
  
    
  
    
      <dt class="r2">Includes:</dt>
      <dd class="r2"><span class='object_link'><a href="../../../Module/Utilities.html" title="Arachni::Module::Utilities (module)">Module::Utilities</a></span></dd>
      
    
  
  
  
    <dt class="r1 last">Defined in:</dt>
    <dd class="r1 last">lib/rpc/server/high_performance/framework.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    <p>
Wraps the framework of the local instance and the frameworks of all remote
slaves (when in High Performance Grid mode) into a neat, little, easy to
handle package.
</p>
<p>
@author: Tasos &#8220;Zapotek&#8221; Laskos
</p>
<pre class="code">
                                     &lt;tasos.laskos@gmail.com&gt;
                                     &lt;zapotek@segfault.gr&gt;
</pre>
<p>
@version: 0.1
</p>


  </div>
</div>
<div class="tags">
  

</div>
  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="MAX_CONCURRENCY-constant" class="">MAX_CONCURRENCY =
          
        </dt>
        <dd><pre class="code"><span class='int'>20</span></pre></dd>
      
    </dl>
  


  
  
  
  
  <h2>Instance Attribute Summary <small>(<a href="#" class="summary_toggle">collapse</a>)</small></h2>
  <ul class="summary">
    
      <li class="public ">
  <span class="summary_signature">
    
      <a href="#instances-instance_method" title="#instances (instance method)">- (Object) <strong>instances</strong> </a>
    

    
  </span>
  
  
    <span class="note title readonly">readonly</span>
    
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the value of attribute instances.
</p>
</div></span>
  
</li>

    
  </ul>



  
  
  

  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#auditstore-instance_method" title="#auditstore (instance method)">- (YAML) <strong>auditstore</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the results of the audit as a serialized AuditStore object.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#busy%3F-instance_method" title="#busy? (instance method)">- (Boolean) <strong>busy?</strong>(include_slaves = true, &amp;block) </a>
    

    
      (also: #is_busy)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#clean_up%21-instance_method" title="#clean_up! (instance method)">- (Object) <strong>clean_up!</strong>(&amp;block) </a>
    

    
      (also: #clean_up)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
If the scan needs to be aborted abruptly this method takes care of any
unfinished business (like running plug-ins).
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#connect_to_instance-instance_method" title="#connect_to_instance (instance method)">- (Object) <strong>connect_to_instance</strong>(instance) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Connects to a remote Instance.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#debug%3F-instance_method" title="#debug? (instance method)">- (Boolean) <strong>debug?</strong> </a>
    

    
      (also: #is_debug)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#debug_off-instance_method" title="#debug_off (instance method)">- (Object) <strong>debug_off</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Disables debugging output.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#debug_on-instance_method" title="#debug_on (instance method)">- (Object) <strong>debug_on</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Enables debugging output.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#get_plugin_store-instance_method" title="#get_plugin_store (instance method)">- (Object) <strong>get_plugin_store</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#high_performance%3F-instance_method" title="#high_performance? (instance method)">- (Bool) <strong>high_performance?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns true if running in HPG (High Performance Grid) mode, false
otherwise.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#initialize-instance_method" title="#initialize (instance method)">- (Framework) <strong>initialize</strong>(opts) </a>
    

    
  </span>
  
    <span class="note title constructor">constructor</span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
A new instance of Framework.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#issues-instance_method" title="#issues (instance method)">- (String) <strong>issues</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns a YAML dump of all discovered [Arachni::Issue]s.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#lsmod-instance_method" title="#lsmod (instance method)">- (Object) <strong>lsmod</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#lsplug-instance_method" title="#lsplug (instance method)">- (Object) <strong>lsplug</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#master-instance_method" title="#master (instance method)">- (String) <strong>master</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the master&#8217;s URL.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#modules-instance_method" title="#modules (instance method)">- (Object) <strong>modules</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#opts-instance_method" title="#opts (instance method)">- (Object) <strong>opts</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#output-instance_method" title="#output (instance method)">- (Array) <strong>output</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the merged output of all running instances.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#pause%21-instance_method" title="#pause! (instance method)">- (Object) <strong>pause!</strong> </a>
    

    
      (also: #pause)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#paused%3F-instance_method" title="#paused? (instance method)">- (Boolean) <strong>paused?</strong> </a>
    

    
      (also: #is_paused)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#plugins-instance_method" title="#plugins (instance method)">- (Object) <strong>plugins</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#progress_data-instance_method" title="#progress_data (instance method)">- (Hash) <strong>progress_data</strong>(opts = {}, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns aggregated progress data and helps to limit the amount of calls
required in order to get an accurate depiction of a scan&#8217;s progress
and includes:.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#register_issue-instance_method" title="#register_issue (instance method)">- (Object) <strong>register_issue</strong>(results) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Registers a YAML serialized array holding [Arachni::Issue] objects with the
local instance.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#report-instance_method" title="#report (instance method)">- (YAML) <strong>report</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the results of the audit.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#restrict_to_elements%21-instance_method" title="#restrict_to_elements! (instance method)">- (Object) <strong>restrict_to_elements!</strong>(elements) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#resume%21-instance_method" title="#resume! (instance method)">- (Object) <strong>resume!</strong> </a>
    

    
      (also: #resume)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#revision-instance_method" title="#revision (instance method)">- (Object) <strong>revision</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#run-instance_method" title="#run (instance method)">- (Object) <strong>run</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Starts the audit.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#set_master-instance_method" title="#set_master (instance method)">- (Object) <strong>set_master</strong>(url, token) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Set the URL and authentication token required to connect to our master.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#stats-instance_method" title="#stats (instance method)">- (Hash) <strong>stats</strong>(fresh = true) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Scan statistics.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#status-instance_method" title="#status (instance method)">- (String) <strong>status</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Returns the status of the instance as a string.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#update_page_queue-instance_method" title="#update_page_queue (instance method)">- (Object) <strong>update_page_queue</strong>(pages) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#verbose%3F-instance_method" title="#verbose? (instance method)">- (Boolean) <strong>verbose?</strong> </a>
    

    
      (also: #is_verbose)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#verbose_off-instance_method" title="#verbose_off (instance method)">- (Object) <strong>verbose_off</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Disables debugging output.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#verbose_on-instance_method" title="#verbose_on (instance method)">- (Object) <strong>verbose_on</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'><p>
Enables debugging output.
</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#version-instance_method" title="#version (instance method)">- (Object) <strong>version</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
    </ul>
  


  
  
  
  
  
  
  
  <h3 class="inherited">Methods included from <span class='object_link'><a href="../../../Module/Utilities.html" title="Arachni::Module::Utilities (module)">Module::Utilities</a></span></h3>
  <p class="inherited"><span class='object_link'><a href="../../../Module/Utilities.html#exception_jail-instance_method" title="Arachni::Module::Utilities#exception_jail (method)">#exception_jail</a></span>, <span class='object_link'><a href="../../../Module/Utilities.html#get_path-instance_method" title="Arachni::Module::Utilities#get_path (method)">#get_path</a></span>, <span class='object_link'><a href="../../../Module/Utilities.html#hash_keys_to_str-instance_method" title="Arachni::Module::Utilities#hash_keys_to_str (method)">#hash_keys_to_str</a></span>, <span class='object_link'><a href="../../../Module/Utilities.html#normalize_url-instance_method" title="Arachni::Module::Utilities#normalize_url (method)">#normalize_url</a></span>, <span class='object_link'><a href="../../../Module/Utilities.html#read_file-instance_method" title="Arachni::Module::Utilities#read_file (method)">#read_file</a></span>, <span class='object_link'><a href="../../../Module/Utilities.html#seed-instance_method" title="Arachni::Module::Utilities#seed (method)">#seed</a></span>, <span class='object_link'><a href="../../../Module/Utilities.html#uri_decode-instance_method" title="Arachni::Module::Utilities#uri_decode (method)">#uri_decode</a></span>, <span class='object_link'><a href="../../../Module/Utilities.html#uri_encode-instance_method" title="Arachni::Module::Utilities#uri_encode (method)">#uri_encode</a></span>, <span class='object_link'><a href="../../../Module/Utilities.html#uri_parser-instance_method" title="Arachni::Module::Utilities#uri_parser (method)">#uri_parser</a></span>, <span class='object_link'><a href="../../../Module/Utilities.html#url_sanitize-instance_method" title="Arachni::Module::Utilities#url_sanitize (method)">#url_sanitize</a></span></p>
<div id="constructor_details" class="method_details_list">
  <h2>Constructor Details</h2>
  
    <div class="method_details first">
  <p class="signature first" id="initialize-instance_method">
  
    - (<tt><span class='object_link'><a href="" title="Arachni::RPC::Server::HighPerformance::Framework (class)">Framework</a></span></tt>) <strong>initialize</strong>(opts) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
A new instance of Framework
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 43</span>

<span class='kw'>def</span> <span class='id initialize'>initialize</span><span class='lparen'>(</span> <span class='id opts'>opts</span> <span class='rparen'>)</span>
    <span class='comment'># this is the local framework
</span>    <span class='ivar'>@framework</span> <span class='op'>=</span> <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>RPC</span><span class='op'>::</span><span class='const'>Server</span><span class='op'>::</span><span class='const'>Framework</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='id opts'>opts</span> <span class='rparen'>)</span>

    <span class='ivar'>@opts</span>    <span class='op'>=</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id opts'>opts</span>
    <span class='ivar'>@modules</span> <span class='op'>=</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id modules'>modules</span>
    <span class='ivar'>@plugins</span> <span class='op'>=</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id plugins'>plugins</span>

    <span class='ivar'>@job</span> <span class='op'>=</span> <span class='kw'>nil</span>

    <span class='comment'># holds all running instances
</span>    <span class='ivar'>@instances</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='ivar'>@sitemap</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='ivar'>@crawling_done</span> <span class='op'>=</span> <span class='kw'>nil</span>

    <span class='comment'># if we're a slave this var will hold the URL of our master
</span>    <span class='ivar'>@master_url</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>

  <div id="instance_attr_details" class="attr_details">
    <h2>Instance Attribute Details</h2>
    
      
      <span id=""></span>
      <span id="instances-instance_method"></span>
      <div class="method_details first">
  <p class="signature first" id="instances-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>instances</strong>  <span class="extras">(readonly)</span>
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the value of attribute instances
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


39
40
41</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 39</span>

<span class='kw'>def</span> <span class='id instances'>instances</span>
  <span class='ivar'>@instances</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>


  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="auditstore-instance_method">
  
    - (<tt>YAML</tt>) <strong>auditstore</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the results of the audit as a serialized AuditStore object.
</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>YAML</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
YAML dump of the AuditStore
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


611
612
613
614
615</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 611</span>

<span class='kw'>def</span> <span class='id auditstore'>auditstore</span>
    <span class='id store'>store</span> <span class='op'>=</span>  <span class='ivar'>@framework</span><span class='period'>.</span><span class='id audit_store'>audit_store</span><span class='lparen'>(</span> <span class='kw'>true</span> <span class='rparen'>)</span>
    <span class='id store'>store</span><span class='period'>.</span><span class='id framework'>framework</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>return</span> <span class='id store'>store</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="busy?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>busy?</strong>(include_slaves = true, &amp;block) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='is_busy-instance_method'>is_busy</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="../Framework.html#busy%3F-instance_method" title="Arachni::RPC::Server::Framework#busy? (method)">Framework#busy?</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


66
67
68
69
70
71
72
73
74
75
76
77
78
79
80
81
82
83
84
85
86
87</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 66</span>

<span class='kw'>def</span> <span class='id busy?'>busy?</span><span class='lparen'>(</span> <span class='id include_slaves'>include_slaves</span> <span class='op'>=</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>

    <span class='id busyness'>busyness</span> <span class='op'>=</span> <span class='lbracket'>[</span> <span class='id local_busy?'>local_busy?</span> <span class='rbracket'>]</span>

    <span class='kw'>if</span> <span class='ivar'>@instances</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='op'>||</span> <span class='op'>!</span><span class='id include_slaves'>include_slaves</span>
        <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='id busyness'>busyness</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
        <span class='kw'>return</span>
    <span class='kw'>end</span>

    <span class='op'>::</span><span class='const'>EM</span><span class='op'>::</span><span class='const'>Iterator</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='ivar'>@instances</span><span class='comma'>,</span> <span class='ivar'>@instances</span><span class='period'>.</span><span class='id size'>size</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id map'>map</span><span class='lparen'>(</span> <span class='id proc'>proc</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id instance'>instance</span><span class='comma'>,</span> <span class='id iter'>iter</span><span class='op'>|</span>
        <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='id instance'>instance</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id framework'>framework</span><span class='period'>.</span><span class='id busy?'>busy?</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id res'>res</span><span class='op'>|</span>
            <span class='id iter'>iter</span><span class='period'>.</span><span class='id return'>return</span><span class='lparen'>(</span> <span class='id res'>res</span> <span class='rparen'>)</span>
        <span class='rbrace'>}</span>
    <span class='rbrace'>}</span><span class='comma'>,</span> <span class='id proc'>proc</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id res'>res</span><span class='op'>|</span>
        <span class='id busyness'>busyness</span> <span class='op'>&lt;&lt;</span> <span class='id res'>res</span>
        <span class='id busyness'>busyness</span><span class='period'>.</span><span class='id flatten!'>flatten!</span>
        <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='op'>!</span><span class='id busyness'>busyness</span><span class='period'>.</span><span class='id reject'>reject</span><span class='lbrace'>{</span> <span class='op'>|</span><span class='id is_busy'>is_busy</span><span class='op'>|</span> <span class='op'>!</span><span class='id is_busy'>is_busy</span> <span class='rbrace'>}</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='rparen'>)</span>
    <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="clean_up!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>clean_up!</strong>(&amp;block) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='clean_up-instance_method'>clean_up</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    <p>
If the scan needs to be aborted abruptly this method takes care of any
unfinished business (like running plug-ins).
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


298
299
300
301
302
303
304
305
306
307
308
309
310
311
312
313
314
315
316
317
318
319
320
321
322
323
324</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 298</span>

<span class='kw'>def</span> <span class='id clean_up!'>clean_up!</span><span class='lparen'>(</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id override_sitemap!'>override_sitemap!</span><span class='lparen'>(</span> <span class='ivar'>@sitemap</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id high_performance?'>high_performance?</span>
    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id clean_up!'>clean_up!</span><span class='lparen'>(</span> <span class='kw'>true</span> <span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='ivar'>@instances</span><span class='period'>.</span><span class='id empty?'>empty?</span>
        <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span> <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
        <span class='kw'>return</span>
    <span class='kw'>end</span>

    <span class='op'>::</span><span class='const'>EM</span><span class='op'>::</span><span class='const'>Iterator</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='ivar'>@instances</span><span class='comma'>,</span> <span class='ivar'>@instances</span><span class='period'>.</span><span class='id size'>size</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id map'>map</span><span class='lparen'>(</span> <span class='id proc'>proc</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id instance'>instance</span><span class='comma'>,</span> <span class='id iter'>iter</span><span class='op'>|</span>
        <span class='id instance_conn'>instance_conn</span> <span class='op'>=</span> <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='id instance'>instance</span> <span class='rparen'>)</span>

        <span class='id instance_conn'>instance_conn</span><span class='period'>.</span><span class='id framework'>framework</span><span class='period'>.</span><span class='id clean_up!'>clean_up!</span> <span class='lbrace'>{</span>
            <span class='id instance_conn'>instance_conn</span><span class='period'>.</span><span class='id framework'>framework</span><span class='period'>.</span><span class='id get_plugin_store'>get_plugin_store</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id res'>res</span><span class='op'>|</span>
                <span class='id iter'>iter</span><span class='period'>.</span><span class='id return'>return</span><span class='lparen'>(</span> <span class='id res'>res</span> <span class='rparen'>)</span>
            <span class='rbrace'>}</span>
        <span class='rbrace'>}</span>

    <span class='rbrace'>}</span><span class='comma'>,</span> <span class='id proc'>proc</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id results'>results</span><span class='op'>|</span>
        <span class='id results'>results</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id get_plugin_store'>get_plugin_store</span>
        <span class='id update_plugin_results!'>update_plugin_results!</span><span class='lparen'>(</span> <span class='id results'>results</span> <span class='rparen'>)</span>
        <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span>
    <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="connect_to_instance-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>connect_to_instance</strong>(instance) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Connects to a remote Instance.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>instance</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
the hash must hold the &#8216;url&#8217; and the &#8216;token&#8217;. In
subsequent calls the &#8216;token&#8217; can be omitted.
</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


650
651
652
653
654
655
656
657</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 650</span>

<span class='kw'>def</span> <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='id instance'>instance</span> <span class='rparen'>)</span>
    <span class='ivar'>@tokens</span>  <span class='op'>||=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='comment'># @i_conns ||= {}
</span>
    <span class='ivar'>@tokens</span><span class='lbracket'>[</span><span class='id instance'>instance</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id instance'>instance</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>token</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id instance'>instance</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>token</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
    <span class='comment'># return @i_conns[instance['url']] ||=
</span>        <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>RPC</span><span class='op'>::</span><span class='const'>Client</span><span class='op'>::</span><span class='const'>Instance</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='ivar'>@opts</span><span class='comma'>,</span> <span class='id instance'>instance</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='ivar'>@tokens</span><span class='lbracket'>[</span><span class='id instance'>instance</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="debug?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>debug?</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='is_debug-instance_method'>is_debug</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="../Framework.html#debug%3F-instance_method" title="Arachni::RPC::Server::Framework#debug? (method)">Framework#debug?</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


92
93
94</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 92</span>

<span class='kw'>def</span> <span class='id debug?'>debug?</span>
    <span class='cvar'>@@debug</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="debug_off-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>debug_off</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Disables debugging output
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


694
695
696</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 694</span>

<span class='kw'>def</span> <span class='id debug_off'>debug_off</span>
    <span class='cvar'>@@debug</span> <span class='op'>=</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="debug_on-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>debug_on</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Enables debugging output
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


687
688
689</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 687</span>

<span class='kw'>def</span> <span class='id debug_on'>debug_on</span>
    <span class='cvar'>@@debug</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="get_plugin_store-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>get_plugin_store</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


350
351
352</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 350</span>

<span class='kw'>def</span> <span class='id get_plugin_store'>get_plugin_store</span>
    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id get_plugin_store'>get_plugin_store</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="high_performance?-instance_method">
  
    - (<tt>Bool</tt>) <strong>high_performance?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns true if running in HPG (High Performance Grid) mode, false
otherwise.
</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


139
140
141</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 139</span>

<span class='kw'>def</span> <span class='id high_performance?'>high_performance?</span>
    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id opts'>opts</span><span class='period'>.</span><span class='id grid_mode'>grid_mode</span> <span class='op'>==</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>high_performance</span><span class='tstring_end'>'</span></span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="issues-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>) <strong>issues</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns a YAML dump of all discovered [Arachni::Issue]s.
</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


622
623
624
625
626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 622</span>

<span class='kw'>def</span> <span class='id issues'>issues</span>
    <span class='kw'>begin</span>
        <span class='id data'>data</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

        <span class='ivar'>@framework</span><span class='period'>.</span><span class='id audit_store'>audit_store</span><span class='lparen'>(</span> <span class='kw'>true</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id issues'>issues</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id issue'>issue</span><span class='op'>|</span>

            <span class='id tmp_issue'>tmp_issue</span> <span class='op'>=</span> <span class='id issue'>issue</span><span class='period'>.</span><span class='id deep_clone'>deep_clone</span>
            <span class='id tmp_issue'>tmp_issue</span><span class='period'>.</span><span class='id variations'>variations</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

            <span class='id data'>data</span> <span class='op'>&lt;&lt;</span> <span class='id tmp_issue'>tmp_issue</span>
        <span class='rbrace'>}</span>

        <span class='kw'>return</span> <span class='const'>YAML</span><span class='period'>.</span><span class='id dump'>dump</span><span class='lparen'>(</span> <span class='id data'>data</span> <span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id e'>e</span>
        <span class='comment'># ap e
</span>        <span class='comment'># ap e.backtrace
</span>    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='const'>YAML</span><span class='period'>.</span><span class='id dump'>dump</span><span class='lparen'>(</span> <span class='lbracket'>[</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="lsmod-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>lsmod</strong>(&amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  

  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="../Framework.html#lsmod-instance_method" title="Arachni::RPC::Server::Framework#lsmod (method)">Framework#lsmod</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


283
284
285</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 283</span>

<span class='kw'>def</span> <span class='id lsmod'>lsmod</span><span class='lparen'>(</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
    <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id lsmod'>lsmod</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="lsplug-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>lsplug</strong>(&amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  

  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="../Framework.html#lsplug-instance_method" title="Arachni::RPC::Server::Framework#lsplug (method)">Framework#lsplug</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


106
107
108</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 106</span>

<span class='kw'>def</span> <span class='id lsplug'>lsplug</span><span class='lparen'>(</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
    <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id lsplug'>lsplug</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="master-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>) <strong>master</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the master&#8217;s URL
</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


388
389
390</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 388</span>

<span class='kw'>def</span> <span class='id master'>master</span>
    <span class='ivar'>@master_url</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="modules-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>modules</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


668
669
670</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 668</span>

<span class='kw'>def</span> <span class='id modules'>modules</span>
    <span class='ivar'>@modules</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="opts-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>opts</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


672
673
674</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 672</span>

<span class='kw'>def</span> <span class='id opts'>opts</span>
    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id opts'>opts</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="output-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Array.html" title="Array (class)">Array</a></span></tt>) <strong>output</strong>(&amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the merged output of all running instances.
</p>
<p>
This is going probably to be wildly out of sync and lack A LOT of messages.
</p>
<p>
It&#8217;s here to give the notion of scan progress to the end-user rather
than provide an accurate depiction of the actual progress.
</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


414
415
416
417
418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 414</span>

<span class='kw'>def</span> <span class='id output'>output</span><span class='lparen'>(</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>

    <span class='id buffer'>buffer</span> <span class='op'>=</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id flush_buffer'>flush_buffer</span>

    <span class='kw'>if</span> <span class='ivar'>@instances</span><span class='period'>.</span><span class='id empty?'>empty?</span>
        <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='id buffer'>buffer</span> <span class='rparen'>)</span>
        <span class='kw'>return</span>
    <span class='kw'>end</span>

    <span class='op'>::</span><span class='const'>EM</span><span class='op'>::</span><span class='const'>Iterator</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='ivar'>@instances</span><span class='comma'>,</span> <span class='const'>MAX_CONCURRENCY</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id map'>map</span><span class='lparen'>(</span> <span class='id proc'>proc</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id instance'>instance</span><span class='comma'>,</span> <span class='id iter'>iter</span><span class='op'>|</span>
        <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='id instance'>instance</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id service'>service</span><span class='period'>.</span><span class='id output'>output</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id out'>out</span><span class='op'>|</span>
            <span class='id iter'>iter</span><span class='period'>.</span><span class='id return'>return</span><span class='lparen'>(</span> <span class='id out'>out</span> <span class='rparen'>)</span>
        <span class='rbrace'>}</span>
    <span class='rbrace'>}</span><span class='comma'>,</span> <span class='id proc'>proc</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id out'>out</span><span class='op'>|</span>
        <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='lparen'>(</span><span class='id buffer'>buffer</span> <span class='op'>|</span> <span class='id out'>out</span><span class='rparen'>)</span><span class='period'>.</span><span class='id flatten'>flatten</span> <span class='rparen'>)</span>
    <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="pause!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>pause!</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='pause-instance_method'>pause</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  

  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="../Framework.html#pause%21-instance_method" title="Arachni::RPC::Server::Framework#pause! (method)">Framework#pause!</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


329
330
331
332
333
334
335
336</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 329</span>

<span class='kw'>def</span> <span class='id pause!'>pause!</span>
    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id pause!'>pause!</span>
    <span class='op'>::</span><span class='const'>EM</span><span class='op'>::</span><span class='const'>Iterator</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='ivar'>@instances</span><span class='comma'>,</span> <span class='ivar'>@instances</span><span class='period'>.</span><span class='id size'>size</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id instance'>instance</span><span class='comma'>,</span> <span class='id iter'>iter</span><span class='op'>|</span>
        <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='id instance'>instance</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id framework'>framework</span><span class='period'>.</span><span class='id pause!'>pause!</span><span class='lbrace'>{</span> <span class='id iter'>iter</span><span class='period'>.</span><span class='id next'>next</span> <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>
    <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="paused?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>paused?</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='is_paused-instance_method'>is_paused</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


676
677
678</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 676</span>

<span class='kw'>def</span> <span class='id paused?'>paused?</span>
    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id paused?'>paused?</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="plugins-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>plugins</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


680
681
682</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 680</span>

<span class='kw'>def</span> <span class='id plugins'>plugins</span>
    <span class='ivar'>@plugins</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="progress_data-instance_method">
  
    - (<tt>Hash</tt>) <strong>progress_data</strong>(opts = {}, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns aggregated progress data and helps to limit the amount of calls
required in order to get an accurate depiction of a scan&#8217;s progress
and includes:
</p>
<pre class="code">
 <span class='id o'>o</span> <span class='id output'>output</span> <span class='id messages'>messages</span>
 <span class='id o'>o</span> <span class='id discovered'>discovered</span> <span class='id issues'>issues</span>
 <span class='id o'>o</span> <span class='id overall'>overall</span> <span class='id statistics'>statistics</span>
 <span class='id o'>o</span> <span class='id overall'>overall</span> <span class='id scan'>scan</span> <span class='id status'>status</span>
 <span class='id o'>o</span> <span class='id statistics'>statistics</span> <span class='id of'>of</span> <span class='id all'>all</span> <span class='id instances'>instances</span> <span class='id individually'>individually</span></pre>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


469
470
471
472
473
474
475
476
477
478
479
480
481
482
483
484
485
486
487
488
489
490
491
492
493
494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528
529
530
531
532
533
534
535
536
537
538
539
540
541
542
543
544
545
546
547
548
549
550
551
552
553
554
555
556
557
558</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 469</span>

<span class='kw'>def</span> <span class='id progress_data'>progress_data</span><span class='lparen'>(</span> <span class='id opts'>opts</span><span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>

    <span class='kw'>if</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:messages</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id nil?'>nil?</span>
        <span class='id include_messages'>include_messages</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>else</span>
        <span class='id include_messages'>include_messages</span> <span class='op'>=</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:messages</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:slaves</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id nil?'>nil?</span>
        <span class='id include_slaves'>include_slaves</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>else</span>
        <span class='id include_slaves'>include_slaves</span> <span class='op'>=</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:slaves</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:issues</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id nil?'>nil?</span>
        <span class='id include_issues'>include_issues</span> <span class='op'>=</span> <span class='kw'>true</span>
    <span class='kw'>else</span>
        <span class='id include_issues'>include_issues</span> <span class='op'>=</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:issues</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='id data'>data</span> <span class='op'>=</span> <span class='lbrace'>{</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>stats</span><span class='tstring_end'>'</span></span>     <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>status</span><span class='tstring_end'>'</span></span>    <span class='op'>=&gt;</span> <span class='id status'>status</span><span class='comma'>,</span>
        <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>busy</span><span class='tstring_end'>'</span></span>      <span class='op'>=&gt;</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id busy?'>busy?</span>
    <span class='rbrace'>}</span>

    <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>messages</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>  <span class='op'>=</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id flush_buffer'>flush_buffer</span> <span class='kw'>if</span> <span class='id include_messages'>include_messages</span>
    <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>issues</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>    <span class='op'>=</span> <span class='const'>YAML</span><span class='op'>::</span><span class='id load'>load</span><span class='lparen'>(</span> <span class='id issues'>issues</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id include_issues'>include_issues</span>
    <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>instances</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id include_slaves'>include_slaves</span>

    <span class='id stats'>stats</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='id stat_hash'>stat_hash</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id stats'>stats</span><span class='lparen'>(</span> <span class='kw'>true</span><span class='comma'>,</span> <span class='kw'>true</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id k'>k</span><span class='comma'>,</span> <span class='id v'>v</span><span class='op'>|</span>
        <span class='id stat_hash'>stat_hash</span><span class='lbracket'>[</span><span class='id k'>k</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id v'>v</span>
    <span class='rbrace'>}</span>

    <span class='kw'>if</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id opts'>opts</span><span class='period'>.</span><span class='id datastore'>datastore</span><span class='lbracket'>[</span><span class='symbol'>:dispatcher_url</span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span> <span class='id include_slaves'>include_slaves</span>
        <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>instances</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id self_url'>self_url</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id stat_hash'>stat_hash</span><span class='period'>.</span><span class='id dup'>dup</span>
        <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>instances</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id self_url'>self_url</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id self_url'>self_url</span>
        <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>instances</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id self_url'>self_url</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>status</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id status'>status</span>
    <span class='kw'>end</span>

    <span class='id stats'>stats</span> <span class='op'>&lt;&lt;</span> <span class='id stat_hash'>stat_hash</span>

    <span class='kw'>if</span> <span class='ivar'>@instances</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='op'>||</span> <span class='op'>!</span><span class='id include_slaves'>include_slaves</span>
        <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>stats</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id merge_stats'>merge_stats</span><span class='lparen'>(</span> <span class='id stats'>stats</span> <span class='rparen'>)</span>
        <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>instances</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>instances</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id values'>values</span> <span class='kw'>if</span> <span class='id include_slaves'>include_slaves</span>
        <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='id data'>data</span> <span class='rparen'>)</span>
        <span class='kw'>return</span>
    <span class='kw'>end</span>

    <span class='op'>::</span><span class='const'>EM</span><span class='op'>::</span><span class='const'>Iterator</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='ivar'>@instances</span><span class='comma'>,</span> <span class='const'>MAX_CONCURRENCY</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id map'>map</span><span class='lparen'>(</span> <span class='id proc'>proc</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id instance'>instance</span><span class='comma'>,</span> <span class='id iter'>iter</span><span class='op'>|</span>
        <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='id instance'>instance</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id framework'>framework</span><span class='period'>.</span><span class='id progress_data'>progress_data</span><span class='lparen'>(</span> <span class='id opts'>opts</span> <span class='rparen'>)</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id tmp'>tmp</span><span class='op'>|</span>
            <span class='id tmp'>tmp</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id instance'>instance</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
            <span class='id iter'>iter</span><span class='period'>.</span><span class='id return'>return</span><span class='lparen'>(</span> <span class='id tmp'>tmp</span> <span class='rparen'>)</span>
        <span class='rbrace'>}</span>
    <span class='rbrace'>}</span><span class='comma'>,</span> <span class='id proc'>proc</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id slave_data'>slave_data</span><span class='op'>|</span>

        <span class='id slave_data'>slave_data</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id slave'>slave</span><span class='op'>|</span>
            <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>messages</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>  <span class='op'>|=</span> <span class='id slave'>slave</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>messages</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id include_messages'>include_messages</span>
            <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>issues</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>    <span class='op'>|=</span> <span class='id slave'>slave</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>issues</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='id include_issues'>include_issues</span>

            <span class='kw'>if</span> <span class='id include_slaves'>include_slaves</span>
                <span class='id url'>url</span> <span class='op'>=</span> <span class='id slave'>slave</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
                <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>instances</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id url'>url</span><span class='rbracket'>]</span>           <span class='op'>=</span> <span class='id slave'>slave</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>stats</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
                <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>instances</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id url'>url</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>    <span class='op'>=</span> <span class='id url'>url</span>
                <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>instances</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id url'>url</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>status</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id slave'>slave</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>status</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
            <span class='kw'>end</span>

            <span class='id stats'>stats</span> <span class='op'>&lt;&lt;</span> <span class='id slave'>slave</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>stats</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span>
        <span class='rbrace'>}</span>

        <span class='kw'>if</span> <span class='id include_slaves'>include_slaves</span>
            <span class='id sorted_data_instances'>sorted_data_instances</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
            <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>instances</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id keys'>keys</span><span class='period'>.</span><span class='id sort'>sort</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id url'>url</span><span class='op'>|</span>
                <span class='id sorted_data_instances'>sorted_data_instances</span><span class='lbracket'>[</span><span class='id url'>url</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>instances</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id url'>url</span><span class='rbracket'>]</span>
            <span class='rbrace'>}</span>
            <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>instances</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id sorted_data_instances'>sorted_data_instances</span><span class='period'>.</span><span class='id values'>values</span>
        <span class='kw'>end</span>

        <span class='id data'>data</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>stats</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id merge_stats'>merge_stats</span><span class='lparen'>(</span> <span class='id stats'>stats</span> <span class='rparen'>)</span>
        <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='id data'>data</span> <span class='rparen'>)</span>
    <span class='rbrace'>}</span><span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="register_issue-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>register_issue</strong>(results) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Registers a YAML serialized array holding [Arachni::Issue] objects with the
local instance.
</p>
<p>
Primarily used by slaves to register any issue they find on the spot.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>results</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
YAML dump of an array with YAML serialized [Arachni::Issue] objects
</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


399
400
401
402</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 399</span>

<span class='kw'>def</span> <span class='id register_issue'>register_issue</span><span class='lparen'>(</span> <span class='id results'>results</span> <span class='rparen'>)</span>
    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id modules'>modules</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id register_results'>register_results</span><span class='lparen'>(</span> <span class='id results'>results</span> <span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="report-instance_method">
  
    - (<tt>YAML</tt>) <strong>report</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the results of the audit.
</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>YAML</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
YAML dump of the results hash
</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


597
598
599
600
601
602
603
604</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 597</span>

<span class='kw'>def</span> <span class='id report'>report</span>
    <span class='id exception_jail'>exception_jail</span> <span class='lbrace'>{</span>
        <span class='id store'>store</span> <span class='op'>=</span>  <span class='ivar'>@framework</span><span class='period'>.</span><span class='id audit_store'>audit_store</span><span class='lparen'>(</span> <span class='kw'>true</span> <span class='rparen'>)</span>
        <span class='id store'>store</span><span class='period'>.</span><span class='id framework'>framework</span> <span class='op'>=</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span>
        <span class='kw'>return</span> <span class='const'>YAML</span><span class='period'>.</span><span class='id dump'>dump</span><span class='lparen'>(</span> <span class='id store'>store</span><span class='period'>.</span><span class='id to_h'>to_h</span><span class='period'>.</span><span class='id dup'>dup</span> <span class='rparen'>)</span>
    <span class='rbrace'>}</span>
    <span class='kw'>return</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="restrict_to_elements!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>restrict_to_elements!</strong>(elements) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


354
355
356
357</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 354</span>

<span class='kw'>def</span> <span class='id restrict_to_elements!'>restrict_to_elements!</span><span class='lparen'>(</span> <span class='id elements'>elements</span> <span class='rparen'>)</span>
    <span class='op'>::</span><span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Element</span><span class='op'>::</span><span class='const'>Auditable</span><span class='period'>.</span><span class='id restrict_to_elements!'>restrict_to_elements!</span><span class='lparen'>(</span> <span class='id elements'>elements</span> <span class='rparen'>)</span>
    <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="resume!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>resume!</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='resume-instance_method'>resume</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  

  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="../Framework.html#resume%21-instance_method" title="Arachni::RPC::Server::Framework#resume! (method)">Framework#resume!</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


341
342
343
344
345
346
347
348</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 341</span>

<span class='kw'>def</span> <span class='id resume!'>resume!</span>
    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id resume!'>resume!</span>
    <span class='op'>::</span><span class='const'>EM</span><span class='op'>::</span><span class='const'>Iterator</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='ivar'>@instances</span><span class='comma'>,</span> <span class='ivar'>@instances</span><span class='period'>.</span><span class='id size'>size</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id instance'>instance</span><span class='comma'>,</span> <span class='id iter'>iter</span><span class='op'>|</span>
        <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='id instance'>instance</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id framework'>framework</span><span class='period'>.</span><span class='id resume!'>resume!</span><span class='lbrace'>{</span> <span class='id iter'>iter</span><span class='period'>.</span><span class='id next'>next</span> <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>
    <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="revision-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>revision</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


664
665
666</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 664</span>

<span class='kw'>def</span> <span class='id revision'>revision</span>
    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id version'>version</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="run-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>run</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Starts the audit.
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


146
147
148
149
150
151
152
153
154
155
156
157
158
159
160
161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207
208
209
210
211
212
213
214
215
216
217
218
219
220
221
222
223
224
225
226
227
228
229
230
231
232
233
234
235
236
237
238
239
240
241
242
243
244
245
246
247
248
249
250
251
252
253
254
255
256
257
258
259
260
261
262
263
264
265
266
267
268
269
270
271
272
273
274
275
276
277
278</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 146</span>

<span class='kw'>def</span> <span class='id run'>run</span>
    <span class='comment'># EventMachine.add_periodic_timer( 1 ) do
</span>        <span class='comment'># print &quot;Arachni::RPC::Client::Handler objects: &quot;
</span>        <span class='comment'># puts ObjectSpace.each_object( Arachni::RPC::Client::Handler ) {}
</span><span class='comment'>#
</span>        <span class='comment'># print &quot;Arachni::RPC::Server::Proxy objects: &quot;
</span>        <span class='comment'># puts ObjectSpace.each_object( Arachni::RPC::Server::Proxy ) {}
</span><span class='comment'>#
</span>        <span class='comment'># puts &quot;Active connections: #{::EM.connection_count}&quot;
</span>        <span class='comment'># puts '--------------------------------------------'
</span>    <span class='comment'># end
</span>
    <span class='op'>::</span><span class='const'>EM</span><span class='period'>.</span><span class='id defer'>defer</span> <span class='lbrace'>{</span>

        <span class='comment'>#
</span>        <span class='comment'># if we're in HPG mode do fancy stuff like distributing and balancing workload
</span>        <span class='comment'># as well as starting slave instances and deal with some lower level
</span>        <span class='comment'># operations of the local instance like running plug-ins etc...
</span>        <span class='comment'>#
</span>        <span class='comment'># otherwise just run the local instance, nothing special...
</span>        <span class='comment'>#
</span>        <span class='kw'>if</span> <span class='id high_performance?'>high_performance?</span>
            <span class='ivar'>@starting</span> <span class='op'>=</span> <span class='kw'>true</span>

            <span class='comment'>#
</span>            <span class='comment'># We're in HPG (High Performance Grid) mode,
</span>            <span class='comment'># things are going to get weird...
</span>            <span class='comment'>#
</span>
            <span class='comment'># we'll need analyze the pages prior to assigning
</span>            <span class='comment'># them to each instance at the element level so as to gain
</span>            <span class='comment'># more granular control over the assigned workload
</span>            <span class='comment'>#
</span>            <span class='comment'># put simply, we'll need to perform some magic in order
</span>            <span class='comment'># to prevent different instances from auditing the same elements
</span>            <span class='comment'># and wasting bandwidth
</span>            <span class='comment'>#
</span>            <span class='comment'># for example: search forms, logout links and the like will
</span>            <span class='comment'># most likely exist on most pages of the site and since each
</span>            <span class='comment'># instance is assigned a set of URLs/pages to audit they will end up
</span>            <span class='comment'># with common elements so we have to prevent instances from
</span>            <span class='comment'># performing identical checks.
</span>            <span class='comment'>#
</span>            <span class='comment'># interesting note: should previously unseen elements dynamically
</span>            <span class='comment'># appear during the audit they will override these restrictions
</span>            <span class='comment'># and each instance will audit them at will.
</span>            <span class='comment'>#
</span>            <span class='id pages'>pages</span> <span class='op'>=</span> <span class='op'>::</span><span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Database</span><span class='op'>::</span><span class='const'>Hash</span><span class='period'>.</span><span class='id new'>new</span>

            <span class='comment'># prepare the local instance (runs plugins and start the timer)
</span>            <span class='ivar'>@framework</span><span class='period'>.</span><span class='id prepare'>prepare</span>

            <span class='comment'># we need to take our cues from the local framework as some
</span>            <span class='comment'># plug-ins may need the system to wait for them to finish
</span>            <span class='comment'># before moving on.
</span>            <span class='id sleep'>sleep</span><span class='lparen'>(</span> <span class='float'>0.2</span> <span class='rparen'>)</span> <span class='kw'>while</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id paused?'>paused?</span>

            <span class='comment'># start the crawl and extract all paths
</span>            <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Spider</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id opts'>opts</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id run'>run</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id page'>page</span><span class='op'>|</span>
                <span class='ivar'>@sitemap</span> <span class='op'>&lt;&lt;</span> <span class='id page'>page</span><span class='period'>.</span><span class='id url'>url</span>
                <span class='id pages'>pages</span><span class='lbracket'>[</span><span class='id page'>page</span><span class='period'>.</span><span class='id url'>url</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id page'>page</span>
            <span class='rbrace'>}</span>
            <span class='ivar'>@crawling_done</span> <span class='op'>=</span> <span class='kw'>true</span>

            <span class='comment'># the plug-ins may have update the framework page_queue
</span>            <span class='comment'># so we need to distribute these pages as well
</span>            <span class='id page_a'>page_a</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
            <span class='id page_q'>page_q</span> <span class='op'>=</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id get_page_queue'>get_page_queue</span>
            <span class='kw'>while</span> <span class='op'>!</span><span class='id page_q'>page_q</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='id page'>page</span> <span class='op'>=</span> <span class='id page_q'>page_q</span><span class='period'>.</span><span class='id pop'>pop</span>
                <span class='id page_a'>page_a</span> <span class='op'>&lt;&lt;</span> <span class='id page'>page</span>
                <span class='id pages'>pages</span><span class='lbracket'>[</span><span class='id page'>page</span><span class='period'>.</span><span class='id url'>url</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id page'>page</span>
            <span class='kw'>end</span>

            <span class='comment'># get the Dispatchers with unique Pipe IDs
</span>            <span class='comment'># in order to take advantage of line aggregation
</span>            <span class='id prefered_dispatchers'>prefered_dispatchers</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id pref_dispatchers'>pref_dispatchers</span><span class='op'>|</span>

                <span class='comment'># decide in how many chunks to split the paths
</span>                <span class='id chunk_cnt'>chunk_cnt</span> <span class='op'>=</span> <span class='id pref_dispatchers'>pref_dispatchers</span><span class='period'>.</span><span class='id size'>size</span> <span class='op'>+</span> <span class='int'>1</span>

                <span class='comment'># split the URLs of the pages in equal chunks and group them
</span>                <span class='id chunks'>chunks</span> <span class='op'>=</span> <span class='id pages'>pages</span><span class='period'>.</span><span class='id keys'>keys</span><span class='period'>.</span><span class='id chunk'>chunk</span><span class='lparen'>(</span> <span class='id chunk_cnt'>chunk_cnt</span> <span class='rparen'>)</span>

                <span class='comment'># split the page array into chunks that will be distributed
</span>                <span class='comment'># across the instances
</span>                <span class='id page_chunks'>page_chunks</span> <span class='op'>=</span> <span class='id page_a'>page_a</span><span class='period'>.</span><span class='id chunk'>chunk</span><span class='lparen'>(</span> <span class='id chunk_cnt'>chunk_cnt</span> <span class='rparen'>)</span>

                <span class='comment'># assign us our fair share of plug-in discovered pages
</span>                <span class='ivar'>@framework</span><span class='period'>.</span><span class='id update_page_queue'>update_page_queue</span><span class='lparen'>(</span> <span class='id page_chunks'>page_chunks</span><span class='period'>.</span><span class='id pop'>pop</span> <span class='rparen'>)</span>

                <span class='comment'># remove duplicate elements across the (per instance) chunks
</span>                <span class='comment'># while spreading them out evenly
</span>                <span class='id elements'>elements</span> <span class='op'>=</span> <span class='id distribute_elements'>distribute_elements</span><span class='lparen'>(</span> <span class='id chunks'>chunks</span><span class='comma'>,</span> <span class='id pages'>pages</span> <span class='rparen'>)</span>

                <span class='comment'># restrict the local instance to its assigned elements
</span>                <span class='id restrict_to_elements!'>restrict_to_elements!</span><span class='lparen'>(</span> <span class='id elements'>elements</span><span class='period'>.</span><span class='id pop'>pop</span> <span class='rparen'>)</span>

                <span class='comment'># set the URLs to be audited by the local instance
</span>                <span class='ivar'>@framework</span><span class='period'>.</span><span class='id opts'>opts</span><span class='period'>.</span><span class='id restrict_paths'>restrict_paths</span> <span class='op'>=</span> <span class='id chunks'>chunks</span><span class='period'>.</span><span class='id pop'>pop</span>

                <span class='id chunks'>chunks</span><span class='period'>.</span><span class='id each_with_index'>each_with_index</span> <span class='lbrace'>{</span>
                    <span class='op'>|</span><span class='id chunk'>chunk</span><span class='comma'>,</span> <span class='id i'>i</span><span class='op'>|</span>

                    <span class='comment'># spawn a remote instance, assign a chunk of URLs
</span>                    <span class='comment'># and elements to it and run it
</span>                    <span class='id spawn'>spawn</span><span class='lparen'>(</span> <span class='id chunk'>chunk</span><span class='comma'>,</span> <span class='id page_chunks'>page_chunks</span><span class='lbracket'>[</span><span class='id i'>i</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id elements'>elements</span><span class='lbracket'>[</span><span class='id i'>i</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id pref_dispatchers'>pref_dispatchers</span><span class='lbracket'>[</span><span class='id i'>i</span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='lbrace'>{</span>
                        <span class='op'>|</span><span class='id inst'>inst</span><span class='op'>|</span>
                        <span class='ivar'>@instances</span> <span class='op'>&lt;&lt;</span> <span class='id inst'>inst</span>
                    <span class='rbrace'>}</span>
                <span class='rbrace'>}</span>

                <span class='comment'># start the local instance
</span>                <span class='ivar'>@job</span> <span class='op'>=</span> <span class='const'>Thread</span><span class='period'>.</span><span class='id new'>new</span> <span class='lbrace'>{</span>
                    <span class='id exception_jail'>exception_jail</span><span class='lbrace'>{</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id audit'>audit</span> <span class='rbrace'>}</span>
                    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id override_sitemap!'>override_sitemap!</span><span class='lparen'>(</span> <span class='ivar'>@sitemap</span> <span class='rparen'>)</span>
                    <span class='id exception_jail'>exception_jail</span><span class='lbrace'>{</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id clean_up!'>clean_up!</span> <span class='rbrace'>}</span>
                <span class='rbrace'>}</span>
                <span class='ivar'>@starting</span> <span class='op'>=</span> <span class='kw'>false</span>

                <span class='comment'># empty out the Hash and remove temporary files
</span>                <span class='id pages'>pages</span><span class='period'>.</span><span class='id clear'>clear</span>
            <span class='rbrace'>}</span>
        <span class='kw'>else</span>
            <span class='comment'># start the local instance
</span>            <span class='ivar'>@framework</span><span class='period'>.</span><span class='id run'>run</span>
        <span class='kw'>end</span>

    <span class='rbrace'>}</span>

    <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="set_master-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>set_master</strong>(url, token) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Set the URL and authentication token required to connect to our master.
</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>url</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
master&#8217;s URL in &#8216;<a
href="https://hostname:port">hostname:port</a>&#8217; form
</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>token</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><p>
master&#8217;s authentication token
</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


365
366
367
368
369
370
371
372
373
374
375
376</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 365</span>

<span class='kw'>def</span> <span class='id set_master'>set_master</span><span class='lparen'>(</span> <span class='id url'>url</span><span class='comma'>,</span> <span class='id token'>token</span> <span class='rparen'>)</span>
    <span class='ivar'>@master_url</span> <span class='op'>=</span> <span class='id url'>url</span>
    <span class='ivar'>@master</span> <span class='op'>=</span> <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='lbrace'>{</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>url</span><span class='tstring_end'>'</span></span> <span class='op'>=&gt;</span> <span class='id url'>url</span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>token</span><span class='tstring_end'>'</span></span> <span class='op'>=&gt;</span> <span class='id token'>token</span> <span class='rbrace'>}</span> <span class='rparen'>)</span>

    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id modules'>modules</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id do_not_store!'>do_not_store!</span>
    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id modules'>modules</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id on_register_results'>on_register_results</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id results'>results</span><span class='op'>|</span>
        <span class='id report_issue_to_master'>report_issue_to_master</span><span class='lparen'>(</span> <span class='id results'>results</span> <span class='rparen'>)</span>
    <span class='rbrace'>}</span>

    <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="stats-instance_method">
  
    - (<tt>Hash</tt>) <strong>stats</strong>(fresh = true) 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Scan statistics
</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


565
566
567
568
569
570
571
572
573
574
575
576
577
578
579
580
581
582
583
584
585
586
587
588
589
590</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 565</span>

<span class='kw'>def</span> <span class='id stats'>stats</span><span class='lparen'>(</span> <span class='id fresh'>fresh</span> <span class='op'>=</span> <span class='kw'>true</span> <span class='rparen'>)</span>

    <span class='id stats'>stats</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>
    <span class='kw'>begin</span>
        <span class='id stats'>stats</span> <span class='op'>&lt;&lt;</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id stats'>stats</span><span class='lparen'>(</span> <span class='id fresh'>fresh</span><span class='comma'>,</span> <span class='kw'>true</span> <span class='rparen'>)</span>
    <span class='kw'>rescue</span>
        <span class='kw'>return</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='kw'>end</span>

    <span class='kw'>begin</span>
        <span class='id stats'>stats</span> <span class='op'>=</span> <span class='ivar'>@instances</span><span class='period'>.</span><span class='id map'>map</span> <span class='lbrace'>{</span> <span class='op'>|</span><span class='id instance'>instance</span><span class='op'>|</span> <span class='id connect_to_instance'>connect_to_instance</span><span class='lparen'>(</span> <span class='id instance'>instance</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id framework'>framework</span><span class='period'>.</span><span class='id stats'>stats</span><span class='lparen'>(</span> <span class='id fresh'>fresh</span> <span class='rparen'>)</span> <span class='rbrace'>}</span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id e'>e</span>
        <span class='comment'># ap e
</span>        <span class='comment'># ap e.backtrace
</span>    <span class='kw'>end</span>

    <span class='id final_stats'>final_stats</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span>
    <span class='kw'>begin</span>
        <span class='id final_stats'>final_stats</span> <span class='op'>=</span> <span class='id merge_stats'>merge_stats</span><span class='lparen'>(</span> <span class='id stats'>stats</span> <span class='rparen'>)</span>
    <span class='kw'>rescue</span> <span class='const'>Exception</span> <span class='op'>=&gt;</span> <span class='id e'>e</span>
        <span class='comment'># ap e
</span>        <span class='comment'># ap e.backtrace
</span>    <span class='kw'>end</span>

    <span class='kw'>return</span> <span class='id final_stats'>final_stats</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="status-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>) <strong>status</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Returns the status of the instance as a string.
</p>
<p>
Possible values are:
</p>
<pre class="code">
 <span class='id o'>o</span> <span class='id crawling'>crawling</span>
 <span class='id o'>o</span> <span class='id paused'>paused</span>
 <span class='id o'>o</span> <span class='id done'>done</span>
 <span class='id o'>o</span> <span class='id busy'>busy</span></pre>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


446
447
448
449
450
451
452
453
454
455
456</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 446</span>

<span class='kw'>def</span> <span class='id status'>status</span>
    <span class='kw'>if</span> <span class='op'>!</span><span class='ivar'>@crawling_done</span> <span class='op'>&amp;&amp;</span> <span class='id master'>master</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='op'>&amp;&amp;</span> <span class='id high_performance?'>high_performance?</span>
        <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>crawling</span><span class='tstring_end'>'</span></span>
    <span class='kw'>elsif</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id paused?'>paused?</span>
        <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>paused</span><span class='tstring_end'>'</span></span>
    <span class='kw'>elsif</span> <span class='op'>!</span><span class='id local_busy?'>local_busy?</span>
        <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>done</span><span class='tstring_end'>'</span></span>
    <span class='kw'>else</span>
        <span class='kw'>return</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>busy</span><span class='tstring_end'>'</span></span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="update_page_queue-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>update_page_queue</strong>(pages) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


378
379
380
381</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 378</span>

<span class='kw'>def</span> <span class='id update_page_queue'>update_page_queue</span><span class='lparen'>(</span> <span class='id pages'>pages</span> <span class='rparen'>)</span>
    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id update_page_queue'>update_page_queue</span><span class='lparen'>(</span> <span class='id pages'>pages</span> <span class='rparen'>)</span>
    <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="verbose?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>verbose?</strong> 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='is_verbose-instance_method'>is_verbose</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="../Framework.html#verbose%3F-instance_method" title="Arachni::RPC::Server::Framework#verbose? (method)">Framework#verbose?</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


99
100
101</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 99</span>

<span class='kw'>def</span> <span class='id verbose?'>verbose?</span>
    <span class='cvar'>@@verbose</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="verbose_off-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>verbose_off</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Disables debugging output
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


708
709
710</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 708</span>

<span class='kw'>def</span> <span class='id verbose_off'>verbose_off</span>
    <span class='cvar'>@@verbose</span> <span class='op'>=</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="verbose_on-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>verbose_on</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    <p>
Enables debugging output
</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


701
702
703</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 701</span>

<span class='kw'>def</span> <span class='id verbose_on'>verbose_on</span>
    <span class='cvar'>@@verbose</span> <span class='op'>=</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="version-instance_method">
  
    - (<tt><span class='object_link'><a href="../../../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>version</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


660
661
662</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/rpc/server/high_performance/framework.rb', line 660</span>

<span class='kw'>def</span> <span class='id version'>version</span>
    <span class='ivar'>@framework</span><span class='period'>.</span><span class='id version'>version</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Tue Nov  1 15:24:48 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.3 (ruby-1.9.2).
</div>

  </body>
</html>