<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<title>
  Module: Arachni::Module::Auditor
  
    &mdash; Arachni - Web Application Security Scanner Framework
  
</title>

  <link rel="stylesheet" href="../../css/style.css" type="text/css" media="screen" charset="utf-8" />

  <link rel="stylesheet" href="../../css/common.css" type="text/css" media="screen" charset="utf-8" />

<script type="text/javascript" charset="utf-8">
  relpath = '../..';
  if (relpath != '') relpath += '/';
</script>

  <script type="text/javascript" charset="utf-8" src="../../js/jquery.js"></script>

  <script type="text/javascript" charset="utf-8" src="../../js/app.js"></script>


  </head>
  <body>
    <script type="text/javascript" charset="utf-8">
      if (window.top.frames.main) document.body.className = 'frames';
    </script>
    
    <div id="header">
      <div id="menu">
  
    <a href="../../_index.html">Index (A)</a> &raquo; 
    <span class='title'><span class='object_link'><a href="../../Arachni.html" title="Arachni (module)">Arachni</a></span></span> &raquo; <span class='title'><span class='object_link'><a href="../Module.html" title="Arachni::Module (module)">Module</a></span></span>
     &raquo; 
    <span class="title">Auditor</span>
  
  
  <div class="noframes"><span class="title">(</span><a href="." target="_top">no frames</a><span class="title">)</span></div>
</div>

      <div id="search">
  
    <a id="class_list_link" href="#">Class List</a>
  
    <a id="method_list_link" href="#">Method List</a>
  
    <a id="file_list_link" href="#">File List</a>
  
</div>
      <div class="clear"></div>
    </div>
    
    <iframe id="search_frame"></iframe>
    
    <div id="content"><h1>Module: Arachni::Module::Auditor
  
  
  
</h1>

<dl class="box">
  
  
    
  
    
  
  
    <dt class="r1">Included in:</dt>
    <dd class="r1"><span class='object_link'><a href="Base.html" title="Arachni::Module::Base (class)">Base</a></span></dd>
    
  
  
    <dt class="r2 last">Defined in:</dt>
    <dd class="r2 last">lib/arachni/module/auditor.rb</dd>
  
</dl>
<div class="clear"></div>

<h2>Overview</h2><div class="docstring">
  <div class="discussion">
    
<p>Auditor module</p>

<p>Included by <span class='object_link'><a href="Base.html" title="Arachni::Module::Base (class)">Base</a></span> and provides abstract audit methods.</p>

<p>There are 3 main types of audit techniques available:</p>
<ul><li>
<p>Pattern matching -- <span class='object_link'><a href="#audit-instance_method" title="Arachni::Module::Auditor#audit (method)">#audit</a></span></p>
</li><li>
<p>Timing attacks -- <span class='object_link'><a href="#audit_timeout-instance_method" title="Arachni::Module::Auditor#audit_timeout (method)">#audit_timeout</a></span></p>
</li><li>
<p>Differential analysis attacks -- <span class='object_link'><a href="#audit_rdiff-instance_method" title="Arachni::Module::Auditor#audit_rdiff (method)">#audit_rdiff</a></span></p>
</li></ul>

<p>@author: Tasos "Zapotek" Laskos</p>

<pre class="code">&lt;tasos.laskos@gmail.com&gt;
&lt;zapotek@segfault.gr&gt;</pre>

<p>@version: 0.3.1</p>


  </div>
</div>
<div class="tags">
  

</div><h2>Defined Under Namespace</h2>
<p class="children">
   
    
      <strong class="modules">Modules:</strong> <span class='object_link'><a href="Auditor/Element.html" title="Arachni::Module::Auditor::Element (module)">Element</a></span>, <span class='object_link'><a href="Auditor/Format.html" title="Arachni::Module::Auditor::Format (module)">Format</a></span>
    
   
    
  
</p>

  <h2>Constant Summary</h2>
  
    <dl class="constants">
      
        <dt id="RDIFF_OPTIONS-constant" class="">RDIFF_OPTIONS =
          
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>
    <span class='comment'># append our seeds to the default values
</span>    <span class='symbol'>:format</span>      <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='const'>Format</span><span class='op'>::</span><span class='const'>APPEND</span> <span class='rbracket'>]</span><span class='comma'>,</span>

    <span class='comment'># allow duplicate requests
</span>    <span class='symbol'>:redundant</span>   <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>

    <span class='comment'># amount of rdiff iterations
</span>    <span class='symbol'>:precision</span>   <span class='op'>=&gt;</span> <span class='int'>2</span>
<span class='rbrace'>}</span></pre></dd>
      
        <dt id="OPTIONS-constant" class="">OPTIONS =
          <div class="docstring">
  <div class="discussion">
    
<p>Default audit options.</p>


  </div>
</div>
<div class="tags">
  

</div>
        </dt>
        <dd><pre class="code"><span class='lbrace'>{</span>

    <span class='comment'>#
</span>    <span class='comment'># Elements to audit.
</span>    <span class='comment'>#
</span>    <span class='comment'># Only required when calling {#audit}.&lt;br/&gt;
</span>    <span class='comment'># If no elements have been passed to audit it will
</span>    <span class='comment'># use the elements in {#self.info}.
</span>    <span class='comment'>#
</span>    <span class='symbol'>:elements</span> <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='const'>Element</span><span class='op'>::</span><span class='const'>LINK</span><span class='comma'>,</span> <span class='const'>Element</span><span class='op'>::</span><span class='const'>FORM</span><span class='comma'>,</span>
                   <span class='const'>Element</span><span class='op'>::</span><span class='const'>COOKIE</span><span class='comma'>,</span> <span class='const'>Element</span><span class='op'>::</span><span class='const'>HEADER</span><span class='comma'>,</span>
                   <span class='const'>Issue</span><span class='op'>::</span><span class='const'>Element</span><span class='op'>::</span><span class='const'>BODY</span> <span class='rbracket'>]</span><span class='comma'>,</span>

    <span class='comment'>#
</span>    <span class='comment'># The regular expression to match against the response body.
</span>    <span class='comment'>#
</span>    <span class='symbol'>:regexp</span>   <span class='op'>=&gt;</span> <span class='kw'>nil</span><span class='comma'>,</span>

    <span class='comment'>#
</span>    <span class='comment'># Verify the matched string with this value.
</span>    <span class='comment'>#
</span>    <span class='symbol'>:match</span>    <span class='op'>=&gt;</span> <span class='kw'>nil</span><span class='comma'>,</span>

    <span class='comment'>#
</span>    <span class='comment'># Formatting of the injection strings.
</span>    <span class='comment'>#
</span>    <span class='comment'># A new set of audit inputs will be generated
</span>    <span class='comment'># for each value in the array.
</span>    <span class='comment'>#
</span>    <span class='comment'># Values can be OR'ed bitfields of all available constants
</span>    <span class='comment'># of {Auditor::Format}.
</span>    <span class='comment'>#
</span>    <span class='comment'># @see  Auditor::Format
</span>    <span class='comment'>#
</span>    <span class='symbol'>:format</span>   <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='const'>Format</span><span class='op'>::</span><span class='const'>STRAIGHT</span><span class='comma'>,</span> <span class='const'>Format</span><span class='op'>::</span><span class='const'>APPEND</span><span class='comma'>,</span>
                   <span class='const'>Format</span><span class='op'>::</span><span class='const'>NULL</span><span class='comma'>,</span> <span class='const'>Format</span><span class='op'>::</span><span class='const'>APPEND</span> <span class='op'>|</span> <span class='const'>Format</span><span class='op'>::</span><span class='const'>NULL</span> <span class='rbracket'>]</span><span class='comma'>,</span>

    <span class='comment'>#
</span>    <span class='comment'># If 'train' is set to true the HTTP response will be
</span>    <span class='comment'># analyzed for new elements. &lt;br/&gt;
</span>    <span class='comment'># Be careful when enabling it, there'll be a performance penalty.
</span>    <span class='comment'>#
</span>    <span class='comment'># When the Auditor submits a form with original or sample values
</span>    <span class='comment'># this option will be overridden to true.
</span>    <span class='comment'>#
</span>    <span class='symbol'>:train</span>     <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>

    <span class='comment'>#
</span>    <span class='comment'># Enable skipping of already audited inputs
</span>    <span class='comment'>#
</span>    <span class='symbol'>:redundant</span> <span class='op'>=&gt;</span> <span class='kw'>false</span><span class='comma'>,</span>

    <span class='comment'>#
</span>    <span class='comment'># Make requests asynchronously
</span>    <span class='comment'>#
</span>    <span class='symbol'>:async</span>     <span class='op'>=&gt;</span> <span class='kw'>true</span>
<span class='rbrace'>}</span></pre></dd>
      
    </dl>
  





  
    <h2>
      Class Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_timeout_audit_block-class_method" title="add_timeout_audit_block (class method)">+ (Object) <strong>add_timeout_audit_block</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#add_timeout_candidate-class_method" title="add_timeout_candidate (class method)">+ (Object) <strong>add_timeout_candidate</strong>(elem) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit_timeout_phase_2-class_method" title="audit_timeout_phase_2 (class method)">+ (Object) <strong>audit_timeout_phase_2</strong>(elem) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Runs phase 2 of the timing attack auditing an individual element (which
passed phase 1) with a higher delay and timeout.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit_timeout_stabilize-class_method" title="audit_timeout_stabilize (class method)">+ (Object) <strong>audit_timeout_stabilize</strong>(elem) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Submits an element which has just been audited using a timing attack with a
high timeout in order to determine when the effects of a timing attack has
worn off in order to safely continue the audit.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#call_on_timing_blocks-class_method" title="call_on_timing_blocks (class method)">+ (Object) <strong>call_on_timing_blocks</strong>(res, elem) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#current_timeout_audit_operations_cnt-class_method" title="current_timeout_audit_operations_cnt (class method)">+ (Object) <strong>current_timeout_audit_operations_cnt</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#included-class_method" title="included (class method)">+ (Object) <strong>included</strong>(mod) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#on_timing_attacks-class_method" title="on_timing_attacks (class method)">+ (Object) <strong>on_timing_attacks</strong>(&amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#running_timeout_attacks%3F-class_method" title="running_timeout_attacks? (class method)">+ (Boolean) <strong>running_timeout_attacks?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#timeout_audit_blocks-class_method" title="timeout_audit_blocks (class method)">+ (Queue) <strong>timeout_audit_blocks</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Holds timing-attack performing Procs to be run after all non-timing-attack
modules have finished.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#timeout_audit_operations_cnt-class_method" title="timeout_audit_operations_cnt (class method)">+ (Object) <strong>timeout_audit_operations_cnt</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#timeout_audit_run-class_method" title="timeout_audit_run (class method)">+ (Object) <strong>timeout_audit_run</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Runs all blocks in <span class='object_link'><a href="#timeout_audit_blocks-class_method" title="Arachni::Module::Auditor.timeout_audit_blocks (method)">timeout_audit_blocks</a></span> and verifies and logs the
candidate elements.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#timeout_loaded_modules-class_method" title="timeout_loaded_modules (class method)">+ (Set) <strong>timeout_loaded_modules</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Returns the names of all loaded modules that use timing attacks.</p>
</div></span>
  
</li>

      
    </ul>
  
    <h2>
      Instance Method Summary
      <small>(<a href="#" class="summary_toggle">collapse</a>)</small>
    </h2>

    <ul class="summary">
      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#__rdiff_audit_id-instance_method" title="#__rdiff_audit_id (instance method)">- (Object) <strong>__rdiff_audit_id</strong>(elem) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#__rdiff_audited%21-instance_method" title="#__rdiff_audited! (instance method)">- (Object) <strong>__rdiff_audited!</strong>(elem) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#__rdiff_audited%3F-instance_method" title="#__rdiff_audited? (instance method)">- (Boolean) <strong>__rdiff_audited?</strong>(elem) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit-instance_method" title="#audit (instance method)">- (Object) <strong>audit</strong>(injection_str, opts = { }, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Provides easy access to element auditing using simple injection and pattern
matching.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit_elems-instance_method" title="#audit_elems (instance method)">- (Object) <strong>audit_elems</strong>(elements, injection_str, opts = { }, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Audits Auditable HTML/HTTP elements.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit_rdiff-instance_method" title="#audit_rdiff (instance method)">- (Object) <strong>audit_rdiff</strong>(opts = {}, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Audits all elements types in <a href="http://:elements">opts</a> (or <a
href="http://:elements">self.class.info</a> if there are none in opts)
using differential analysis attacks.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit_rdiff_elem-instance_method" title="#audit_rdiff_elem (instance method)">- (Object) <strong>audit_rdiff_elem</strong>(elem, opts = {}, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Audits a single element using an rdiff attack.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit_timeout-instance_method" title="#audit_timeout (instance method)">- (Object) <strong>audit_timeout</strong>(strings, opts) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Audits elements using timing attacks and automatically logs results.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#audit_timeout_debug_msg-instance_method" title="#audit_timeout_debug_msg (instance method)">- (Object) <strong>audit_timeout_debug_msg</strong>(phase, delay) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#call_on_timing_blocks-instance_method" title="#call_on_timing_blocks (instance method)">- (Object) <strong>call_on_timing_blocks</strong>(res, elem) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'></div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#log-instance_method" title="#log (instance method)">- (Object) <strong>log</strong>(opts, res = nil) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Populates and logs an <span class='object_link'><a href="../Issue.html" title="Arachni::Issue (class)">Issue</a></span> based on data from "opts" and "res".</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#log_issue-instance_method" title="#log_issue (instance method)">- (Object) <strong>log_issue</strong>(opts) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Helper method for issue logging.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#log_remote_file-instance_method" title="#log_remote_file (instance method)">- (Object) <strong>log_remote_file</strong>(res) </a>
    

    
      (also: #log_remote_directory)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Logs the existence of a remote file as an issue.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#log_remote_file_if_exists-instance_method" title="#log_remote_file_if_exists (instance method)">- (Object) <strong>log_remote_file_if_exists</strong>(url, silent = false, &amp;block) </a>
    

    
      (also: #log_remote_directory_if_exists)
    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Logs a remote file or directory if it exists.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#match_and_log-instance_method" title="#match_and_log (instance method)">- (Object) <strong>match_and_log</strong>(regexps, string = @page.html, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Matches the "string" (default string is the HTML code in @page.html) to an
array of regular expressions and logs the results.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#method_missing-instance_method" title="#method_missing (instance method)">- (Object) <strong>method_missing</strong>(sym, *args, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Provides the following methods:</p>
<ul><li>
<p>audit_links()</p>
</li><li>
<p>audit_forms()</p>
</li><li>
<p>audit_cookies()</p>
</li><li>
<p>audit_headers().</p>
</li></ul>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#override_instance_scope%3F-instance_method" title="#override_instance_scope? (instance method)">- (Bool) <strong>override_instance_scope?</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>ABSTRACT - OPTIONAL.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#redundant-instance_method" title="#redundant (instance method)">- (Array) <strong>redundant</strong> </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>ABSTRACT - OPTIONAL.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#register_results-instance_method" title="#register_results (instance method)">- (Object) <strong>register_results</strong>(issues) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Just a delegator logs an array of issues.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#remote_file_exist%3F-instance_method" title="#remote_file_exist? (instance method)">- (Boolean) <strong>remote_file_exist?</strong>(res) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Checks that the response points to an existing file/page and not an error
or custom 404 response.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#skip%3F-instance_method" title="#skip? (instance method)">- (Boolean) <strong>skip?</strong>(elem) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>This is called right before an [Arachni::Parser::Element] is
submitted/audited and is used to determine whether to skip it or not.</p>
</div></span>
  
</li>

      
        <li class="public ">
  <span class="summary_signature">
    
      <a href="#timing_attack-instance_method" title="#timing_attack (instance method)">- (Object) <strong>timing_attack</strong>(strings, opts, &amp;block) </a>
    

    
  </span>
  
  
  
  
  
  

  
    <span class="summary_desc"><div class='inline'>
<p>Audits elements using a timing attack.</p>
</div></span>
  
</li>

      
    </ul>
  

<div id="method_missing_details" class="method_details_list">
  <h2>Dynamic Method Handling</h2>
  <p class="notice this">
    This class handles dynamic methods through the <tt>method_missing</tt> method
    
  </p>
  
    <div class="method_details first">
  <p class="signature first" id="method_missing-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>method_missing</strong>(sym, *args, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Provides the following methods:</p>
<ul><li>
<p>audit_links()</p>
</li><li>
<p>audit_forms()</p>
</li><li>
<p>audit_cookies()</p>
</li><li>
<p>audit_headers()</p>
</li></ul>

<p>Metaprogrammed to avoid redundant code while maintaining compatibility and
method shortcuts.</p>


  </div>
</div>
<div class="tags">
  
<h3>Raises:</h3>
<ul class="raise">
  
    <li>
      
      
        <span class='type'>(<tt>NoMethodError</tt>)</span>
      
      
      
    </li>
  
</ul>

  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="#audit_elems-instance_method" title="Arachni::Module::Auditor#audit_elems (method)">#audit_elems</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1024
1025
1026
1027
1028
1029
1030
1031
1032
1033
1034
1035
1036
1037
1038</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 1024</span>

<span class='kw'>def</span> <span class='id method_missing'>method_missing</span><span class='lparen'>(</span> <span class='id sym'>sym</span><span class='comma'>,</span> <span class='op'>*</span><span class='id args'>args</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>

    <span class='id elem'>elem</span> <span class='op'>=</span> <span class='id sym'>sym</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='period'>.</span><span class='id gsub!'>gsub!</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>audit_</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>@</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
    <span class='id raise'>raise</span> <span class='const'>NoMethodError</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Undefined method '</span><span class='embexpr_beg'>#{</span><span class='id sym'>sym</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='rbrace'>}</span><span class='tstring_content'>'.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id sym'>sym</span><span class='comma'>,</span> <span class='id args'>args</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id elem'>elem</span>

    <span class='id elems'>elems</span> <span class='op'>=</span> <span class='ivar'>@page</span><span class='period'>.</span><span class='id instance_variable_get'>instance_variable_get</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>

    <span class='kw'>if</span><span class='lparen'>(</span> <span class='id elems'>elems</span> <span class='op'>&amp;&amp;</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
        <span class='id raise'>raise</span> <span class='const'>ArgumentError</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Missing required argument 'injection_str'</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span>
            <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'> for audit_</span><span class='embexpr_beg'>#{</span><span class='id elem'>elem</span><span class='period'>.</span><span class='id gsub'>gsub</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>@</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span><span class='rbrace'>}</span><span class='tstring_content'>().</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span> <span class='kw'>if</span><span class='lparen'>(</span> <span class='op'>!</span><span class='id args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
        <span class='id audit_elems'>audit_elems</span><span class='lparen'>(</span> <span class='id elems'>elems</span><span class='comma'>,</span> <span class='id args'>args</span><span class='lbracket'>[</span><span class='int'>0</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id args'>args</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span> <span class='op'>?</span> <span class='id args'>args</span><span class='lbracket'>[</span><span class='int'>1</span><span class='rbracket'>]</span><span class='op'>:</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
    <span class='kw'>else</span>
        <span class='id raise'>raise</span> <span class='const'>NoMethodError</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Undefined method '</span><span class='embexpr_beg'>#{</span><span class='id sym'>sym</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='rbrace'>}</span><span class='tstring_content'>'.</span><span class='tstring_end'>&quot;</span></span><span class='comma'>,</span> <span class='id sym'>sym</span><span class='comma'>,</span> <span class='id args'>args</span> <span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
  
</div>


  <div id="class_method_details" class="method_details_list">
    <h2>Class Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="add_timeout_audit_block-class_method">
  
    + (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>add_timeout_audit_block</strong>(&amp;block) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


82
83
84
85</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 82</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id add_timeout_audit_block'>add_timeout_audit_block</span><span class='lparen'>(</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
    <span class='cvar'>@@__timeout_audit_operations_cnt</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='cvar'>@@__timeout_audit_blocks</span> <span class='op'>&lt;&lt;</span> <span class='id block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="add_timeout_candidate-class_method">
  
    + (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>add_timeout_candidate</strong>(elem) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


87
88
89
90</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 87</span>

<span class='kw'>def</span> <span class='const'>Auditor</span><span class='period'>.</span><span class='id add_timeout_candidate'>add_timeout_candidate</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
    <span class='cvar'>@@__timeout_audit_operations_cnt</span> <span class='op'>+=</span> <span class='int'>1</span>
    <span class='cvar'>@@__timeout_candidates</span> <span class='op'>&lt;&lt;</span> <span class='id elem'>elem</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit_timeout_phase_2-class_method">
  
    + (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>audit_timeout_phase_2</strong>(elem) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Runs phase 2 of the timing attack auditing an individual element (which
passed phase 1) with a higher delay and timeout</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


626
627
628
629
630
631
632
633
634
635
636
637
638
639
640
641
642
643
644
645
646
647
648
649
650
651
652
653
654
655
656
657
658
659
660
661
662
663
664
665
666
667
668
669
670
671
672
673
674
675
676</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 626</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id audit_timeout_phase_2'>audit_timeout_phase_2</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>

    <span class='comment'># reset the audited list since we're going to re-audit the elements
</span>    <span class='comment'># @@__timeout_audited = Set.new
</span>
    <span class='id opts'>opts</span> <span class='op'>=</span> <span class='id elem'>elem</span><span class='period'>.</span><span class='id opts'>opts</span>
    <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span> <span class='op'>*=</span> <span class='int'>2</span>
    <span class='comment'># opts[:async]    = false
</span>    <span class='comment'># self.audit_timeout_debug_msg( 2, opts[:timeout] )
</span>
    <span class='id str'>str</span> <span class='op'>=</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:timing_string</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id gsub'>gsub</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>__TIME__</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
        <span class='lparen'>(</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span> <span class='op'>/</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:timeout_divider</span><span class='rbracket'>]</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id to_s'>to_s</span> <span class='rparen'>)</span>

    <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span> <span class='op'>*=</span> <span class='float'>0.7</span>

    <span class='id elem'>elem</span><span class='period'>.</span><span class='id auditable'>auditable</span> <span class='op'>=</span> <span class='id elem'>elem</span><span class='period'>.</span><span class='id orig'>orig</span>

    <span class='comment'># this is the control; request the URL of the element to make sure
</span>    <span class='comment'># that the web page is alive i.e won't time-out by default
</span>    <span class='id elem'>elem</span><span class='period'>.</span><span class='id get_auditor'>get_auditor</span><span class='period'>.</span><span class='id http'>http</span><span class='period'>.</span><span class='id get'>get</span><span class='lparen'>(</span> <span class='id elem'>elem</span><span class='period'>.</span><span class='id action'>action</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id on_complete'>on_complete</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id res'>res</span><span class='op'>|</span>

        <span class='kw'>self</span><span class='period'>.</span><span class='id call_on_timing_blocks'>call_on_timing_blocks</span><span class='lparen'>(</span> <span class='id res'>res</span><span class='comma'>,</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>

        <span class='kw'>if</span> <span class='op'>!</span><span class='id res'>res</span><span class='period'>.</span><span class='id timed_out?'>timed_out?</span>

            <span class='id elem'>elem</span><span class='period'>.</span><span class='id get_auditor'>get_auditor</span><span class='period'>.</span><span class='id print_info'>print_info</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Liveness check was successful, progressing to verification...</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>

            <span class='id elem'>elem</span><span class='period'>.</span><span class='id audit'>audit</span><span class='lparen'>(</span> <span class='id str'>str</span><span class='comma'>,</span> <span class='id opts'>opts</span> <span class='rparen'>)</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id c_res'>c_res</span><span class='comma'>,</span> <span class='id c_opts'>c_opts</span><span class='op'>|</span>

                <span class='kw'>if</span> <span class='id c_res'>c_res</span><span class='period'>.</span><span class='id timed_out?'>timed_out?</span>

                    <span class='comment'># all issues logged by timing attacks need manual verification.
</span>                    <span class='comment'># end of story.
</span>                    <span class='comment'># c_opts[:verification] = true
</span>                    <span class='id elem'>elem</span><span class='period'>.</span><span class='id get_auditor'>get_auditor</span><span class='period'>.</span><span class='id log'>log</span><span class='lparen'>(</span> <span class='id c_opts'>c_opts</span><span class='comma'>,</span> <span class='id c_res'>c_res</span> <span class='rparen'>)</span>

                    <span class='kw'>self</span><span class='period'>.</span><span class='id audit_timeout_stabilize'>audit_timeout_stabilize</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>

                <span class='kw'>else</span>
                    <span class='id elem'>elem</span><span class='period'>.</span><span class='id get_auditor'>get_auditor</span><span class='period'>.</span><span class='id print_info'>print_info</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Verification failed.</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
                <span class='kw'>end</span>
            <span class='rbrace'>}</span>
        <span class='kw'>else</span>
            <span class='id elem'>elem</span><span class='period'>.</span><span class='id get_auditor'>get_auditor</span><span class='period'>.</span><span class='id print_info'>print_info</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Liveness check failed, bailing out...</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='rbrace'>}</span>

    <span class='id elem'>elem</span><span class='period'>.</span><span class='id get_auditor'>get_auditor</span><span class='period'>.</span><span class='id http'>http</span><span class='period'>.</span><span class='id run'>run</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit_timeout_stabilize-class_method">
  
    + (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>audit_timeout_stabilize</strong>(elem) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Submits an element which has just been audited using a timing attack with a
high timeout in order to determine when the effects of a timing attack has
worn off in order to safely continue the audit.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>elem</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Element/Auditable.html" title="Arachni::Element::Auditable (class)">Arachni::Element::Auditable</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


685
686
687
688
689
690
691
692
693
694
695
696
697
698
699
700
701
702
703
704
705
706
707
708
709
710</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 685</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id audit_timeout_stabilize'>audit_timeout_stabilize</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>

    <span class='id d_opts'>d_opts</span> <span class='op'>=</span> <span class='lbrace'>{</span>
        <span class='symbol'>:skip_orig</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
        <span class='symbol'>:redundant</span> <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
        <span class='symbol'>:timeout</span>   <span class='op'>=&gt;</span> <span class='int'>120000</span><span class='comma'>,</span>
        <span class='symbol'>:silent</span>    <span class='op'>=&gt;</span> <span class='kw'>true</span><span class='comma'>,</span>
        <span class='symbol'>:async</span>     <span class='op'>=&gt;</span> <span class='kw'>false</span>
    <span class='rbrace'>}</span>

    <span class='id orig_opts'>orig_opts</span> <span class='op'>=</span> <span class='id elem'>elem</span><span class='period'>.</span><span class='id opts'>opts</span>

    <span class='id elem'>elem</span><span class='period'>.</span><span class='id get_auditor'>get_auditor</span><span class='period'>.</span><span class='id print_info'>print_info</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Waiting for the effects of the timing attack to wear off.</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
    <span class='id elem'>elem</span><span class='period'>.</span><span class='id get_auditor'>get_auditor</span><span class='period'>.</span><span class='id print_info'>print_info</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Max waiting time: </span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='lparen'>(</span> <span class='id d_opts'>d_opts</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span> <span class='op'>/</span><span class='int'>1000</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id to_s'>to_s</span> <span class='op'>+</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'> seconds.</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>

    <span class='id elem'>elem</span><span class='period'>.</span><span class='id auditable'>auditable</span> <span class='op'>=</span> <span class='id elem'>elem</span><span class='period'>.</span><span class='id orig'>orig</span>
    <span class='id res'>res</span> <span class='op'>=</span> <span class='id elem'>elem</span><span class='period'>.</span><span class='id submit'>submit</span><span class='lparen'>(</span> <span class='id d_opts'>d_opts</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id response'>response</span>

    <span class='kw'>if</span> <span class='op'>!</span><span class='id res'>res</span><span class='period'>.</span><span class='id timed_out?'>timed_out?</span>
        <span class='id elem'>elem</span><span class='period'>.</span><span class='id get_auditor'>get_auditor</span><span class='period'>.</span><span class='id print_info'>print_info</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Server seems responsive again.</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
    <span class='kw'>else</span>
        <span class='id elem'>elem</span><span class='period'>.</span><span class='id get_auditor'>get_auditor</span><span class='period'>.</span><span class='id print_error'>print_error</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Max waiting time exceeded, the server may be dead.</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
    <span class='kw'>end</span>

    <span class='id elem'>elem</span><span class='period'>.</span><span class='id opts'>opts</span><span class='period'>.</span><span class='id merge!'>merge!</span><span class='lparen'>(</span> <span class='id orig_opts'>orig_opts</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="call_on_timing_blocks-class_method">
  
    + (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>call_on_timing_blocks</strong>(res, elem) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


105
106
107
108
109
110</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 105</span>

<span class='kw'>def</span> <span class='const'>Auditor</span><span class='period'>.</span><span class='id call_on_timing_blocks'>call_on_timing_blocks</span><span class='lparen'>(</span> <span class='id res'>res</span><span class='comma'>,</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
    <span class='cvar'>@@__on_timing_attacks</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id block'>block</span><span class='op'>|</span>
        <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='id res'>res</span><span class='comma'>,</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="current_timeout_audit_operations_cnt-class_method">
  
    + (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>current_timeout_audit_operations_cnt</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


78
79
80</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 78</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id current_timeout_audit_operations_cnt'>current_timeout_audit_operations_cnt</span>
    <span class='cvar'>@@__timeout_audit_blocks</span><span class='period'>.</span><span class='id size'>size</span> <span class='op'>+</span> <span class='cvar'>@@__timeout_candidates</span><span class='period'>.</span><span class='id size'>size</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="included-class_method">
  
    + (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>included</strong>(mod) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 32</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id included'>included</span><span class='lparen'>(</span> <span class='id mod'>mod</span> <span class='rparen'>)</span>
    <span class='comment'># @@__timeout_audited      ||= Set.new
</span>
    <span class='comment'># holds timing-attack performing Procs to be run after all
</span>    <span class='comment'># non-timing-attack modules have finished.
</span>    <span class='cvar'>@@__timeout_audit_blocks</span>   <span class='op'>||=</span> <span class='const'>Queue</span><span class='period'>.</span><span class='id new'>new</span>

    <span class='cvar'>@@__timeout_audit_operations_cnt</span> <span class='op'>||=</span> <span class='int'>0</span>

    <span class='comment'># populated by timing attack phase 1 with
</span>    <span class='comment'># candidate elements to be verified by phase 2
</span>    <span class='cvar'>@@__timeout_candidates</span>     <span class='op'>||=</span> <span class='const'>Queue</span><span class='period'>.</span><span class='id new'>new</span>

    <span class='comment'># modules which have called the timing attack audit method (audit_timeout)
</span>    <span class='comment'># we're interested in the amount, not the names, and is used to
</span>    <span class='comment'># determine scan progress
</span>    <span class='cvar'>@@__timeout_loaded_modules</span> <span class='op'>||=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id new'>new</span>

    <span class='cvar'>@@__on_timing_attacks</span>      <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

    <span class='cvar'>@@__running_timeout_attacks</span> <span class='op'>||=</span> <span class='kw'>false</span>

    <span class='comment'># the rdiff attack performs it own redundancy checks so we need this to
</span>    <span class='comment'># keep track audited elements
</span>    <span class='cvar'>@@__rdiff_audited</span> <span class='op'>||=</span> <span class='const'>Set</span><span class='period'>.</span><span class='id new'>new</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="on_timing_attacks-class_method">
  
    + (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>on_timing_attacks</strong>(&amp;block) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


97
98
99</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 97</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id on_timing_attacks'>on_timing_attacks</span><span class='lparen'>(</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
    <span class='cvar'>@@__on_timing_attacks</span> <span class='op'>&lt;&lt;</span> <span class='id block'>block</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="running_timeout_attacks?-class_method">
  
    + (<tt>Boolean</tt>) <strong>running_timeout_attacks?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


93
94
95</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 93</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id running_timeout_attacks?'>running_timeout_attacks?</span>
    <span class='cvar'>@@__running_timeout_attacks</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="timeout_audit_blocks-class_method">
  
    + (<tt>Queue</tt>) <strong>timeout_audit_blocks</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Holds timing-attack performing Procs to be run after all non-timing-attack
modules have finished.</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Queue</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


74
75
76</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 74</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id timeout_audit_blocks'>timeout_audit_blocks</span>
    <span class='cvar'>@@__timeout_audit_blocks</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="timeout_audit_operations_cnt-class_method">
  
    + (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>timeout_audit_operations_cnt</strong> 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


101
102
103</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 101</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id timeout_audit_operations_cnt'>timeout_audit_operations_cnt</span>
    <span class='cvar'>@@__timeout_audit_operations_cnt</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="timeout_audit_run-class_method">
  
    + (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>timeout_audit_run</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Runs all blocks in <span class='object_link'><a href="#timeout_audit_blocks-class_method" title="Arachni::Module::Auditor.timeout_audit_blocks (method)">timeout_audit_blocks</a></span> and verifies and logs the
candidate elements.</p>


  </div>
</div>
<div class="tags">
  

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


610
611
612
613
614
615
616
617
618
619
620</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 610</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id timeout_audit_run'>timeout_audit_run</span>
    <span class='cvar'>@@__running_timeout_attacks</span> <span class='op'>=</span> <span class='kw'>true</span>

    <span class='kw'>while</span><span class='lparen'>(</span> <span class='op'>!</span><span class='cvar'>@@__timeout_audit_blocks</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='rparen'>)</span>
        <span class='cvar'>@@__timeout_audit_blocks</span><span class='period'>.</span><span class='id pop'>pop</span><span class='period'>.</span><span class='id call'>call</span>
    <span class='kw'>end</span>

    <span class='kw'>while</span><span class='lparen'>(</span> <span class='op'>!</span><span class='cvar'>@@__timeout_candidates</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='rparen'>)</span>
        <span class='kw'>self</span><span class='period'>.</span><span class='id audit_timeout_phase_2'>audit_timeout_phase_2</span><span class='lparen'>(</span> <span class='cvar'>@@__timeout_candidates</span><span class='period'>.</span><span class='id pop'>pop</span> <span class='rparen'>)</span>
    <span class='kw'>end</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="timeout_loaded_modules-class_method">
  
    + (<tt>Set</tt>) <strong>timeout_loaded_modules</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Returns the names of all loaded modules that use timing attacks.</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Set</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


64
65
66</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 64</span>

<span class='kw'>def</span> <span class='kw'>self</span><span class='period'>.</span><span class='id timeout_loaded_modules'>timeout_loaded_modules</span>
    <span class='cvar'>@@__timeout_loaded_modules</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

  <div id="instance_method_details" class="method_details_list">
    <h2>Instance Method Details</h2>
    
    
      <div class="method_details first">
  <p class="signature first" id="__rdiff_audit_id-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>__rdiff_audit_id</strong>(elem) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1008
1009
1010</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 1008</span>

<span class='kw'>def</span> <span class='id __rdiff_audit_id'>__rdiff_audit_id</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
    <span class='id elem'>elem</span><span class='period'>.</span><span class='id action'>action</span> <span class='op'>+</span> <span class='id elem'>elem</span><span class='period'>.</span><span class='id auditable'>auditable</span><span class='period'>.</span><span class='id keys'>keys</span><span class='period'>.</span><span class='id to_s'>to_s</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="__rdiff_audited!-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>__rdiff_audited!</strong>(elem) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1000
1001
1002</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 1000</span>

<span class='kw'>def</span> <span class='id __rdiff_audited!'>__rdiff_audited!</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
    <span class='cvar'>@@__rdiff_audited</span> <span class='op'>&lt;&lt;</span> <span class='id __rdiff_audit_id'>__rdiff_audit_id</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="__rdiff_audited?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>__rdiff_audited?</strong>(elem) 
  

  
</p><div class="docstring">
  <div class="discussion">
    

  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1004
1005
1006</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 1004</span>

<span class='kw'>def</span> <span class='id __rdiff_audited?'>__rdiff_audited?</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
    <span class='cvar'>@@__rdiff_audited</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span> <span class='id __rdiff_audit_id'>__rdiff_audit_id</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>audit</strong>(injection_str, opts = { }, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Provides easy access to element auditing using simple injection and pattern
matching.</p>

<p>If a block has been provided analysis and logging will be delegated to it,
otherwise, if a match is found it will be automatically logged.</p>

<p>If no elements have been specified in 'opts' it will use the elements from
the module's "self.info()" hash. &lt;br/&gt; If no elements have been
specified in 'opts' or "self.info()" it will use the elements in <span class='object_link'><a href="#OPTIONS-constant" title="Arachni::Module::Auditor::OPTIONS (constant)">OPTIONS</a></span>.
&lt;br/&gt;</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>injection_str</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the string to be injected</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{ }</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>options as described in <span class='object_link'><a href="#OPTIONS-constant" title="Arachni::Module::Auditor::OPTIONS (constant)">OPTIONS</a></span></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>&amp;block</span>
      
      
        <span class='type'>(<tt>Block</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>block to be used for custom analysis of responses; will be passed the
following:</p>
<ul><li>
<p>HTTP response</p>
</li><li>
<p>options</p>
</li><li>
<p>element</p>
</li></ul>

<p>The block will be called as soon as the HTTP response is received.</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


494
495
496
497
498
499
500
501
502
503
504
505
506
507
508
509
510
511
512
513
514
515
516
517
518
519
520
521
522
523
524
525
526
527
528</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 494</span>

<span class='kw'>def</span> <span class='id audit'>audit</span><span class='lparen'>(</span> <span class='id injection_str'>injection_str</span><span class='comma'>,</span> <span class='id opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>

    <span class='kw'>if</span><span class='lparen'>(</span> <span class='op'>!</span><span class='id opts'>opts</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span> <span class='symbol'>:elements</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='op'>!</span><span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='rparen'>)</span>
        <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span><span class='lparen'>(</span> <span class='op'>!</span><span class='id opts'>opts</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span> <span class='symbol'>:elements</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='op'>!</span><span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='rparen'>)</span>
        <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>OPTIONS</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='id opts'>opts</span>  <span class='op'>=</span> <span class='const'>OPTIONS</span><span class='period'>.</span><span class='id merge'>merge</span><span class='lparen'>(</span> <span class='id opts'>opts</span> <span class='rparen'>)</span>

    <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id elem'>elem</span><span class='op'>|</span>

        <span class='kw'>case</span> <span class='id elem'>elem</span>

            <span class='kw'>when</span>  <span class='const'>Element</span><span class='op'>::</span><span class='const'>LINK</span>
                <span class='id audit_links'>audit_links</span><span class='lparen'>(</span> <span class='id injection_str'>injection_str</span><span class='comma'>,</span> <span class='id opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>

            <span class='kw'>when</span>  <span class='const'>Element</span><span class='op'>::</span><span class='const'>FORM</span>
                <span class='id audit_forms'>audit_forms</span><span class='lparen'>(</span> <span class='id injection_str'>injection_str</span><span class='comma'>,</span> <span class='id opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>

            <span class='kw'>when</span>  <span class='const'>Element</span><span class='op'>::</span><span class='const'>COOKIE</span>
                <span class='id audit_cookies'>audit_cookies</span><span class='lparen'>(</span> <span class='id injection_str'>injection_str</span><span class='comma'>,</span> <span class='id opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>

            <span class='kw'>when</span>  <span class='const'>Element</span><span class='op'>::</span><span class='const'>HEADER</span>
                <span class='id audit_headers'>audit_headers</span><span class='lparen'>(</span> <span class='id injection_str'>injection_str</span><span class='comma'>,</span> <span class='id opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
            <span class='kw'>when</span>  <span class='const'>Element</span><span class='op'>::</span><span class='const'>BODY</span>
            <span class='kw'>else</span>
                <span class='id raise'>raise</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Unknown element to audit:  </span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id elem'>elem</span><span class='period'>.</span><span class='id to_s'>to_s</span> <span class='rparen'>)</span>
        <span class='kw'>end</span>

    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit_elems-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>audit_elems</strong>(elements, injection_str, opts = { }, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Audits Auditable HTML/HTTP elements</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>elements</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="../Element/Auditable.html" title="Arachni::Element::Auditable (class)">Arachni::Element::Auditable</a></span>&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>elements to audit</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>injection_str</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>same as for <span class='object_link'><a href="#audit-instance_method" title="Arachni::Module::Auditor#audit (method)">#audit</a></span></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{ }</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>same as for <span class='object_link'><a href="#audit-instance_method" title="Arachni::Module::Auditor#audit (method)">#audit</a></span></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>&amp;block</span>
      
      
        <span class='type'>(<tt>Block</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>same as for <span class='object_link'><a href="#audit-instance_method" title="Arachni::Module::Auditor#audit (method)">#audit</a></span></p>
</div>
      
    </li>
  
</ul>


  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="#method_missing-instance_method" title="Arachni::Module::Auditor#method_missing (method)">#method_missing</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


1050
1051
1052
1053
1054
1055
1056
1057
1058
1059
1060
1061
1062</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 1050</span>

<span class='kw'>def</span> <span class='id audit_elems'>audit_elems</span><span class='lparen'>(</span> <span class='id elements'>elements</span><span class='comma'>,</span> <span class='id injection_str'>injection_str</span><span class='comma'>,</span> <span class='id opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span> <span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>

    <span class='id opts'>opts</span> <span class='op'>=</span> <span class='const'>OPTIONS</span><span class='period'>.</span><span class='id merge'>merge</span><span class='lparen'>(</span> <span class='id opts'>opts</span> <span class='rparen'>)</span>
    <span class='id url'>url</span>  <span class='op'>=</span> <span class='ivar'>@page</span><span class='period'>.</span><span class='id url'>url</span>

    <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:injected_orig</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id injection_str'>injection_str</span>

    <span class='id elements'>elements</span><span class='period'>.</span><span class='id deep_clone'>deep_clone</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id elem'>elem</span><span class='op'>|</span>
        <span class='id elem'>elem</span><span class='period'>.</span><span class='id auditor'>auditor</span><span class='lparen'>(</span> <span class='kw'>self</span> <span class='rparen'>)</span>
        <span class='id elem'>elem</span><span class='period'>.</span><span class='id audit'>audit</span><span class='lparen'>(</span> <span class='id injection_str'>injection_str</span><span class='comma'>,</span> <span class='id opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit_rdiff-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>audit_rdiff</strong>(opts = {}, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Audits all elements types in <a href="http://:elements">opts</a> (or <a
href="http://:elements">self.class.info</a> if there are none in opts)
using differential analysis attacks.</p>

<pre class="code"><span class='id opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:precision</span> <span class='op'>=&gt;</span> <span class='int'>3</span><span class='comma'>,</span>
    <span class='symbol'>:faults</span>    <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>fault injections</span><span class='tstring_end'>'</span></span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='symbol'>:bools</span>     <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>boolean injections</span><span class='tstring_end'>'</span></span> <span class='rbracket'>]</span>
<span class='rbrace'>}</span>

<span class='id audit_rdiff'>audit_rdiff</span><span class='lparen'>(</span> <span class='id opts'>opts</span> <span class='rparen'>)</span></pre>

<p>Here's how it goes:</p>

<pre class="code">let default be the default/original response
let fault   be the response of the fault injection
let bool    be the response of the boolean injection

a vulnerability is logged if default == bool AND bool.code == 200 AND fault != bool</pre>

<p>The "bool" response is also checked in order to determine if it's a custom
404, if it is it'll be skipped.</p>

<p>If a block has been provided analysis and logging will be delegated to it.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>available options:</p>
<ul><li>
<p>:format -- as seen in <span class='object_link'><a href="#OPTIONS-constant" title="Arachni::Module::Auditor::OPTIONS (constant)">OPTIONS</a></span></p>
</li><li>
<p>:elements -- as seen in <span class='object_link'><a href="#OPTIONS-constant" title="Arachni::Module::Auditor::OPTIONS (constant)">OPTIONS</a></span></p>
</li><li>
<p>:train -- as seen in <span class='object_link'><a href="#OPTIONS-constant" title="Arachni::Module::Auditor::OPTIONS (constant)">OPTIONS</a></span></p>
</li><li>
<p>:precision -- amount of rdiff iterations</p>
</li><li>
<p>:faults -- array of fault injection strings (these are supposed to force
erroneous conditions when interpreted)</p>
</li><li>
<p>:bools -- array of boolean injection strings (these are supposed to not
alter the webapp behavior when interpreted)</p>
</li></ul>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>&amp;block</span>
      
      
        <span class='type'>(<tt>Block</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>block to be used for custom analysis of responses; will be passed the
following:</p>
<ul><li>
<p>injected string</p>
</li><li>
<p>audited element</p>
</li><li>
<p>default response body</p>
</li><li>
<p>boolean response</p>
</li><li>
<p>fault injection response body</p>
</li></ul>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


790
791
792
793
794
795
796
797
798
799
800
801
802
803
804
805
806
807
808
809
810
811
812
813
814
815
816
817
818
819
820
821
822
823
824
825
826
827
828
829
830
831
832
833
834
835
836
837
838
839</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 790</span>

<span class='kw'>def</span> <span class='id audit_rdiff'>audit_rdiff</span><span class='lparen'>(</span> <span class='id opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>

    <span class='kw'>if</span><span class='lparen'>(</span> <span class='op'>!</span><span class='id opts'>opts</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span> <span class='symbol'>:elements</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='op'>!</span><span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='rparen'>)</span>
        <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span><span class='lparen'>(</span> <span class='op'>!</span><span class='id opts'>opts</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span> <span class='symbol'>:elements</span><span class='rparen'>)</span> <span class='op'>||</span> <span class='op'>!</span><span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id empty?'>empty?</span> <span class='rparen'>)</span>
        <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='const'>OPTIONS</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span>
    <span class='kw'>end</span>

    <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id elem'>elem</span><span class='op'>|</span>

        <span class='kw'>case</span> <span class='id elem'>elem</span>

            <span class='kw'>when</span>  <span class='const'>Element</span><span class='op'>::</span><span class='const'>LINK</span>
                <span class='kw'>next</span> <span class='kw'>if</span> <span class='op'>!</span><span class='const'>Options</span><span class='period'>.</span><span class='id instance'>instance</span><span class='period'>.</span><span class='id audit_links'>audit_links</span>
                <span class='ivar'>@page</span><span class='period'>.</span><span class='id links'>links</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
                    <span class='op'>|</span><span class='id c_elem'>c_elem</span><span class='op'>|</span>
                    <span class='id audit_rdiff_elem'>audit_rdiff_elem</span><span class='lparen'>(</span> <span class='id c_elem'>c_elem</span><span class='comma'>,</span> <span class='id opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
                <span class='rbrace'>}</span>

            <span class='kw'>when</span>  <span class='const'>Element</span><span class='op'>::</span><span class='const'>FORM</span>
                <span class='kw'>next</span> <span class='kw'>if</span> <span class='op'>!</span><span class='const'>Options</span><span class='period'>.</span><span class='id instance'>instance</span><span class='period'>.</span><span class='id audit_forms'>audit_forms</span>
                <span class='ivar'>@page</span><span class='period'>.</span><span class='id forms'>forms</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
                    <span class='op'>|</span><span class='id c_elem'>c_elem</span><span class='op'>|</span>
                    <span class='id audit_rdiff_elem'>audit_rdiff_elem</span><span class='lparen'>(</span> <span class='id c_elem'>c_elem</span><span class='comma'>,</span> <span class='id opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
                <span class='rbrace'>}</span>

            <span class='kw'>when</span>  <span class='const'>Element</span><span class='op'>::</span><span class='const'>COOKIE</span>
                <span class='kw'>next</span> <span class='kw'>if</span> <span class='op'>!</span><span class='const'>Options</span><span class='period'>.</span><span class='id instance'>instance</span><span class='period'>.</span><span class='id audit_cookies'>audit_cookies</span>
                <span class='ivar'>@page</span><span class='period'>.</span><span class='id cookies'>cookies</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
                    <span class='op'>|</span><span class='id c_elem'>c_elem</span><span class='op'>|</span>
                    <span class='id audit_rdiff_elem'>audit_rdiff_elem</span><span class='lparen'>(</span> <span class='id c_elem'>c_elem</span><span class='comma'>,</span> <span class='id opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
                <span class='rbrace'>}</span>

            <span class='kw'>when</span>  <span class='const'>Element</span><span class='op'>::</span><span class='const'>HEADER</span>
                <span class='kw'>next</span> <span class='kw'>if</span> <span class='op'>!</span><span class='const'>Options</span><span class='period'>.</span><span class='id instance'>instance</span><span class='period'>.</span><span class='id audit_headers'>audit_headers</span>
                <span class='ivar'>@page</span><span class='period'>.</span><span class='id headers'>headers</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
                    <span class='op'>|</span><span class='id c_elem'>c_elem</span><span class='op'>|</span>
                    <span class='id audit_rdiff_elem'>audit_rdiff_elem</span><span class='lparen'>(</span> <span class='id c_elem'>c_elem</span><span class='comma'>,</span> <span class='id opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
                <span class='rbrace'>}</span>
            <span class='kw'>when</span>  <span class='const'>Element</span><span class='op'>::</span><span class='const'>BODY</span>
            <span class='kw'>else</span>
                <span class='id raise'>raise</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Unknown element to audit:  </span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id elem'>elem</span><span class='period'>.</span><span class='id to_s'>to_s</span> <span class='rparen'>)</span>

        <span class='kw'>end</span>

    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit_rdiff_elem-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>audit_rdiff_elem</strong>(elem, opts = {}, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Audits a single element using an rdiff attack.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>elem</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Element/Auditable.html" title="Arachni::Element::Auditable (class)">Arachni::Element::Auditable</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>the element to audit</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>{}</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>same as for <span class='object_link'><a href="#audit_rdiff-instance_method" title="Arachni::Module::Auditor#audit_rdiff (method)">#audit_rdiff</a></span></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>&amp;block</span>
      
      
        <span class='type'>(<tt>Block</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>same as for <span class='object_link'><a href="#audit_rdiff-instance_method" title="Arachni::Module::Auditor#audit_rdiff (method)">#audit_rdiff</a></span></p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


848
849
850
851
852
853
854
855
856
857
858
859
860
861
862
863
864
865
866
867
868
869
870
871
872
873
874
875
876
877
878
879
880
881
882
883
884
885
886
887
888
889
890
891
892
893
894
895
896
897
898
899
900
901
902
903
904
905
906
907
908
909
910
911
912
913
914
915
916
917
918
919
920
921
922
923
924
925
926
927
928
929
930
931
932
933
934
935
936
937
938
939
940
941
942
943
944
945
946
947
948
949
950
951
952
953
954
955
956
957
958
959
960
961
962
963
964
965
966
967
968
969
970
971
972
973
974
975
976
977
978
979
980
981
982
983
984
985
986
987
988
989
990
991
992
993
994
995
996
997
998</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 848</span>

<span class='kw'>def</span> <span class='id audit_rdiff_elem'>audit_rdiff_elem</span><span class='lparen'>(</span> <span class='id elem'>elem</span><span class='comma'>,</span> <span class='id opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>

    <span class='id opts'>opts</span> <span class='op'>=</span> <span class='const'>RDIFF_OPTIONS</span><span class='period'>.</span><span class='id merge'>merge</span><span class='lparen'>(</span> <span class='id opts'>opts</span> <span class='rparen'>)</span>

    <span class='comment'># don't continue if there's a missing value
</span>    <span class='id elem'>elem</span><span class='period'>.</span><span class='id auditable'>auditable</span><span class='period'>.</span><span class='id values'>values</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id val'>val</span><span class='op'>|</span>
        <span class='kw'>return</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id val'>val</span> <span class='op'>||</span> <span class='id val'>val</span><span class='period'>.</span><span class='id empty?'>empty?</span>
    <span class='rbrace'>}</span>

    <span class='kw'>return</span> <span class='kw'>if</span> <span class='id __rdiff_audited?'>__rdiff_audited?</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
    <span class='id __rdiff_audited!'>__rdiff_audited!</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>

    <span class='id responses'>responses</span> <span class='op'>=</span> <span class='lbrace'>{</span>
        <span class='symbol'>:orig</span> <span class='op'>=&gt;</span> <span class='kw'>nil</span><span class='comma'>,</span>
        <span class='symbol'>:good</span> <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span>
        <span class='symbol'>:bad</span>  <span class='op'>=&gt;</span> <span class='lbrace'>{</span><span class='rbrace'>}</span><span class='comma'>,</span>
        <span class='symbol'>:bad_total</span>  <span class='op'>=&gt;</span> <span class='int'>0</span><span class='comma'>,</span>
        <span class='symbol'>:good_total</span> <span class='op'>=&gt;</span> <span class='int'>0</span>
    <span class='rbrace'>}</span>

    <span class='id elem'>elem</span><span class='period'>.</span><span class='id auditor'>auditor</span><span class='lparen'>(</span> <span class='kw'>self</span> <span class='rparen'>)</span>
    <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:precision</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id times'>times</span> <span class='lbrace'>{</span>
        <span class='comment'># get the default responses
</span>        <span class='id elem'>elem</span><span class='period'>.</span><span class='id audit'>audit</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='id opts'>opts</span> <span class='rparen'>)</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id res'>res</span><span class='op'>|</span>
            <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:orig</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='id res'>res</span><span class='period'>.</span><span class='id body'>body</span>
            <span class='comment'># remove context-irrelevant dynamic content like banners and such
</span>            <span class='comment'># from the error page
</span>            <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:orig</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:orig</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id rdiff'>rdiff</span><span class='lparen'>(</span> <span class='id res'>res</span><span class='period'>.</span><span class='id body'>body</span> <span class='rparen'>)</span>
        <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>

    <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:precision</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id times'>times</span> <span class='lbrace'>{</span>
        <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:faults</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id str'>str</span><span class='op'>|</span>

            <span class='comment'># get injection variations that will hopefully cause an internal/silent
</span>            <span class='comment'># SQL error
</span>            <span class='id variations'>variations</span> <span class='op'>=</span> <span class='id elem'>elem</span><span class='period'>.</span><span class='id injection_sets'>injection_sets</span><span class='lparen'>(</span> <span class='id str'>str</span><span class='comma'>,</span> <span class='id opts'>opts</span> <span class='rparen'>)</span>

            <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:bad_total</span><span class='rbracket'>]</span> <span class='op'>=</span>  <span class='id variations'>variations</span><span class='period'>.</span><span class='id size'>size</span>

            <span class='id variations'>variations</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id c_elem'>c_elem</span><span class='op'>|</span>

                <span class='id print_status'>print_status</span><span class='lparen'>(</span> <span class='id c_elem'>c_elem</span><span class='period'>.</span><span class='id get_status_str'>get_status_str</span><span class='lparen'>(</span> <span class='id c_elem'>c_elem</span><span class='period'>.</span><span class='id altered'>altered</span> <span class='rparen'>)</span> <span class='rparen'>)</span>

                <span class='comment'># register us as the auditor
</span>                <span class='id c_elem'>c_elem</span><span class='period'>.</span><span class='id auditor'>auditor</span><span class='lparen'>(</span> <span class='kw'>self</span> <span class='rparen'>)</span>
                <span class='comment'># submit the link and get the response
</span>                <span class='id c_elem'>c_elem</span><span class='period'>.</span><span class='id submit'>submit</span><span class='lparen'>(</span> <span class='id opts'>opts</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id on_complete'>on_complete</span> <span class='lbrace'>{</span>
                    <span class='op'>|</span><span class='id res'>res</span><span class='op'>|</span>

                    <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:bad</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id c_elem'>c_elem</span><span class='period'>.</span><span class='id altered'>altered</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='id res'>res</span><span class='period'>.</span><span class='id body'>body</span><span class='period'>.</span><span class='id clone'>clone</span>

                    <span class='comment'># remove context-irrelevant dynamic content like banners and such
</span>                    <span class='comment'># from the error page
</span>                    <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:bad</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id c_elem'>c_elem</span><span class='period'>.</span><span class='id altered'>altered</span><span class='rbracket'>]</span> <span class='op'>=</span>
                        <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:bad</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id c_elem'>c_elem</span><span class='period'>.</span><span class='id altered'>altered</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id rdiff'>rdiff</span><span class='lparen'>(</span> <span class='id res'>res</span><span class='period'>.</span><span class='id body'>body</span><span class='period'>.</span><span class='id clone'>clone</span> <span class='rparen'>)</span>
                <span class='rbrace'>}</span>
            <span class='rbrace'>}</span>
        <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>

    <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:bools</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id str'>str</span><span class='op'>|</span>

        <span class='comment'># get injection variations that will not affect the outcome of the query
</span>        <span class='id variations'>variations</span> <span class='op'>=</span> <span class='id elem'>elem</span><span class='period'>.</span><span class='id injection_sets'>injection_sets</span><span class='lparen'>(</span> <span class='id str'>str</span><span class='comma'>,</span> <span class='id opts'>opts</span> <span class='rparen'>)</span>

        <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:good_total</span><span class='rbracket'>]</span> <span class='op'>=</span>  <span class='id variations'>variations</span><span class='period'>.</span><span class='id size'>size</span>

        <span class='id variations'>variations</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id c_elem'>c_elem</span><span class='op'>|</span>

            <span class='id print_status'>print_status</span><span class='lparen'>(</span> <span class='id c_elem'>c_elem</span><span class='period'>.</span><span class='id get_status_str'>get_status_str</span><span class='lparen'>(</span> <span class='id c_elem'>c_elem</span><span class='period'>.</span><span class='id altered'>altered</span> <span class='rparen'>)</span> <span class='rparen'>)</span>

            <span class='comment'># register us as the auditor
</span>            <span class='id c_elem'>c_elem</span><span class='period'>.</span><span class='id auditor'>auditor</span><span class='lparen'>(</span> <span class='kw'>self</span> <span class='rparen'>)</span>
            <span class='comment'># submit the link and get the response
</span>            <span class='id c_elem'>c_elem</span><span class='period'>.</span><span class='id submit'>submit</span><span class='lparen'>(</span> <span class='id opts'>opts</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id on_complete'>on_complete</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id res'>res</span><span class='op'>|</span>

                <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:good</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id c_elem'>c_elem</span><span class='period'>.</span><span class='id altered'>altered</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='lbracket'>[</span><span class='rbracket'>]</span>

                <span class='comment'># save the response for later analysis
</span>                <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:good</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id c_elem'>c_elem</span><span class='period'>.</span><span class='id altered'>altered</span><span class='rbracket'>]</span> <span class='op'>&lt;&lt;</span> <span class='lbrace'>{</span>
                    <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>str</span><span class='tstring_end'>'</span></span>  <span class='op'>=&gt;</span> <span class='id str'>str</span><span class='comma'>,</span>
                    <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>res</span><span class='tstring_end'>'</span></span>  <span class='op'>=&gt;</span> <span class='id res'>res</span><span class='comma'>,</span>
                    <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>elem</span><span class='tstring_end'>'</span></span> <span class='op'>=&gt;</span> <span class='id c_elem'>c_elem</span>
                <span class='rbrace'>}</span>
            <span class='rbrace'>}</span>
        <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>

    <span class='comment'># when this runs the 'responses' hash will have been populated
</span>    <span class='ivar'>@http</span><span class='period'>.</span><span class='id after_run'>after_run</span> <span class='lbrace'>{</span>

        <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:good</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id keys'>keys</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id key'>key</span><span class='op'>|</span>

            <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:good</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id key'>key</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id res'>res</span><span class='op'>|</span>

                <span class='kw'>if</span> <span class='id block'>block</span>
                    <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>str</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>elem</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:orig</span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>res</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='comma'>,</span> <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:bad</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id key'>key</span><span class='rbracket'>]</span> <span class='rparen'>)</span>
                <span class='kw'>elsif</span><span class='lparen'>(</span> <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:orig</span><span class='rbracket'>]</span> <span class='op'>==</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>res</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id body'>body</span> <span class='op'>&amp;&amp;</span>
                    <span class='id responses'>responses</span><span class='lbracket'>[</span><span class='symbol'>:bad</span><span class='rbracket'>]</span><span class='lbracket'>[</span><span class='id key'>key</span><span class='rbracket'>]</span> <span class='op'>!=</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>res</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id body'>body</span> <span class='op'>&amp;&amp;</span>
                    <span class='op'>!</span><span class='ivar'>@http</span><span class='period'>.</span><span class='id custom_404?'>custom_404?</span><span class='lparen'>(</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>res</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='op'>&amp;&amp;</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>res</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id code'>code</span> <span class='op'>==</span> <span class='int'>200</span> <span class='rparen'>)</span>

                    <span class='id url'>url</span> <span class='op'>=</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>res</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id effective_url'>effective_url</span>

                    <span class='comment'># since we bypassed the auditor completely we need to create
</span>                    <span class='comment'># our own opts hash and pass it to the Vulnerability class.
</span>                    <span class='comment'>#
</span>                    <span class='comment'># this is only required for Metasploitable vulnerabilities
</span>                    <span class='id opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span>
                        <span class='symbol'>:injected_orig</span> <span class='op'>=&gt;</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>str</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
                        <span class='symbol'>:combo</span>         <span class='op'>=&gt;</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>elem</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id auditable'>auditable</span>
                    <span class='rbrace'>}</span>

                    <span class='id issue'>issue</span> <span class='op'>=</span> <span class='const'>Issue</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='lbrace'>{</span>
                            <span class='symbol'>:var</span>          <span class='op'>=&gt;</span> <span class='id key'>key</span><span class='comma'>,</span>
                            <span class='symbol'>:url</span>          <span class='op'>=&gt;</span> <span class='id url'>url</span><span class='comma'>,</span>
                            <span class='symbol'>:method</span>       <span class='op'>=&gt;</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>res</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id request'>request</span><span class='period'>.</span><span class='id method'>method</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='comma'>,</span>
                            <span class='symbol'>:opts</span>         <span class='op'>=&gt;</span> <span class='id opts'>opts</span><span class='comma'>,</span>
                            <span class='symbol'>:injected</span>     <span class='op'>=&gt;</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>str</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
                            <span class='symbol'>:id</span>           <span class='op'>=&gt;</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>str</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='comma'>,</span>
                            <span class='symbol'>:regexp</span>       <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>n/a</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
                            <span class='symbol'>:regexp_match</span> <span class='op'>=&gt;</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>n/a</span><span class='tstring_end'>'</span></span><span class='comma'>,</span>
                            <span class='symbol'>:elem</span>         <span class='op'>=&gt;</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>elem</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id type'>type</span><span class='comma'>,</span>
                            <span class='symbol'>:response</span>     <span class='op'>=&gt;</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>res</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id body'>body</span><span class='comma'>,</span>
                            <span class='comment'># :verification =&gt; true,
</span>                            <span class='symbol'>:headers</span>      <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
                                <span class='symbol'>:request</span>    <span class='op'>=&gt;</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>res</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id request'>request</span><span class='period'>.</span><span class='id headers'>headers</span><span class='comma'>,</span>
                                <span class='symbol'>:response</span>   <span class='op'>=&gt;</span> <span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>res</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id headers'>headers</span><span class='comma'>,</span>
                            <span class='rbrace'>}</span>
                        <span class='rbrace'>}</span><span class='period'>.</span><span class='id merge'>merge</span><span class='lparen'>(</span> <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id info'>info</span> <span class='rparen'>)</span>
                    <span class='rparen'>)</span>

                    <span class='id print_ok'>print_ok</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>In </span><span class='embexpr_beg'>#{</span><span class='id res'>res</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>elem</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id type'>type</span><span class='rbrace'>}</span><span class='tstring_content'> var '</span><span class='embexpr_beg'>#{</span><span class='id key'>key</span><span class='rbrace'>}</span><span class='tstring_content'>' ( </span><span class='embexpr_beg'>#{</span><span class='id url'>url</span><span class='rbrace'>}</span><span class='tstring_content'> )</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span>

                    <span class='comment'># register our results with the system
</span>                    <span class='id register_results'>register_results</span><span class='lparen'>(</span> <span class='lbracket'>[</span> <span class='id issue'>issue</span> <span class='rbracket'>]</span> <span class='rparen'>)</span>
                <span class='kw'>end</span>

            <span class='rbrace'>}</span>
        <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit_timeout-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>audit_timeout</strong>(strings, opts) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Audits elements using timing attacks and automatically logs results.</p>

<p>Here's how it works:</p>
<ul><li>
<p>Loop 1 -- Populates the candidate queue. We're picking the low hanging
fruit here so we can run this in larger concurrent bursts which cause
<b>lots</b> of noise.</p>
<ul><li>
<p>Initial probing for candidates -- Any element that times out is added to a
queue.</p>
</li><li>
<p>Stabilization -- The candidate is submitted with its default values in
order to wait until the effects of the timing attack have worn off.</p>
</li></ul>
</li><li>
<p>Loop 2 -- Verifies the candidates. This is much more delicate so the
concurrent requests are lowered to pairs.</p>
<ul><li>
<p>Liveness test -- Ensures that stabilization was successful before moving
on.</p>
</li><li>
<p>Verification using an increased timeout -- Any elements that time out again
are logged.</p>
</li><li>
<p>Stabilization</p>
</li></ul>
</li></ul>

<p>Ideally, all requests involved with timing attacks would be run in sync
mode but the performance penalties are too high, thus we compromise and
make the best of it by running as little an amount of concurrent requests
as possible for any given phase.</p>

<pre class="code"><span class='id opts'>opts</span> <span class='op'>=</span> <span class='lbrace'>{</span>
    <span class='symbol'>:format</span>  <span class='op'>=&gt;</span> <span class='lbracket'>[</span> <span class='const'>Format</span><span class='op'>::</span><span class='const'>STRAIGHT</span> <span class='rbracket'>]</span><span class='comma'>,</span>
    <span class='symbol'>:timeout</span> <span class='op'>=&gt;</span> <span class='int'>4000</span><span class='comma'>,</span>
    <span class='symbol'>:timeout_divider</span> <span class='op'>=&gt;</span> <span class='int'>1000</span>
<span class='rbrace'>}</span>

<span class='id audit_timeout'>audit_timeout</span><span class='lparen'>(</span> <span class='lbracket'>[</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>sleep( __TIME__ );</span><span class='tstring_end'>'</span></span> <span class='rbracket'>]</span><span class='comma'>,</span> <span class='id opts'>opts</span> <span class='rparen'>)</span></pre>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>strings</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>injection strings __TIME__ will be substituted with (timeout /
timeout_divider)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>options as described in <span class='object_link'><a href="#OPTIONS-constant" title="Arachni::Module::Auditor::OPTIONS (constant)">OPTIONS</a></span> with the following extra:</p>
<ul><li>
<p>:timeout -- milliseconds to wait for the request to complete</p>
</li><li>
<p>:timeout_divider -- __TIME__ = timeout / timeout_divider</p>
</li></ul>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


585
586
587
588
589
590
591
592
593
594
595
596
597
598
599
600
601
602
603
604</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 585</span>

<span class='kw'>def</span> <span class='id audit_timeout'>audit_timeout</span><span class='lparen'>(</span> <span class='id strings'>strings</span><span class='comma'>,</span> <span class='id opts'>opts</span> <span class='rparen'>)</span>
    <span class='cvar'>@@__timeout_loaded_modules</span> <span class='op'>&lt;&lt;</span> <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>

    <span class='const'>Auditor</span><span class='period'>.</span><span class='id add_timeout_audit_block'>add_timeout_audit_block</span> <span class='lbrace'>{</span>
        <span class='id delay'>delay</span> <span class='op'>=</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span>

        <span class='id audit_timeout_debug_msg'>audit_timeout_debug_msg</span><span class='lparen'>(</span> <span class='int'>1</span><span class='comma'>,</span> <span class='id delay'>delay</span> <span class='rparen'>)</span>
        <span class='id timing_attack'>timing_attack</span><span class='lparen'>(</span> <span class='id strings'>strings</span><span class='comma'>,</span> <span class='id opts'>opts</span> <span class='rparen'>)</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id res'>res</span><span class='comma'>,</span> <span class='id c_opts'>c_opts</span><span class='comma'>,</span> <span class='id elem'>elem</span><span class='op'>|</span>

            <span class='id elem'>elem</span><span class='period'>.</span><span class='id auditor'>auditor</span><span class='lparen'>(</span> <span class='kw'>self</span> <span class='rparen'>)</span>

            <span class='id print_info'>print_info</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Found a candidate -- </span><span class='embexpr_beg'>#{</span><span class='id elem'>elem</span><span class='period'>.</span><span class='id type'>type</span><span class='period'>.</span><span class='id capitalize'>capitalize</span><span class='rbrace'>}</span><span class='tstring_content'> input '</span><span class='embexpr_beg'>#{</span><span class='id elem'>elem</span><span class='period'>.</span><span class='id altered'>altered</span><span class='rbrace'>}</span><span class='tstring_content'>' at </span><span class='embexpr_beg'>#{</span><span class='id elem'>elem</span><span class='period'>.</span><span class='id action'>action</span><span class='rbrace'>}</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span>

            <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Auditor</span><span class='period'>.</span><span class='id audit_timeout_stabilize'>audit_timeout_stabilize</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>

            <span class='const'>Auditor</span><span class='period'>.</span><span class='id add_timeout_candidate'>add_timeout_candidate</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
        <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="audit_timeout_debug_msg-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>audit_timeout_debug_msg</strong>(phase, delay) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


712
713
714
715
716
717</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 712</span>

<span class='kw'>def</span> <span class='id audit_timeout_debug_msg'>audit_timeout_debug_msg</span><span class='lparen'>(</span> <span class='id phase'>phase</span><span class='comma'>,</span> <span class='id delay'>delay</span> <span class='rparen'>)</span>
    <span class='id print_debug'>print_debug</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>---------------------------------------------</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
    <span class='id print_debug'>print_debug</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Running phase </span><span class='embexpr_beg'>#{</span><span class='id phase'>phase</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='rbrace'>}</span><span class='tstring_content'> of timing attack.</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span>
    <span class='id print_debug'>print_debug</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Delay set to: </span><span class='embexpr_beg'>#{</span><span class='id delay'>delay</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='rbrace'>}</span><span class='tstring_content'> milliseconds</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span>
    <span class='id print_debug'>print_debug</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>---------------------------------------------</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="call_on_timing_blocks-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>call_on_timing_blocks</strong>(res, elem) 
  

  
</p><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


112
113
114</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 112</span>

<span class='kw'>def</span> <span class='id call_on_timing_blocks'>call_on_timing_blocks</span><span class='lparen'>(</span> <span class='id res'>res</span><span class='comma'>,</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
    <span class='const'>Auditor</span><span class='period'>.</span><span class='id call_on_timing_blocks'>call_on_timing_blocks</span><span class='lparen'>(</span> <span class='id res'>res</span><span class='comma'>,</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="log-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>log</strong>(opts, res = nil) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Populates and logs an <span class='object_link'><a href="../Issue.html" title="Arachni::Issue (class)">Issue</a></span> based on data from "opts" and "res".</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>as passed to blocks by audit methods</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>res</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Typhoeus/Response.html" title="Typhoeus::Response (class)">Typhoeus::Response</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>nil</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>defaults to @page data</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


418
419
420
421
422
423
424
425
426
427
428
429
430
431
432
433
434
435
436
437
438
439
440
441
442
443
444
445
446
447
448
449
450
451
452
453
454
455
456
457
458
459
460
461
462
463
464
465
466
467
468
469
470</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 418</span>

<span class='kw'>def</span> <span class='id log'>log</span><span class='lparen'>(</span> <span class='id opts'>opts</span><span class='comma'>,</span> <span class='id res'>res</span> <span class='op'>=</span> <span class='kw'>nil</span> <span class='rparen'>)</span>

    <span class='id method'>method</span> <span class='op'>=</span> <span class='kw'>nil</span>

    <span class='id request_headers'>request_headers</span>  <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='id response_headers'>response_headers</span> <span class='op'>=</span> <span class='ivar'>@page</span><span class='period'>.</span><span class='id response_headers'>response_headers</span>
    <span class='id response'>response</span>         <span class='op'>=</span> <span class='ivar'>@page</span><span class='period'>.</span><span class='id html'>html</span>
    <span class='id url'>url</span>              <span class='op'>=</span> <span class='ivar'>@page</span><span class='period'>.</span><span class='id url'>url</span>
    <span class='id method'>method</span>           <span class='op'>=</span> <span class='ivar'>@page</span><span class='period'>.</span><span class='id method'>method</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='period'>.</span><span class='id upcase'>upcase</span> <span class='kw'>if</span> <span class='ivar'>@page</span><span class='period'>.</span><span class='id method'>method</span>

    <span class='kw'>if</span><span class='lparen'>(</span> <span class='id res'>res</span> <span class='rparen'>)</span>
        <span class='id request_headers'>request_headers</span>  <span class='op'>=</span> <span class='id res'>res</span><span class='period'>.</span><span class='id request'>request</span><span class='period'>.</span><span class='id headers'>headers</span>
        <span class='id response_headers'>response_headers</span> <span class='op'>=</span> <span class='id res'>res</span><span class='period'>.</span><span class='id headers'>headers</span>
        <span class='id response'>response</span>         <span class='op'>=</span> <span class='id res'>res</span><span class='period'>.</span><span class='id body'>body</span>
        <span class='id url'>url</span>              <span class='op'>=</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:action</span><span class='rbracket'>]</span>
        <span class='id method'>method</span>           <span class='op'>=</span> <span class='id res'>res</span><span class='period'>.</span><span class='id request'>request</span><span class='period'>.</span><span class='id method'>method</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='period'>.</span><span class='id upcase'>upcase</span>
    <span class='kw'>end</span>

    <span class='kw'>if</span> <span class='id response_headers'>response_headers</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>content-type</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span> <span class='op'>&amp;&amp;</span>
       <span class='op'>!</span><span class='id response_headers'>response_headers</span><span class='lbracket'>[</span><span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>content-type</span><span class='tstring_end'>'</span></span><span class='rbracket'>]</span><span class='period'>.</span><span class='id substring?'>substring?</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>text</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span>
        <span class='id response'>response</span> <span class='op'>=</span> <span class='kw'>nil</span>
    <span class='kw'>end</span>

    <span class='kw'>begin</span>
        <span class='id print_ok'>print_ok</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>In </span><span class='embexpr_beg'>#{</span><span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:element</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_content'> var '</span><span class='embexpr_beg'>#{</span><span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:altered</span><span class='rbracket'>]</span><span class='rbrace'>}</span><span class='tstring_content'>' ( </span><span class='embexpr_beg'>#{</span><span class='id url'>url</span><span class='rbrace'>}</span><span class='tstring_content'> )</span><span class='tstring_end'>&quot;</span></span> <span class='rparen'>)</span>
    <span class='kw'>rescue</span>
    <span class='kw'>end</span>

    <span class='id print_verbose'>print_verbose</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Injected string:\t</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:injected</span><span class='rbracket'>]</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:injected</span><span class='rbracket'>]</span>
    <span class='id print_verbose'>print_verbose</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Verified string:\t</span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:match</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id to_s'>to_s</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:match</span><span class='rbracket'>]</span>
    <span class='id print_verbose'>print_verbose</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>&quot;</span><span class='tstring_content'>Matched regular expression: </span><span class='tstring_end'>&quot;</span></span> <span class='op'>+</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:regexp</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id to_s'>to_s</span> <span class='rparen'>)</span>
    <span class='id print_debug'>print_debug</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Request ID: </span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id res'>res</span><span class='period'>.</span><span class='id request'>request</span><span class='period'>.</span><span class='id id'>id</span><span class='period'>.</span><span class='id to_s'>to_s</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id res'>res</span>
    <span class='id print_verbose'>print_verbose</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>---------</span><span class='tstring_end'>'</span></span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id only_positives?'>only_positives?</span>

    <span class='comment'># Instantiate a new Issue class and append it to the results array
</span>    <span class='id log_issue'>log_issue</span><span class='lparen'>(</span>
        <span class='symbol'>:var</span>          <span class='op'>=&gt;</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:altered</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:url</span>          <span class='op'>=&gt;</span> <span class='id url'>url</span><span class='comma'>,</span>
        <span class='symbol'>:injected</span>     <span class='op'>=&gt;</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:injected</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:id</span>           <span class='op'>=&gt;</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:id</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:regexp</span>       <span class='op'>=&gt;</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:regexp</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:regexp_match</span> <span class='op'>=&gt;</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:match</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:elem</span>         <span class='op'>=&gt;</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:element</span><span class='rbracket'>]</span><span class='comma'>,</span>
        <span class='symbol'>:verification</span> <span class='op'>=&gt;</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:verification</span><span class='rbracket'>]</span> <span class='op'>||</span> <span class='kw'>false</span><span class='comma'>,</span>
        <span class='symbol'>:method</span>       <span class='op'>=&gt;</span> <span class='id method'>method</span><span class='comma'>,</span>
        <span class='symbol'>:response</span>     <span class='op'>=&gt;</span> <span class='id response'>response</span><span class='comma'>,</span>
        <span class='symbol'>:opts</span>         <span class='op'>=&gt;</span> <span class='id opts'>opts</span><span class='comma'>,</span>
        <span class='symbol'>:headers</span>      <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
            <span class='symbol'>:request</span>    <span class='op'>=&gt;</span> <span class='id request_headers'>request_headers</span><span class='comma'>,</span>
            <span class='symbol'>:response</span>   <span class='op'>=&gt;</span> <span class='id response_headers'>response_headers</span><span class='comma'>,</span>
        <span class='rbrace'>}</span>
    <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="log_issue-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>log_issue</strong>(opts) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Helper method for issue logging.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>issue options (<span class='object_link'><a href="../Issue.html" title="Arachni::Issue (class)">Issue</a></span>)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>include_class_info</span>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>merge opts with module.info?</p>
</div>
      
    </li>
  
</ul>


  <h3>See Also:</h3>
  <ul class="see">
    
      <li>Base#register_results</li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


348
349
350
351</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 348</span>

<span class='kw'>def</span> <span class='id log_issue'>log_issue</span><span class='lparen'>(</span> <span class='id opts'>opts</span> <span class='rparen'>)</span>
    <span class='comment'># register the issue
</span>    <span class='id register_results'>register_results</span><span class='lparen'>(</span> <span class='lbracket'>[</span> <span class='const'>Issue</span><span class='period'>.</span><span class='id new'>new</span><span class='lparen'>(</span> <span class='id opts'>opts</span><span class='period'>.</span><span class='id merge'>merge</span><span class='lparen'>(</span> <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id info'>info</span> <span class='rparen'>)</span> <span class='rparen'>)</span> <span class='rbracket'>]</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="log_remote_file-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>log_remote_file</strong>(res) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='log_remote_directory-instance_method'>log_remote_directory</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    
<p>Logs the existence of a remote file as an issue.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>res</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Typhoeus/Response.html" title="Typhoeus::Response (class)">Typhoeus::Response</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>


  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="#log_issue-instance_method" title="Arachni::Module::Auditor#log_issue (method)">#log_issue</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


321
322
323
324
325
326
327
328
329
330
331
332
333
334
335
336
337</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 321</span>

<span class='kw'>def</span> <span class='id log_remote_file'>log_remote_file</span><span class='lparen'>(</span> <span class='id res'>res</span> <span class='rparen'>)</span>
    <span class='id url'>url</span> <span class='op'>=</span> <span class='id res'>res</span><span class='period'>.</span><span class='id effective_url'>effective_url</span>
    <span class='id filename'>filename</span> <span class='op'>=</span> <span class='const'>File</span><span class='period'>.</span><span class='id basename'>basename</span><span class='lparen'>(</span> <span class='const'>URI</span><span class='lparen'>(</span> <span class='id res'>res</span><span class='period'>.</span><span class='id effective_url'>effective_url</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id path'>path</span> <span class='rparen'>)</span>

    <span class='id log_issue'>log_issue</span><span class='lparen'>(</span>
        <span class='symbol'>:url</span>          <span class='op'>=&gt;</span> <span class='id url'>url</span><span class='comma'>,</span>
        <span class='symbol'>:injected</span>     <span class='op'>=&gt;</span> <span class='id filename'>filename</span><span class='comma'>,</span>
        <span class='symbol'>:id</span>           <span class='op'>=&gt;</span> <span class='id filename'>filename</span><span class='comma'>,</span>
        <span class='symbol'>:elem</span>         <span class='op'>=&gt;</span> <span class='const'>Issue</span><span class='op'>::</span><span class='const'>Element</span><span class='op'>::</span><span class='const'>PATH</span><span class='comma'>,</span>
        <span class='symbol'>:response</span>     <span class='op'>=&gt;</span> <span class='id res'>res</span><span class='period'>.</span><span class='id body'>body</span><span class='comma'>,</span>
        <span class='symbol'>:headers</span>      <span class='op'>=&gt;</span> <span class='lbrace'>{</span>
            <span class='symbol'>:request</span>    <span class='op'>=&gt;</span> <span class='id res'>res</span><span class='period'>.</span><span class='id request'>request</span><span class='period'>.</span><span class='id headers'>headers</span><span class='comma'>,</span>
            <span class='symbol'>:response</span>   <span class='op'>=&gt;</span> <span class='id res'>res</span><span class='period'>.</span><span class='id headers'>headers</span><span class='comma'>,</span>
        <span class='rbrace'>}</span>
    <span class='rparen'>)</span>

<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="log_remote_file_if_exists-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>log_remote_file_if_exists</strong>(url, silent = false, &amp;block) 
  

  
    <span class="aliases">Also known as:
    <span class="names"><span id='log_remote_directory_if_exists-instance_method'>log_remote_directory_if_exists</span></span>
    </span>
  
</p><div class="docstring">
  <div class="discussion">
    
<p>Logs a remote file or directory if it exists.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>url</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
      
    </li>
  
    <li>
      
        <span class='name'>silent</span>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
        <em class="default">(defaults to: <tt>false</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>if false, a message will be sent to stdout containing the status of the
operation.</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>&amp;block</span>
      
      
        <span class='type'>(<tt>Proc</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>called if the file exists, just before logging</p>
</div>
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'><ul><li>
<p>nil if no URL was provided</p>
</li><li>
<p>false if the request couldn't be fired</p>
</li><li>
<p>true if everything went fine</p>
</li></ul>
</div>
      
    </li>
  
</ul>

  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="#remote_file_exist%3F-instance_method" title="Arachni::Module::Auditor#remote_file_exist? (method)">#remote_file_exist?</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


280
281
282
283
284
285
286
287
288
289
290
291
292
293
294
295
296
297
298
299
300
301</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 280</span>

<span class='kw'>def</span> <span class='id log_remote_file_if_exists'>log_remote_file_if_exists</span><span class='lparen'>(</span> <span class='id url'>url</span><span class='comma'>,</span> <span class='id silent'>silent</span> <span class='op'>=</span> <span class='kw'>false</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>nil</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id url'>url</span>

    <span class='id req'>req</span>  <span class='op'>=</span> <span class='ivar'>@http</span><span class='period'>.</span><span class='id get'>get</span><span class='lparen'>(</span> <span class='id url'>url</span> <span class='rparen'>)</span>
    <span class='kw'>return</span> <span class='kw'>false</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id req'>req</span>
    <span class='id req'>req</span><span class='period'>.</span><span class='id on_complete'>on_complete</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id res'>res</span><span class='op'>|</span>

        <span class='id print_status'>print_status</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>Analyzing response for: </span><span class='tstring_end'>'</span></span> <span class='op'>+</span> <span class='id url'>url</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id silent'>silent</span>

        <span class='kw'>if</span> <span class='id remote_file_exist?'>remote_file_exist?</span><span class='lparen'>(</span> <span class='id res'>res</span> <span class='rparen'>)</span>
            <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='id res'>res</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id block_given?'>block_given?</span>
            <span class='id log_remote_file'>log_remote_file</span><span class='lparen'>(</span> <span class='id res'>res</span> <span class='rparen'>)</span>

            <span class='comment'># if the file exists let the trainer parse it since it may
</span>            <span class='comment'># contain brand new data to audit
</span>            <span class='ivar'>@http</span><span class='period'>.</span><span class='id trainer'>trainer</span><span class='period'>.</span><span class='id add_response'>add_response</span><span class='lparen'>(</span> <span class='id res'>res</span> <span class='rparen'>)</span>
        <span class='kw'>end</span>
    <span class='rbrace'>}</span>

    <span class='kw'>return</span> <span class='kw'>true</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="match_and_log-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>match_and_log</strong>(regexps, string = @page.html, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Matches the "string" (default string is the HTML code in @page.html) to an
array of regular expressions and logs the results.</p>

<p>For good measure, regexps will also be run against the page headers
(@page.response_headers).</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>regexps</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span>&lt;Regexp&gt;</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>array of regular expressions to be tested</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>string</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../String.html" title="String (class)">String</a></span></tt>)</span>
      
      
        <em class="default">(defaults to: <tt>@page.html</tt>)</em>
      
      
        &mdash;
        <div class='inline'>
<p>string to</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>block</span>
      
      
        <span class='type'>(<tt>Block</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>block to verify matches before logging, must return true/false</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


364
365
366
367
368
369
370
371
372
373
374
375
376
377
378
379
380
381
382
383
384
385
386
387
388
389
390
391
392
393
394
395
396
397
398
399
400
401
402
403
404
405
406
407
408
409
410</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 364</span>

<span class='kw'>def</span> <span class='id match_and_log'>match_and_log</span><span class='lparen'>(</span> <span class='id regexps'>regexps</span><span class='comma'>,</span> <span class='id string'>string</span> <span class='op'>=</span> <span class='ivar'>@page</span><span class='period'>.</span><span class='id html'>html</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>

    <span class='comment'># make sure that we're working with an array
</span>    <span class='id regexps'>regexps</span> <span class='op'>=</span> <span class='lbracket'>[</span><span class='id regexps'>regexps</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id flatten'>flatten</span>

    <span class='id elems'>elems</span> <span class='op'>=</span> <span class='kw'>self</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span>
    <span class='id elems'>elems</span> <span class='op'>=</span> <span class='const'>OPTIONS</span><span class='lbracket'>[</span><span class='symbol'>:elements</span><span class='rbracket'>]</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id elems'>elems</span> <span class='op'>||</span> <span class='id elems'>elems</span><span class='period'>.</span><span class='id empty?'>empty?</span>

    <span class='id regexps'>regexps</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id regexp'>regexp</span><span class='op'>|</span>

        <span class='id string'>string</span><span class='period'>.</span><span class='id scan'>scan</span><span class='lparen'>(</span> <span class='id regexp'>regexp</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id flatten'>flatten</span><span class='period'>.</span><span class='id uniq'>uniq</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id match'>match</span><span class='op'>|</span>

            <span class='kw'>next</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id match'>match</span>
            <span class='kw'>next</span> <span class='kw'>if</span> <span class='id block'>block</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='id match'>match</span> <span class='rparen'>)</span>

            <span class='id log'>log</span><span class='lparen'>(</span>
                <span class='symbol'>:regexp</span>  <span class='op'>=&gt;</span> <span class='id regexp'>regexp</span><span class='comma'>,</span>
                <span class='symbol'>:match</span>   <span class='op'>=&gt;</span> <span class='id match'>match</span><span class='comma'>,</span>
                <span class='symbol'>:element</span> <span class='op'>=&gt;</span> <span class='const'>Issue</span><span class='op'>::</span><span class='const'>Element</span><span class='op'>::</span><span class='const'>BODY</span>
            <span class='rparen'>)</span>
        <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id elems'>elems</span><span class='period'>.</span><span class='id include?'>include?</span> <span class='const'>Issue</span><span class='op'>::</span><span class='const'>Element</span><span class='op'>::</span><span class='const'>BODY</span>

        <span class='kw'>next</span> <span class='kw'>if</span> <span class='id string'>string</span> <span class='op'>==</span> <span class='ivar'>@page</span><span class='period'>.</span><span class='id html'>html</span>

        <span class='ivar'>@page</span><span class='period'>.</span><span class='id response_headers'>response_headers</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id k'>k</span><span class='comma'>,</span><span class='id v'>v</span><span class='op'>|</span>
            <span class='kw'>next</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id v'>v</span>

            <span class='id v'>v</span><span class='period'>.</span><span class='id to_s'>to_s</span><span class='period'>.</span><span class='id scan'>scan</span><span class='lparen'>(</span> <span class='id regexp'>regexp</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id flatten'>flatten</span><span class='period'>.</span><span class='id uniq'>uniq</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
                <span class='op'>|</span><span class='id match'>match</span><span class='op'>|</span>

                <span class='kw'>next</span> <span class='kw'>if</span> <span class='op'>!</span><span class='id match'>match</span>
                <span class='kw'>next</span> <span class='kw'>if</span> <span class='id block'>block</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='id match'>match</span> <span class='rparen'>)</span>

                <span class='id log'>log</span><span class='lparen'>(</span>
                    <span class='symbol'>:var</span> <span class='op'>=&gt;</span> <span class='id k'>k</span><span class='comma'>,</span>
                    <span class='symbol'>:regexp</span>  <span class='op'>=&gt;</span> <span class='id regexp'>regexp</span><span class='comma'>,</span>
                    <span class='symbol'>:match</span>   <span class='op'>=&gt;</span> <span class='id match'>match</span><span class='comma'>,</span>
                    <span class='symbol'>:element</span> <span class='op'>=&gt;</span> <span class='const'>Issue</span><span class='op'>::</span><span class='const'>Element</span><span class='op'>::</span><span class='const'>HEADER</span>
                <span class='rparen'>)</span>
            <span class='rbrace'>}</span>
        <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='id elems'>elems</span><span class='period'>.</span><span class='id include?'>include?</span> <span class='const'>Issue</span><span class='op'>::</span><span class='const'>Element</span><span class='op'>::</span><span class='const'>HEADER</span>

    <span class='rbrace'>}</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="override_instance_scope?-instance_method">
  
    - (<tt>Bool</tt>) <strong>override_instance_scope?</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>ABSTRACT - OPTIONAL</p>

<p>Allows modules to ignore HPG scope restrictions</p>

<p>This way they can audit elements that are not on the Grid sanctioned
whitlist.</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Bool</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


251
252
253</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 251</span>

<span class='kw'>def</span> <span class='id override_instance_scope?'>override_instance_scope?</span>
    <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="redundant-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>) <strong>redundant</strong> 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>ABSTRACT - OPTIONAL</p>

<p>Prevents auditing elements that have been previously logged by any of the
modules returned by this method.</p>


  </div>
</div>
<div class="tags">
  
<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>module names</p>
</div>
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


237
238
239
240</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 237</span>

<span class='kw'>def</span> <span class='id redundant'>redundant</span>
    <span class='comment'># [ 'sqli', 'sqli_blind_rdiff' ]
</span>    <span class='lbracket'>[</span><span class='rbracket'>]</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="register_results-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>register_results</strong>(issues) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Just a delegator logs an array of issues.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>issues</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span>&lt;<span class='object_link'><a href="../Issue.html" title="Arachni::Issue (class)">Arachni::Issue</a></span>&gt;</tt>)</span>
      
      
      
    </li>
  
</ul>


  <h3>See Also:</h3>
  <ul class="see">
    
      <li><span class='object_link'><a href="Manager.html#register_results-class_method" title="Arachni::Module::Manager.register_results (method)">Manager.register_results</a></span></li>
    
  </ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


262
263
264</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 262</span>

<span class='kw'>def</span> <span class='id register_results'>register_results</span><span class='lparen'>(</span> <span class='id issues'>issues</span> <span class='rparen'>)</span>
    <span class='const'>Arachni</span><span class='op'>::</span><span class='const'>Module</span><span class='op'>::</span><span class='const'>Manager</span><span class='period'>.</span><span class='id register_results'>register_results</span><span class='lparen'>(</span> <span class='id issues'>issues</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="remote_file_exist?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>remote_file_exist?</strong>(res) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Checks that the response points to an existing file/page and not an error
or custom 404 response.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>res</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Typhoeus/Response.html" title="Typhoeus::Response (class)">Typhoeus::Response</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


310
311
312</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 310</span>

<span class='kw'>def</span> <span class='id remote_file_exist?'>remote_file_exist?</span><span class='lparen'>(</span> <span class='id res'>res</span> <span class='rparen'>)</span>
    <span class='id res'>res</span><span class='period'>.</span><span class='id code'>code</span> <span class='op'>==</span> <span class='int'>200</span> <span class='op'>&amp;&amp;</span> <span class='op'>!</span><span class='ivar'>@http</span><span class='period'>.</span><span class='id custom_404?'>custom_404?</span><span class='lparen'>(</span> <span class='id res'>res</span> <span class='rparen'>)</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="skip?-instance_method">
  
    - (<tt>Boolean</tt>) <strong>skip?</strong>(elem) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>This is called right before an [Arachni::Parser::Element] is
submitted/audited and is used to determine whether to skip it or not.</p>

<p>Running modules can override this as they wish <b>but</b> at their own
peril.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>elem</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../Parser/Element.html" title="Arachni::Parser::Element (module)">Arachni::Parser::Element</a></span></tt>)</span>
      
      
      
    </li>
  
</ul>

<h3>Returns:</h3>
<ul class="return">
  
    <li>
      
      
        <span class='type'>(<tt>Boolean</tt>)</span>
      
      
      
    </li>
  
</ul>

</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


538
539
540
541
542
543
544
545
546
547
548
549</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 538</span>

<span class='kw'>def</span> <span class='id skip?'>skip?</span><span class='lparen'>(</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
    <span class='id redundant'>redundant</span><span class='period'>.</span><span class='id map'>map</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id mod'>mod</span><span class='op'>|</span>

        <span class='id mod_name'>mod_name</span> <span class='op'>=</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id modules'>modules</span><span class='lbracket'>[</span><span class='id mod'>mod</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id info'>info</span><span class='lbracket'>[</span><span class='symbol'>:name</span><span class='rbracket'>]</span>

        <span class='id set_id'>set_id</span> <span class='op'>=</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id modules'>modules</span><span class='period'>.</span><span class='id class'>class</span><span class='period'>.</span><span class='id issue_set_id_from_elem'>issue_set_id_from_elem</span><span class='lparen'>(</span> <span class='id mod_name'>mod_name</span><span class='comma'>,</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
        <span class='kw'>return</span> <span class='kw'>true</span> <span class='kw'>if</span> <span class='ivar'>@framework</span><span class='period'>.</span><span class='id modules'>modules</span><span class='period'>.</span><span class='id issue_set'>issue_set</span><span class='period'>.</span><span class='id include?'>include?</span><span class='lparen'>(</span> <span class='id set_id'>set_id</span> <span class='rparen'>)</span>
    <span class='rbrace'>}</span> <span class='kw'>if</span> <span class='ivar'>@framework</span>

    <span class='kw'>return</span> <span class='kw'>false</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
      <div class="method_details ">
  <p class="signature " id="timing_attack-instance_method">
  
    - (<tt><span class='object_link'><a href="../../Object.html" title="Object (class)">Object</a></span></tt>) <strong>timing_attack</strong>(strings, opts, &amp;block) 
  

  
</p><div class="docstring">
  <div class="discussion">
    
<p>Audits elements using a timing attack.</p>

<p>'opts' needs to contain a :timeout value in milliseconds.&lt;/br&gt;
Optionally, you can add a :timeout_divider.</p>


  </div>
</div>
<div class="tags">
  <h3>Parameters:</h3>
<ul class="param">
  
    <li>
      
        <span class='name'>strings</span>
      
      
        <span class='type'>(<tt><span class='object_link'><a href="../../Array.html" title="Array (class)">Array</a></span></tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>injection strings '__TIME__' will be substituted with (timeout /
timeout_divider)</p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>opts</span>
      
      
        <span class='type'>(<tt>Hash</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>options as described in <span class='object_link'><a href="#OPTIONS-constant" title="Arachni::Module::Auditor::OPTIONS (constant)">OPTIONS</a></span></p>
</div>
      
    </li>
  
    <li>
      
        <span class='name'>&amp;block</span>
      
      
        <span class='type'>(<tt>Block</tt>)</span>
      
      
      
        &mdash;
        <div class='inline'>
<p>block to call if a timeout occurs, it will be passed the response and opts</p>
</div>
      
    </li>
  
</ul>


</div><table class="source_code">
  <tr>
    <td>
      <pre class="lines">


731
732
733
734
735
736
737
738
739
740
741
742
743
744
745
746
747
748
749
750
751</pre>
    </td>
    <td>
      <pre class="code"><span class="info file"># File 'lib/arachni/module/auditor.rb', line 731</span>

<span class='kw'>def</span> <span class='id timing_attack'>timing_attack</span><span class='lparen'>(</span> <span class='id strings'>strings</span><span class='comma'>,</span> <span class='id opts'>opts</span><span class='comma'>,</span> <span class='op'>&amp;</span><span class='id block'>block</span> <span class='rparen'>)</span>

    <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:timeout_divider</span><span class='rbracket'>]</span> <span class='op'>||=</span> <span class='int'>1</span>

    <span class='lbracket'>[</span><span class='id strings'>strings</span><span class='rbracket'>]</span><span class='period'>.</span><span class='id flatten'>flatten</span><span class='period'>.</span><span class='id each'>each</span> <span class='lbrace'>{</span>
        <span class='op'>|</span><span class='id str'>str</span><span class='op'>|</span>

        <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:timing_string</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='id str'>str</span>
        <span class='id str'>str</span> <span class='op'>=</span> <span class='id str'>str</span><span class='period'>.</span><span class='id gsub'>gsub</span><span class='lparen'>(</span> <span class='tstring'><span class='tstring_beg'>'</span><span class='tstring_content'>__TIME__</span><span class='tstring_end'>'</span></span><span class='comma'>,</span> <span class='lparen'>(</span> <span class='lparen'>(</span><span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:timeout</span><span class='rbracket'>]</span> <span class='op'>+</span> <span class='int'>3</span> <span class='op'>*</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:timeout_divider</span><span class='rbracket'>]</span><span class='rparen'>)</span> <span class='op'>/</span> <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:timeout_divider</span><span class='rbracket'>]</span> <span class='rparen'>)</span><span class='period'>.</span><span class='id to_s'>to_s</span> <span class='rparen'>)</span>
        <span class='id opts'>opts</span><span class='lbracket'>[</span><span class='symbol'>:skip_orig</span><span class='rbracket'>]</span> <span class='op'>=</span> <span class='kw'>true</span>

        <span class='id audit'>audit</span><span class='lparen'>(</span> <span class='id str'>str</span><span class='comma'>,</span> <span class='id opts'>opts</span> <span class='rparen'>)</span> <span class='lbrace'>{</span>
            <span class='op'>|</span><span class='id res'>res</span><span class='comma'>,</span> <span class='id c_opts'>c_opts</span><span class='comma'>,</span> <span class='id elem'>elem</span><span class='op'>|</span>

            <span class='id call_on_timing_blocks'>call_on_timing_blocks</span><span class='lparen'>(</span> <span class='id res'>res</span><span class='comma'>,</span> <span class='id elem'>elem</span> <span class='rparen'>)</span>
            <span class='id block'>block</span><span class='period'>.</span><span class='id call'>call</span><span class='lparen'>(</span> <span class='id res'>res</span><span class='comma'>,</span> <span class='id c_opts'>c_opts</span><span class='comma'>,</span> <span class='id elem'>elem</span> <span class='rparen'>)</span> <span class='kw'>if</span> <span class='id block'>block</span> <span class='op'>&amp;&amp;</span> <span class='id res'>res</span><span class='period'>.</span><span class='id timed_out?'>timed_out?</span>
        <span class='rbrace'>}</span>
    <span class='rbrace'>}</span>

    <span class='ivar'>@http</span><span class='period'>.</span><span class='id run'>run</span>
<span class='kw'>end</span></pre>
    </td>
  </tr>
</table>
</div>
    
  </div>

</div>
    
    <div id="footer">
  Generated on Fri Dec 16 09:23:23 2011 by 
  <a href="http://yardoc.org" title="Yay! A Ruby Documentation Tool" target="_parent">yard</a>
  0.7.3 (ruby-1.9.3).
</div>

  </body>
</html>